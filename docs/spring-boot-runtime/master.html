<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>Spring Boot 2.1.x Runtime Guide</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.0/css/font-awesome.css);

article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary {
  display: block
}

audio, canvas, video {
  display: inline-block
}

audio:not([controls]) {
  display: none;
  height: 0
}

[hidden], template {
  display: none
}

script {
  display: none !important
}

html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%
}

body {
  margin: 0
}

a {
  background: transparent
}

a:focus {
  outline: thin dotted
}

a:active, a:hover {
  outline: 0
}

h1 {
  font-size: 2em;
  margin: 0.67em 0
}

abbr[title] {
  border-bottom: 1px dotted
}

b, strong {
  font-weight: bold
}

dfn {
  font-style: italic
}

hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0
}

mark {
  background: #ff0;
  color: #000
}

code, kbd, pre, samp {
  font-family: monospace, serif;
  font-size: 1em
}

pre {
  white-space: pre-wrap
}

q {
  quotes: "\201C" "\201D" "\2018" "\2019"
}

small {
  font-size: 80%
}

sub, sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline
}

sup {
  top: -0.5em
}

sub {
  bottom: -0.25em
}

img {
  border: 0
}

svg:not(:root) {
  overflow: hidden
}

figure {
  margin: 0
}

fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em
}

legend {
  border: 0;
  padding: 0
}

button, input, select, textarea {
  font-family: inherit;
  font-size: 100%;
  margin: 0
}

button, input {
  line-height: normal
}

button, select {
  text-transform: none
}

button, html input[type="button"], input[type="reset"], input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer
}

button[disabled], html input[disabled] {
  cursor: default
}

input[type="checkbox"], input[type="radio"] {
  box-sizing: border-box;
  padding: 0
}

input[type="search"] {
  -webkit-appearance: textfield;
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box;
  box-sizing: content-box
}

input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none
}

button::-moz-focus-inner, input::-moz-focus-inner {
  border: 0;
  padding: 0
}

textarea {
  overflow: auto;
  vertical-align: top
}

table {
  border-collapse: collapse;
  border-spacing: 0
}

meta.foundation-mq-small {
  font-family: "only screen and (min-width: 768px)";
  width: 768px
}

meta.foundation-mq-medium {
  font-family: "only screen and (min-width:1280px)";
  width: 1280px
}

meta.foundation-mq-large {
  font-family: "only screen and (min-width:1440px)";
  width: 1440px
}

*, *:before, *:after {
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  box-sizing: border-box
}

html, body {
  font-size: 100%
}

body {
  background: #fff;
  color: #222;
  padding: 0;
  margin: 0;
  font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif;
  font-weight: normal;
  font-style: normal;
  line-height: 1;
  position: relative;
  cursor: auto
}

a:hover {
  cursor: pointer
}

img, object, embed {
  max-width: 100%;
  height: auto
}

object, embed {
  height: 100%
}

img {
  -ms-interpolation-mode: bicubic
}

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object {
  max-width: none !important
}

.left {
  float: left !important
}

.right {
  float: right !important
}

.text-left {
  text-align: left !important
}

.text-right {
  text-align: right !important
}

.text-center {
  text-align: center !important
}

.text-justify {
  text-align: justify !important
}

.hide {
  display: none
}

.antialiased, body {
  -webkit-font-smoothing: antialiased
}

img {
  display: inline-block;
  vertical-align: middle
}

textarea {
  height: auto;
  min-height: 50px
}

select {
  width: 100%
}

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p {
  font-size: 1.21875em;
  line-height: 1.6
}

.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption {
  line-height: 1.4;
  color: #6f6f6f;
  font-weight: 300;
  margin-top: 0.2em;
  margin-bottom: 0.5em
}

div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td {
  margin: 0;
  padding: 0;
  direction: ltr
}

a {
  color: #2ba6cb;
  text-decoration: none;
  line-height: inherit
}

a:hover, a:focus {
  color: #2795b6
}

a img {
  border: none
}

p {
  font-family: inherit;
  font-weight: normal;
  font-size: 1em;
  line-height: 1.6;
  margin-bottom: 1.25em;
  text-rendering: optimizeLegibility
}

p aside {
  font-size: 0.875em;
  line-height: 1.35;
  font-style: italic
}

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
  font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif;
  font-weight: bold;
  font-style: normal;
  color: #222;
  text-rendering: optimizeLegibility;
  margin-top: 1em;
  margin-bottom: 0.5em;
  line-height: 1.2125em
}

h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small {
  font-size: 60%;
  color: #6f6f6f;
  line-height: 0
}

h1 {
  font-size: 2.125em
}

h2 {
  font-size: 1.6875em
}

h3, #toctitle, .sidebarblock > .content > .title {
  font-size: 1.375em
}

h4 {
  font-size: 1.125em
}

h5 {
  font-size: 1.125em
}

h6 {
  font-size: 1em
}

hr {
  border: solid #ddd;
  border-width: 1px 0 0;
  clear: both;
  margin: 1.25em 0 1.1875em;
  height: 0
}

em, i {
  font-style: italic;
  line-height: inherit
}

strong, b {
  font-weight: bold;
  line-height: inherit
}

small {
  font-size: 60%;
  line-height: inherit
}

code {
  font-family: Consolas, "Liberation Mono", Courier, monospace;
  font-weight: bold;
  color: #7f0a0c
}

ul, ol, dl {
  font-size: 1em;
  line-height: 1.6;
  margin-bottom: 1.25em;
  list-style-position: outside;
  font-family: inherit
}

ul, ol {
  margin-left: 1.5em
}

ul.no-bullet, ol.no-bullet {
  margin-left: 1.5em
}

ul li ul, ul li ol {
  margin-left: 1.25em;
  margin-bottom: 0;
  font-size: 1em
}

ul.square li ul, ul.circle li ul, ul.disc li ul {
  list-style: inherit
}

ul.square {
  list-style-type: square
}

ul.circle {
  list-style-type: circle
}

ul.disc {
  list-style-type: disc
}

ul.no-bullet {
  list-style: none
}

ol li ul, ol li ol {
  margin-left: 1.25em;
  margin-bottom: 0
}

dl dt {
  margin-bottom: 0.3125em;
  font-weight: bold
}

dl dd {
  margin-bottom: 1.25em
}

abbr, acronym {
  text-transform: uppercase;
  font-size: 90%;
  color: #222;
  border-bottom: 1px dotted #ddd;
  cursor: help
}

abbr {
  text-transform: none
}

blockquote {
  margin: 0 0 1.25em;
  padding: 0.5625em 1.25em 0 1.1875em;
  border-left: 1px solid #ddd
}

blockquote cite {
  display: block;
  font-size: 0.8125em;
  color: #555
}

blockquote cite:before {
  content: "\2014 \0020"
}

blockquote cite a, blockquote cite a:visited {
  color: #555
}

blockquote, blockquote p {
  line-height: 1.6;
  color: #6f6f6f
}

.vcard {
  display: inline-block;
  margin: 0 0 1.25em 0;
  border: 1px solid #ddd;
  padding: 0.625em 0.75em
}

.vcard li {
  margin: 0;
  display: block
}

.vcard .fn {
  font-weight: bold;
  font-size: 0.9375em
}

.vevent .summary {
  font-weight: bold
}

.vevent abbr {
  cursor: auto;
  text-decoration: none;
  font-weight: bold;
  border: none;
  padding: 0 0.0625em
}

@media only screen and (min-width: 768px) {
  h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
    line-height: 1.4
  }

  h1 {
    font-size: 2.75em
  }

  h2 {
    font-size: 2.3125em
  }

  h3, #toctitle, .sidebarblock > .content > .title {
    font-size: 1.6875em
  }

  h4 {
    font-size: 1.4375em
  }
}

.print-only {
  display: none !important
}

@media print {
  * {
    background: transparent !important;
    color: #000 !important;
    box-shadow: none !important;
    text-shadow: none !important
  }

  a, a:visited {
    text-decoration: underline
  }

  a[href]:after {
    content: " (" attr(href) ")"
  }

  abbr[title]:after {
    content: " (" attr(title) ")"
  }

  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
    content: ""
  }

  pre, blockquote {
    border: 1px solid #999;
    page-break-inside: avoid
  }

  thead {
    display: table-header-group
  }

  tr, img {
    page-break-inside: avoid
  }

  img {
    max-width: 100% !important
  }

  @page {
    margin: 0.5cm
  }

  p, h2, h3, #toctitle, .sidebarblock > .content > .title {
    orphans: 3;
    widows: 3
  }

  h2, h3, #toctitle, .sidebarblock > .content > .title {
    page-break-after: avoid
  }

  .hide-on-print {
    display: none !important
  }

  .print-only {
    display: block !important
  }

  .hide-for-print {
    display: none !important
  }

  .show-for-print {
    display: inherit !important
  }
}

table {
  background: #fff;
  margin-bottom: 1.25em;
  border: solid 1px #ddd
}

table thead, table tfoot {
  background: #f5f5f5;
  font-weight: bold
}

table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td {
  padding: 0.5em 0.625em 0.625em;
  font-size: inherit;
  color: #222;
  text-align: left
}

table tr th, table tr td {
  padding: 0.5625em 0.625em;
  font-size: inherit;
  color: #222
}

table tr.even, table tr.alt, table tr:nth-of-type(even) {
  background: #f9f9f9
}

table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td {
  display: table-cell;
  line-height: 1.4
}

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after {
  content: " ";
  display: table
}

.clearfix:after, .float-group:after {
  clear: both
}

*:not(pre) > code {
  font-size: inherit;
  padding: 0;
  white-space: nowrap;
  background-color: inherit;
  border: 0 solid #ddd;
  -webkit-border-radius: 0;
  border-radius: 0;
  text-shadow: none
}

pre, pre > code {
  line-height: 1.4;
  color: #000;
  font-family: monospace, serif;
  font-weight: normal
}

kbd.keyseq {
  color: #555
}

kbd:not(.keyseq) {
  display: inline-block;
  color: #222;
  font-size: 0.75em;
  line-height: 1.4;
  background-color: #F7F7F7;
  border: 1px solid #ccc;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;
  -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;
  box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;
  margin: -0.15em 0.15em 0 0.15em;
  padding: 0.2em 0.6em 0.2em 0.5em;
  vertical-align: middle;
  white-space: nowrap
}

kbd kbd:first-child {
  margin-left: 0
}

kbd kbd:last-child {
  margin-right: 0
}

.menuseq, .menu {
  color: #090909
}

b.button:before {
  content: '[ '
}

b.button:after {
  content: ' ]'
}

#header, #content, #footnotes, #footer {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  margin-top: 0;
  margin-bottom: 0;
  max-width: 62.5em;
  *zoom: 1;
  position: relative;
  padding-left: 0.9375em;
  padding-right: 0.9375em
}

#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after {
  content: " ";
  display: table
}

#header:after, #content:after, #footnotes:after, #footer:after {
  clear: both
}

#header {
  margin-bottom: 2.5em
}

#header > h1 {
  color: #000;
  font-weight: bold;
  border-bottom: 1px solid #ddd;
  margin-bottom: -28px;
  padding-bottom: 32px
}

#header span {
  color: #6f6f6f
}

#header #revnumber {
  text-transform: capitalize
}

#header br {
  display: none
}

#header br + span {
  padding-left: 3px
}

#header br + span:before {
  content: "\2013 \0020"
}

#header br + span.author {
  padding-left: 0
}

#header br + span.author:before {
  content: ", "
}

#toc {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1.25em
}

#toc > ul {
  margin-left: 0.25em
}

#toc ul.sectlevel0 > li > a {
  font-style: italic
}

#toc ul.sectlevel0 ul.sectlevel1 {
  margin-left: 0;
  margin-top: 0.5em;
  margin-bottom: 0.5em
}

#toc ul {
  list-style-type: none
}

#toctitle {
  color: #6f6f6f
}

@media only screen and (min-width: 768px) {
  body.toc2 {
    padding-left: 15em;
    padding-right: 0
  }

  #toc.toc2 {
    position: fixed;
    width: 15em;
    left: 0;
    top: 0;
    border-right: 1px solid #ddd;
    border-bottom: 0;
    z-index: 1000;
    padding: 1em;
    height: 100%;
    overflow: auto
  }

  #toc.toc2 #toctitle {
    margin-top: 0;
    font-size: 1.2em
  }

  #toc.toc2 > ul {
    font-size: .90em
  }

  #toc.toc2 ul ul {
    margin-left: 0;
    padding-left: 1em
  }

  #toc.toc2 ul.sectlevel0 ul.sectlevel1 {
    padding-left: 0;
    margin-top: 0.5em;
    margin-bottom: 0.5em
  }

  body.toc2.toc-right {
    padding-left: 0;
    padding-right: 15em
  }

  body.toc2.toc-right #toc.toc2 {
    border-right: 0;
    border-left: 1px solid #ddd;
    left: auto;
    right: 0
  }
}

@media only screen and (min-width: 1280px) {
  body.toc2 {
    padding-left: 20em;
    padding-right: 0
  }

  #toc.toc2 {
    width: 20em
  }

  #toc.toc2 #toctitle {
    font-size: 1.375em
  }

  #toc.toc2 > ul {
    font-size: 0.95em
  }

  #toc.toc2 ul ul {
    padding-left: 1.25em
  }

  body.toc2.toc-right {
    padding-left: 0;
    padding-right: 20em
  }
}

#content #toc {
  border-style: solid;
  border-width: 1px;
  border-color: #d9d9d9;
  margin-bottom: 1.25em;
  padding: 1.25em;
  background: #f2f2f2;
  border-width: 0;
  -webkit-border-radius: 0;
  border-radius: 0
}

#content #toc > :first-child {
  margin-top: 0
}

#content #toc > :last-child {
  margin-bottom: 0
}

#content #toc a {
  text-decoration: none
}

#content #toctitle {
  font-weight: bold;
  font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif;
  font-size: 1em;
  padding-left: 0.125em
}

.sect1 {
  padding-bottom: 1.25em
}

.sect1 + .sect1 {
  border-top: 1px solid #ddd
}

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor {
  position: absolute;
  width: 1em;
  margin-left: -1em;
  display: block;
  text-decoration: none;
  visibility: hidden;
  text-align: center;
  font-weight: normal
}

#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before {
  content: '\00A7';
  font-size: .85em;
  vertical-align: text-top;
  display: block;
  margin-top: 0.05em
}

#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover {
  visibility: visible
}

#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link {
  color: #222;
  text-decoration: none
}

#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover {
  color: #151515
}

.imageblock, .literalblock, .listingblock, .mathblock, .verseblock, .videoblock {
  margin-bottom: 1.25em
}

.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
  text-align: left;
  font-weight: bold
}

.tableblock > caption {
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
  overflow: visible;
  max-width: 0
}

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p {
  font-size: inherit
}

.admonitionblock > table {
  border: 0;
  background: none;
  width: 100%
}

.admonitionblock > table td.icon {
  text-align: center;
  width: 80px
}

.admonitionblock > table td.icon img {
  max-width: none
}

.admonitionblock > table td.icon .title {
  font-weight: bold;
  text-transform: uppercase
}

.admonitionblock > table td.content {
  padding-left: 1.125em;
  padding-right: 1.25em;
  border-left: 1px solid #ddd;
  color: #6f6f6f
}

.admonitionblock > table td.content > :last-child > :last-child {
  margin-bottom: 0
}

.exampleblock > .content {
  border-style: solid;
  border-width: 1px;
  border-color: #e6e6e6;
  margin-bottom: 1.25em;
  padding: 1.25em;
  background: #fff;
  -webkit-border-radius: 0;
  border-radius: 0
}

.exampleblock > .content > :first-child {
  margin-top: 0
}

.exampleblock > .content > :last-child {
  margin-bottom: 0
}

.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p {
  color: #333
}

.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 {
  line-height: 1;
  margin-bottom: 0.625em
}

.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader {
  line-height: 1.4
}

.exampleblock.result > .content {
  -moz-box-shadow: #d9d9d9, 0, 1px, 8px;
  -webkit-box-shadow: #d9d9d9, 0, 1px, 8px;
  box-shadow: #d9d9d9, 0, 1px, 8px
}

.sidebarblock {
  border-style: solid;
  border-width: 1px;
  border-color: #d9d9d9;
  margin-bottom: 1.25em;
  padding: 1.25em;
  background: #f2f2f2;
  -webkit-border-radius: 0;
  border-radius: 0
}

.sidebarblock > :first-child {
  margin-top: 0
}

.sidebarblock > :last-child {
  margin-bottom: 0
}

.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p {
  color: #333
}

.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 {
  line-height: 1;
  margin-bottom: 0.625em
}

.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader {
  line-height: 1.4
}

.sidebarblock > .content > .title {
  color: #6f6f6f;
  margin-top: 0;
  line-height: 1.6
}

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child {
  margin-bottom: 0
}

.literalblock pre:not([class]), .listingblock pre:not([class]) {
  background: #eee
}

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
  border-width: 1px;
  border-style: solid;
  border-color: #ccc;
  -moz-border-radius: 0;
  -webkit-border-radius: 0;
  border-radius: 0;
  padding: 0.8em 0.8em 0.65em 0.8em;
  word-wrap: break-word
}

.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap {
  overflow-x: auto;
  white-space: pre;
  word-wrap: normal
}

.literalblock pre > code, .literalblock pre[class] > code, .listingblock pre > code, .listingblock pre[class] > code {
  display: block
}

@media only screen {
  .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
    font-size: 0.72em
  }
}

@media only screen and (min-width: 768px) {
  .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
    font-size: 0.81em
  }
}

@media only screen and (min-width: 1280px) {
  .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
    font-size: 0.9em
  }
}

.listingblock pre.highlight {
  padding: 0
}

.listingblock pre.highlight > code {
  padding: 0.8em 0.8em 0.65em 0.8em
}

.listingblock > .content {
  position: relative
}

.listingblock:hover code[class*=" language-"]:before {
  text-transform: uppercase;
  font-size: 0.9em;
  color: #999;
  position: absolute;
  top: 0.375em;
  right: 0.375em
}

.listingblock:hover code.asciidoc:before {
  content: "asciidoc"
}

.listingblock:hover code.clojure:before {
  content: "clojure"
}

.listingblock:hover code.css:before {
  content: "css"
}

.listingblock:hover code.groovy:before {
  content: "groovy"
}

.listingblock:hover code.html:before {
  content: "html"
}

.listingblock:hover code.java:before {
  content: "java"
}

.listingblock:hover code.javascript:before {
  content: "javascript"
}

.listingblock:hover code.python:before {
  content: "python"
}

.listingblock:hover code.ruby:before {
  content: "ruby"
}

.listingblock:hover code.sass:before {
  content: "sass"
}

.listingblock:hover code.scss:before {
  content: "scss"
}

.listingblock:hover code.xml:before {
  content: "xml"
}

.listingblock:hover code.yaml:before {
  content: "yaml"
}

.listingblock.terminal pre .command:before {
  content: attr(data-prompt);
  padding-right: 0.5em;
  color: #999
}

.listingblock.terminal pre .command:not([data-prompt]):before {
  content: '$'
}

table.pyhltable {
  border: 0;
  margin-bottom: 0
}

table.pyhltable td {
  vertical-align: top;
  padding-top: 0;
  padding-bottom: 0
}

table.pyhltable td.code {
  padding-left: .75em;
  padding-right: 0
}

.highlight.pygments .lineno, table.pyhltable td:not(.code) {
  color: #999;
  padding-left: 0;
  padding-right: .5em;
  border-right: 1px solid #ddd
}

.highlight.pygments .lineno {
  display: inline-block;
  margin-right: .25em
}

table.pyhltable .linenodiv {
  background-color: transparent !important;
  padding-right: 0 !important
}

.quoteblock {
  margin: 0 0 1.25em;
  padding: 0.5625em 1.25em 0 1.1875em;
  border-left: 1px solid #ddd
}

.quoteblock blockquote {
  margin: 0 0 1.25em 0;
  padding: 0 0 0.5625em 0;
  border: 0
}

.quoteblock blockquote > .paragraph:last-child p {
  margin-bottom: 0
}

.quoteblock .attribution {
  margin-top: -.25em;
  padding-bottom: 0.5625em;
  font-size: 0.8125em;
  color: #555
}

.quoteblock .attribution br {
  display: none
}

.quoteblock .attribution cite {
  display: block;
  margin-bottom: 0.625em
}

table thead th, table tfoot th {
  font-weight: bold
}

table.tableblock.grid-all {
  border-collapse: separate;
  border-spacing: 1px;
  -webkit-border-radius: 0;
  border-radius: 0;
  border-top: 1px solid #ddd;
  border-bottom: 1px solid #ddd
}

table.tableblock.frame-topbot, table.tableblock.frame-none {
  border-left: 0;
  border-right: 0
}

table.tableblock.frame-sides, table.tableblock.frame-none {
  border-top: 0;
  border-bottom: 0
}

table.tableblock td .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child {
  margin-bottom: 0
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left
}

th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right
}

th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top
}

th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom
}

th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle
}

tbody tr th {
  display: table-cell;
  line-height: 1.4;
  background: #f5f5f5
}

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p {
  color: #222;
  font-weight: bold
}

td > div.verse {
  white-space: pre
}

ol {
  margin-left: 1.75em
}

ul li ol {
  margin-left: 1.5em
}

dl dd {
  margin-left: 1.125em
}

dl dd:last-child, dl dd:last-child > :last-child {
  margin-bottom: 0
}

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist {
  margin-bottom: 0.625em
}

ul.unstyled, ol.unnumbered, ul.checklist, ul.none {
  list-style-type: none
}

ul.unstyled, ol.unnumbered, ul.checklist {
  margin-left: 0.625em
}

ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child {
  margin-right: 0.25em
}

ul.checklist li > p:first-child > input[type="checkbox"]:first-child {
  position: relative;
  top: 1px
}

ul.inline {
  margin: 0 auto 0.625em auto;
  margin-left: -1.375em;
  margin-right: 0;
  padding: 0;
  list-style: none;
  overflow: hidden
}

ul.inline > li {
  list-style: none;
  float: left;
  margin-left: 1.375em;
  display: block
}

ul.inline > li > * {
  display: block
}

.unstyled dl dt {
  font-weight: normal;
  font-style: normal
}

ol.arabic {
  list-style-type: decimal
}

ol.decimal {
  list-style-type: decimal-leading-zero
}

ol.loweralpha {
  list-style-type: lower-alpha
}

ol.upperalpha {
  list-style-type: upper-alpha
}

ol.lowerroman {
  list-style-type: lower-roman
}

ol.upperroman {
  list-style-type: upper-roman
}

ol.lowergreek {
  list-style-type: lower-greek
}

.hdlist > table, .colist > table {
  border: 0;
  background: none
}

.hdlist > table > tbody > tr, .colist > table > tbody > tr {
  background: none
}

td.hdlist1 {
  padding-right: .8em;
  font-weight: bold
}

td.hdlist1, td.hdlist2 {
  vertical-align: top
}

.literalblock + .colist, .listingblock + .colist {
  margin-top: -0.5em
}

.colist > table tr > td:first-of-type {
  padding: 0 .8em;
  line-height: 1
}

.colist > table tr > td:last-of-type {
  padding: 0.25em 0
}

.qanda > ol > li > p > em:only-child {
  color: #2795b6
}

.thumb, .th {
  line-height: 0;
  display: inline-block;
  border: solid 4px #fff;
  -webkit-box-shadow: 0 0 0 1px #ddd;
  box-shadow: 0 0 0 1px #ddd
}

.imageblock.left, .imageblock[style*="float: left"] {
  margin: 0.25em 0.625em 1.25em 0
}

.imageblock.right, .imageblock[style*="float: right"] {
  margin: 0.25em 0 1.25em 0.625em
}

.imageblock > .title {
  margin-bottom: 0
}

.imageblock.thumb, .imageblock.th {
  border-width: 6px
}

.imageblock.thumb > .title, .imageblock.th > .title {
  padding: 0 0.125em
}

.image.left, .image.right {
  margin-top: 0.25em;
  margin-bottom: 0.25em;
  display: inline-block;
  line-height: 0
}

.image.left {
  margin-right: 0.625em
}

.image.right {
  margin-left: 0.625em
}

a.image {
  text-decoration: none
}

span.footnote, span.footnoteref {
  vertical-align: super;
  font-size: 0.875em
}

span.footnote a, span.footnoteref a {
  text-decoration: none
}

#footnotes {
  padding-top: 0.75em;
  padding-bottom: 0.75em;
  margin-bottom: 0.625em
}

#footnotes hr {
  width: 20%;
  min-width: 6.25em;
  margin: -.25em 0 .75em 0;
  border-width: 1px 0 0 0
}

#footnotes .footnote {
  padding: 0 0.375em;
  line-height: 1.3;
  font-size: 0.875em;
  margin-left: 1.2em;
  text-indent: -1.2em;
  margin-bottom: .2em
}

#footnotes .footnote a:first-of-type {
  font-weight: bold;
  text-decoration: none
}

#footnotes .footnote:last-of-type {
  margin-bottom: 0
}

#content #footnotes {
  margin-top: -0.625em;
  margin-bottom: 0;
  padding: 0.75em 0
}

.gist .file-data > table {
  border: none;
  background: #fff;
  width: 100%;
  margin-bottom: 0
}

.gist .file-data > table td.line-data {
  width: 99%
}

div.unbreakable {
  page-break-inside: avoid
}

.big {
  font-size: larger
}

.small {
  font-size: smaller
}

.underline {
  text-decoration: underline
}

.overline {
  text-decoration: overline
}

.line-through {
  text-decoration: line-through
}

.aqua {
  color: #00bfbf
}

.aqua-background {
  background-color: #00fafa
}

.black {
  color: #000
}

.black-background {
  background-color: #000
}

.blue {
  color: #0000bf
}

.blue-background {
  background-color: #0000fa
}

.fuchsia {
  color: #bf00bf
}

.fuchsia-background {
  background-color: #fa00fa
}

.gray {
  color: #606060
}

.gray-background {
  background-color: #7d7d7d
}

.green {
  color: #006000
}

.green-background {
  background-color: #007d00
}

.lime {
  color: #00bf00
}

.lime-background {
  background-color: #00fa00
}

.maroon {
  color: #600000
}

.maroon-background {
  background-color: #7d0000
}

.navy {
  color: #000060
}

.navy-background {
  background-color: #00007d
}

.olive {
  color: #606000
}

.olive-background {
  background-color: #7d7d00
}

.purple {
  color: #600060
}

.purple-background {
  background-color: #7d007d
}

.red {
  color: #bf0000
}

.red-background {
  background-color: #fa0000
}

.silver {
  color: #909090
}

.silver-background {
  background-color: #bcbcbc
}

.teal {
  color: #006060
}

.teal-background {
  background-color: #007d7d
}

.white {
  color: #bfbfbf
}

.white-background {
  background-color: #fafafa
}

.yellow {
  color: #bfbf00
}

.yellow-background {
  background-color: #fafa00
}

span.icon > [class^="icon-"], span.icon > [class*=" icon-"] {
  cursor: default
}

.admonitionblock td.icon [class^="icon-"]:before {
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
  cursor: default
}

.admonitionblock td.icon .icon-note:before {
  content: "\f05a";
  font-size: 2.5em;
  color: #2ba6cb;
  color: #207c98
}

.admonitionblock td.icon .icon-tip:before {
  content: "\f0eb";
  font-size: 2.5em;
  text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8);
  color: #111
}

.admonitionblock td.icon .icon-warning:before {
  content: "\f071";
  font-size: 2.5em;
  color: #bf6900
}

.admonitionblock td.icon .icon-caution:before {
  content: "\f06d";
  font-size: 2.5em;
  color: #bf3400
}

.admonitionblock td.icon .icon-important:before {
  content: "\f06a";
  font-size: 2.5em;
  color: #bf0000
}

.conum {
  display: inline-block;
  color: white !important;
  background-color: #222;
  -moz-border-radius: 100px;
  -webkit-border-radius: 100px;
  border-radius: 100px;
  text-align: center;
  width: 20px;
  height: 20px;
  font-size: 12px;
  font-weight: bold;
  line-height: 20px;
  font-family: Arial, sans-serif;
  font-style: normal;
  position: relative;
  top: -2px;
  letter-spacing: -1px
}

.conum * {
  color: white !important
}

.conum + b {
  display: none
}

.conum:after {
  content: attr(data-value)
}

.conum:not([data-value]):empty {
  display: none
}

#content {
  margin: 20px;
}

#header {
  margin: 0 20px;
}

nav.navbar {
  background: #17569e;
}
a.navbar-brand {
  line-height: 2rem;
  text-transform: uppercase;
}
a.nav-link {
  color: #dddddd;
}
a.nav-link:hover {
  color: #ffffff;
}

#footer-text {
  font-size: smaller;
  float: right;
}

.container {
    margin-right: auto;
    margin-left: auto;
    padding-left: 20px;
    padding-right: 20px;
}

.row {
    margin-left: -20px;
    margin-right: -20px;
}

.col-xs-2 {
    width: 16.66666667%;
}

.col-xs-10 {
    width: 83.33333333%;
}

.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
    float: left;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
    position: relative;
    min-height: 1px;
    padding-left: 20px;
    padding-right: 20px;
}

footer {
  background-color: #e9ecef;
  margin: 4rem auto 0;
  padding: 2rem 1rem;
  text-align: center;
  width: 100%; 
}
footer a {
  color: #007bff;
  margin: 1rem;
  display: inline-block;
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
  <!--

    nav.navbar {
    background: #17569e;
}

.navbar {
    position: relative;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: justify;
    -ms-flex-pack: justify;
    justify-content: space-between;
    padding: .5rem 1rem;
}
.navbar>.container, .navbar>.container-fluid {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: justify;
    -ms-flex-pack: justify;
    justify-content: space-between;
}
.navbar-dark .navbar-brand {
    color: #fff;
}
a.navbar-brand {
    line-height: 2rem;
    text-transform: uppercase;
}
.navbar-brand {
    display: inline-block;
    padding-top: .3125rem;
    padding-bottom: .3125rem;
    margin-right: 1rem;
    font-size: 1.25rem;
    line-height: inherit;
    white-space: nowrap;
}
.justify-content-end {
    -webkit-box-pack: end!important;
    -ms-flex-pack: end!important;
    justify-content: flex-end!important;
}
.nav {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    padding-left: 0;
    margin-bottom: 0;
    list-style: none;
}
a.nav-link {
    color: #dddddd;
    text-decoration: none;
    background-color: transparent;
    -webkit-text-decoration-skip: objects;
}
a.nav-link:hover {
    color: #ffffff;
}
.nav-link {
    display: block;
    padding: .5rem 1rem;
}
.me {
  width: 100%;
}
-->
</style>

<nav class="navbar navbar-dark">
  <div class="container me">
    <a href="/" class="navbar-brand">
      <strong>Fabric8</strong> Launcher
    </a>
    <ul class="nav justify-content-end">
      <li class="nav-item">
        <a class="nav-link" href="/docs">Docs</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/docs/contrib-guide.html">Contribution Guide</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="http://github.com/fabric8-launcher" target="_blank">GitHub</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://developers.redhat.com/launch" target="_blank">Try Out</a>
      </li>
    </ul>
  </div>
</nav>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Spring Boot 2.1.x Runtime Guide</h1>
<div class="details">
<span id="revnumber">version 2019-06-05</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#what-is-springboot_spring-boot">1. What is Spring Boot</a>
<ul class="sectlevel2">
<li><a href="#springboot-features-and-frameworks-summary_spring-boot">1.1. Spring Boot features and frameworks summary</a></li>
</ul>
</li>
<li><a href="#configuring-your-application-to-use-spring-boot_spring-boot">2. Configuring your application to use Spring Boot</a></li>
<li><a href="#examples-and-cloud-native-development-on-openshift_spring-boot">3. Example applications and cloud-native development on OpenShift</a></li>
<li><a href="#spring-boot-available-examples">4. Available examples Spring Boot</a>
<ul class="sectlevel2">
<li><a href="#example-rest-http-spring-boot">4.1. REST API Level 0 example for Spring Boot</a></li>
<li><a href="#example-configmap-spring-boot">4.2. Externalized Configuration example for Spring Boot</a></li>
<li><a href="#example-crud-spring-boot">4.3. Relational Database Backend example for Spring Boot</a></li>
<li><a href="#example-health-check-spring-boot">4.4. Health Check example for Spring Boot</a></li>
<li><a href="#example-circuit-breaker-spring-boot">4.5. Circuit Breaker example for Spring Boot</a></li>
<li><a href="#example-rest-http-secured-spring-boot">4.6. Secured example application for Spring Boot</a></li>
<li><a href="#example-cache-spring-boot">4.7. Cache example for Spring Boot</a></li>
</ul>
</li>
<li><a href="#creating-a-basic-springboot-application_spring-boot">5. Developing and deploying a Spring Boot runtime application</a>
<ul class="sectlevel2">
<li><a href="#developing-runtime-application_spring-boot">5.1. Developing Spring Boot application</a></li>
<li><a href="#deploying-runtime-application-to-openshift_spring-boot">5.2. Deploying Spring Boot application to OpenShift</a></li>
<li><a href="#deploying-runtime-application-to-standalone-red-hat-enterprise-linux_spring-boot">5.3. Deploying Spring Boot application to standalone Red Hat Enterprise Linux</a></li>
</ul>
</li>
<li><a href="#developing-reactive-spring-boot-applications-webflux">6. Developing reactive Spring Boot applications using Spring Reactive and Webflux</a>
<ul class="sectlevel2">
<li><a href="#creating-a-reactive-spring-boot-http-service-with-webflux">6.1. Creating a reactive Spring Boot HTTP service with WebFlux</a></li>
<li><a href="#creating-an-authenticated-reactive-spring-boot-http-service-with-webflux">6.2. Creating an authenticated reactive Spring Boot HTTP service with WebFlux</a></li>
</ul>
</li>
<li><a href="#_debugging">7. Debugging</a>
<ul class="sectlevel2">
<li><a href="#_remote_debugging">7.1. Remote debugging</a></li>
<li><a href="#_debug_logging">7.2. Debug logging</a></li>
</ul>
</li>
<li><a href="#_monitoring_your_application">8. Monitoring your application</a>
<ul class="sectlevel2">
<li><a href="#_accessing_jvm_metrics_for_your_application_on_openshift">8.1. Accessing JVM metrics for your application on OpenShift</a></li>
<li><a href="#exposing-metrics-using-prometheus-with-spring-boot_spring-boot">8.2. Exposing application metrics using Prometheus with Spring Boot</a></li>
</ul>
</li>
<li><a href="#the-source-to-image-s2i-build-process">Appendix A: The Source-to-Image (S2I) build process</a></li>
<li><a href="#updating-the-deployment-configuration-of-an-example-application_spring-boot">Appendix B: Updating the deployment configuration of an example application</a></li>
<li><a href="#configuring-a-jenkins-freestyle-project-to-deploy-your-application-with-the-fabric8-maven-plugin_spring-boot">Appendix C: Configuring a Jenkins freestyle project to deploy your application with the Fabric8 Maven Plugin</a></li>
<li><a href="#deploying-a-springboot-application-using-war-files_spring-boot">Appendix D: Deploying a Spring Boot application using WAR files</a></li>
<li><a href="#additional-springboot-resources_spring-boot">Appendix E: Additional Spring Boot resources</a></li>
<li><a href="#application-development-resources">Appendix F: Application development resources</a></li>
<li><a href="#proficiency-levels">Appendix G: Proficiency levels</a></li>
<li><a href="#glossary">Appendix H: Glossary</a>
<ul class="sectlevel2">
<li><a href="#_product_and_project_names">H.1. Product and project names</a></li>
<li><a href="#_terms_specific_to_fabric8_launcher">H.2. Terms specific to Fabric8 Launcher</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide covers concepts as well as practical details needed by developers to use the Spring Boot runtime. It provides information governing the design of a Spring Boot application deployed as a Linux container on OpenShift.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This guide applies to Spring Boot 2.1.x.
For releases based on Spring Boot 1.5.x, follow the <a href="/docs/spring-boot-1-5-runtime.html">Spring Boot 1.5.x Runtime Guide</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-springboot_spring-boot">1. What is Spring Boot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot lets you create stand-alone Spring-based applications.
See <a href="/docs/spring-boot-runtime.html#additional-springboot-resources_spring-boot">Additional Resources</a> for a list of documents about Spring Boot.</p>
</div>
<div class="paragraph">
<p>Spring Boot on OpenShift combines streamlined application development capabilities of Spring Boot with the infrastructure and container orchestration functionalities of the OpenShift, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>rolling updates</p>
</li>
<li>
<p>service discovery</p>
</li>
<li>
<p>canary deployments</p>
</li>
<li>
<p>ways to implement common microservice patterns: externalized configuration, health check, circuit breaker, and failover</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="springboot-features-and-frameworks-summary_spring-boot">1.1. Spring Boot features and frameworks summary</h3>
<div class="paragraph">
<p>This guide covers the design of modern applications using <a href="https://projects.spring.io/spring-boot/">Spring Boot</a>. These concepts support developing Web or Websocket applications using either an HTTP connector or non-blocking HTTP connector.
The applications can be packaged and deployed without modification or updated to use cloud native features on OpenShift.</p>
</div>
<div class="paragraph">
<p>The features in the table below are available as a collection of example applications that run on OpenShift. Some features are native to Kubernetes, others are available from <a href="https://github.com/spring-cloud-incubator/spring-cloud-kubernetes">Spring Cloud Kubernetes</a>.
Features such as Actuator are available directly in Spring Boot.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Features and Frameworks Summary</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Problem Addressed</th>
<th class="tableblock halign-left valign-top">Cloud Native</th>
<th class="tableblock halign-left valign-top">Framework</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Circuit Breaker</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Switches between services and continues to process incoming requests without interruption in case of service failure.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://github.com/spring-cloud/spring-cloud-netflix">Spring Cloud Netflix</a> - Hystrix</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Health Check</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Checks readiness and liveness of the service. Service restarts automatically if probing fails.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Spring Boot Actuator</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Service Discovery</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Discovers Service/Endpoint deployed on OpenShift and exposed behind a service or route using the service name matching a DNS entry.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes - using Kubernetes API</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://github.com/spring-cloud-incubator/spring-cloud-kubernetes">Spring Cloud Kubernetes</a> - DiscoveryClient</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Server Side Load Balancing</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Handles load increases by deploying multiple service instances, and by transparently distributing the load across them.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes - Using internal Kubernetes Load Balancer</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>-</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Externalize Parameters</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Makes the application independent of the environment where it runs.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes - Kubernetes ConfigMap or Secret</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://github.com/spring-cloud-incubator/spring-cloud-kubernetes">Spring Cloud Kubernetes</a> - ConfigMap</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-your-application-to-use-spring-boot_spring-boot">2. Configuring your application to use Spring Boot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Reference the Spring Boot BOM (Bill of Materials) artifact in the <code>pom.xml</code> file at the root directory of your application.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A Maven-based application</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open the <code>pom.xml</code> file, add the <code>me.snowdrop:spring-boot-bom</code> artifact to the <code>&lt;dependencyManagement&gt;</code> section, and specify the <code>&lt;type&gt;pom&lt;/type&gt;</code> and <code>&lt;scope&gt;import&lt;/scope&gt;</code>:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
  ...
  &lt;dependencyManagement&gt;
    &lt;dependencies&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;me.snowdrop&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-bom&lt;/artifactId&gt;
        &lt;version&gt;2.1.3.Final-redhat-00001&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
        &lt;scope&gt;import&lt;/scope&gt;
      &lt;/dependency&gt;
    &lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;
  ...
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Include the following properties to track the version of Spring Boot and the Spring Boot Maven Plugin you are using:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
  ...
  &lt;properties&gt;
    &lt;spring-boot.version&gt;2.1.3.RELEASE&lt;/spring-boot.version&gt;
    &lt;spring-boot-maven-plugin.version&gt;2.1.3.RELEASE&lt;/spring-boot-maven-plugin.version&gt;
  &lt;/properties&gt;
  ...
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Specify the repositories containing Application Development on OpenShift Spring Boot Starters and the Spring Boot Maven Plugin:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">  &lt;!-- Specify the repositories containing RHOAR artifacts. --&gt;
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;redhat-ga&lt;/id&gt;
      &lt;name&gt;Red Hat GA Repository&lt;/name&gt;
      &lt;url&gt;https://maven.repository.redhat.com/ga/&lt;/url&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;

  &lt;!-- Specify the repositories containing the plugins used to execute the build of your application. --&gt;
  &lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;redhat-ga&lt;/id&gt;
      &lt;name&gt;Red Hat GA Repository&lt;/name&gt;
      &lt;url&gt;https://maven.repository.redhat.com/ga/&lt;/url&gt;
    &lt;/pluginRepository&gt;
  &lt;/pluginRepositories&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Reference <code>spring-boot-maven-plugin</code> as the plugin used to package your application:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
        ...
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;${spring-boot-maven-plugin.version}&lt;/version&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;repackage&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
              &lt;/executions&gt;
            &lt;configuration&gt;
                &lt;redeploy&gt;true&lt;/redeploy&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
        ...
    &lt;/plugins&gt;
  &lt;/build&gt;
  ...
&lt;/project&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more information about packaging your Spring Boot application, see the <a href="https://docs.spring.io/spring-boot/docs/current/maven-plugin/plugin-info.html">Spring Boot Maven Plugin</a> documentation.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples-and-cloud-native-development-on-openshift_spring-boot">3. Example applications and cloud-native development on OpenShift</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When developing applications on OpenShift, you can use examples to kickstart your development.</p>
</div>
<h3 id="_example_applications" class="discrete">Example applications</h3>
<div class="paragraph">
<p>Examples are working applications that showcase different fundamental pieces of building cloud native applications and services.</p>
</div>
<div class="paragraph">
<p>The examples implement a <a href="http://microservices.io/patterns/microservices.html">Microservice pattern</a> such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating REST APIs</p>
</li>
<li>
<p>Interoperating with a database</p>
</li>
<li>
<p>Implementing the Health Check pattern</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use the examples for a variety of purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A proof of technology demonstration</p>
</li>
<li>
<p>A learning tool, or a sandbox for understanding how to develop applications for your project</p>
</li>
<li>
<p>A starting point for updating or extending to your own use case</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each example application is implemented in one or more runtimes.
The REST API Level 0 example is implemented for these runtimes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/docs/nodejs-runtime.html#example-rest-http-nodejs">Node.js</a></p>
</li>
<li>
<p><a href="/docs/spring-boot-runtime.html#example-rest-http-spring-boot">Spring Boot</a></p>
</li>
<li>
<p><a href="/docs/vertx-runtime.html#example-rest-http-vertx">Eclipse Vert.x</a></p>
</li>
<li>
<p><a href="/docs/thorntail-runtime.html#example-rest-http-wf-swarm">Thorntail</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-boot-available-examples">4. Available examples Spring Boot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following example applications are available for Spring Boot.</p>
</div>
<div class="sect2">
<h3 id="example-rest-http-spring-boot">4.1. REST API Level 0 example for Spring Boot</h3>
<div class="paragraph">
<p>Example proficiency level:
<a href="#proficiency_foundational"><strong>Foundational</strong></a>.</p>
</div>
<div class="paragraph">
<div class="title">What the REST API Level 0 example does</div>
<p>The REST API Level 0 example shows how to map business operations to a remote procedure call endpoint over HTTP using a REST framework. This corresponds to <a href="https://martinfowler.com/articles/richardsonMaturityModel.html#level0" target="_blank" rel="noopener">Level 0 in the Richardson Maturity Model</a>.
Creating an HTTP endpoint using REST and its underlying principles to define your API lets you quickly prototype and design the API flexibly.</p>
</div>
<div class="paragraph">
<p>This example introduces the mechanics of interacting with a remote service using the HTTP protocol. It allows you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execute an HTTP <code>GET</code> request on the <code>api/greeting</code> endpoint.</p>
</li>
<li>
<p>Receive a response in JSON format with a payload consisting of the <code>Hello, World!</code> String.</p>
</li>
<li>
<p>Execute an HTTP <code>GET</code> request on the <code>api/greeting</code> endpoint while passing in a String argument. This uses the <code>name</code> request parameter in the query string.</p>
</li>
<li>
<p>Receive a response in JSON format with a payload of <code>Hello, $name!</code> with <code>$name</code> replaced by the value of the <code>name</code> parameter passed into the request.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="viewing-the-example-application-source-code-and-readme_http-api">4.1.1. Viewing the example application source code and README</h4>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>One of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to developers.redhat.com/launch</p>
</li>
<li>
<p>Fabric8 Launcher installed on a Minishift or CDK</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the Fabric8 Launcher tool to generate your own version of the example application.</p>
</li>
<li>
<p>View the generated GitHub repository or download and extract the ZIP file that contains the example application source code.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="/docs/getting-started.html#deploying-an-example-application-to-openshiftonline_getting-started">Using developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="/docs/getting-started.html#creating-and-deploying-an-example-application-using-your-openshiftlocal_getting-started">Using the Fabric8 Launcher tool on a Minishift or CDK</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="http-api-design-tradeoffs_http-api">4.1.2. REST API Level 0 design tradeoffs</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Design tradeoffs</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pros</th>
<th class="tableblock halign-left valign-top">Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>The example application enables fast prototyping.</p>
</li>
<li>
<p>The API Design is flexible.</p>
</li>
<li>
<p>HTTP endpoints allow clients to be language-neutral.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>As an application or service matures, the REST API Level 0 approach might not scale well. It might not
support a clean API design or use cases with database interactions.</p>
<div class="ulist">
<ul>
<li>
<p>Any operations involving shared, mutable state must be integrated with an appropriate backing datastore.</p>
</li>
<li>
<p>All requests handled by this API design are scoped only to the container servicing the request.
Subsequent requests might not be served by the same container.</p>
</li>
</ul>
</div>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftonline_http-api">4.1.3. Deploying the REST API Level 0 example application to OpenShift Online</h4>
<div class="paragraph">
<p>Use one of the following options to execute the REST API Level 0 example application on OpenShift Online.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-launcher-oso_http-api-oso">Use developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="#deploying-the-http-api-example-application-using-the-oc-cli-client_http-api-oso">Use the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using developers.redhat.com/launch provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-launcher-oso_http-api-oso">Deploying the example application using developers.redhat.com/launch</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> URL in a browser and log in.</p>
</li>
<li>
<p>Follow on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_http-api-oso">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on <a href="https://manage.openshift.com">OpenShift Online</a> using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the <a href="https://manage.openshift.com">OpenShift Online</a> web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://manage.openshift.com">OpenShift Online</a> URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your <a href="https://manage.openshift.com">OpenShift Online</a> account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-http-api-example-application-using-the-oc-cli-client_http-api-oso">Deploying the REST API Level 0 example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a>.
For more information, see <a href="#deploying-the-example-application-using-launcher-oso_http-api-oso">Deploying the example application using developers.redhat.com/launch</a>.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_http-api-oso">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new project in OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa               1/1       Running     0          58s
MY_APP_NAME-s2i-1-build           0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> once it is fully deployed and started.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME         MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME      8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftlocal_http-api">4.1.4. Deploying the REST API Level 0 example application to Minishift or CDK</h4>
<div class="paragraph">
<p>Use one of the following options to execute the REST API Level 0 example application locally on Minishift or CDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-the-launcher-tool_http-api-osl">Using Fabric8 Launcher</a></p>
</li>
<li>
<p><a href="#deploying-the-http-api-example-application-using-the-oc-cli-client_http-api-osl">Using the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using Fabric8 Launcher provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="getting-the-launcher-tool-url-and-credentials_http-api-osl">Getting the Fabric8 Launcher tool URL and credentials</h5>
<div class="paragraph">
<p>You need the Fabric8 Launcher tool URL and user credentials to create and deploy example applications on Minishift or CDK. This information is provided when the Minishift or CDK is started.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Fabric8 Launcher tool installed, configured, and running. For more information, see the <a href="/docs/minishift-installation.html">Install and Configure the Fabric8 Launcher Tool</a> guide.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the console where you started Minishift or CDK.</p>
</li>
<li>
<p>Check the console output for the URL and user credentials you can use to access the running Fabric8 Launcher:</p>
<div class="listingblock">
<div class="title">Example Console Output from a Minishift or CDK Startup</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">...
-- Removing temporary directory ... OK
-- Server Information ...
   OpenShift server started.
   The server is accessible via web console at:
       https://192.168.42.152:8443

   You are logged in as:
       User:     developer
       Password: developer

   To login as administrator:
       oc login -u system:admin</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-the-launcher-tool_http-api-osl">Deploying the example application using the Fabric8 Launcher tool</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK.
For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_http-api-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Fabric8 Launcher URL in a browser.</p>
</li>
<li>
<p>Follow the on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_http-api-osl">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on Minishift or CDK using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the Minishift or CDK web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK. For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_http-api-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Minishift or CDK URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your Minishift or CDK account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-http-api-example-application-using-the-oc-cli-client_http-api-osl">Deploying the REST API Level 0 example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using Fabric8 Launcher tool on a Minishift or CDK.
For more information, see <a href="#deploying-the-example-application-using-the-launcher-tool_http-api-osl">Deploying the example application using the Fabric8 Launcher tool</a>.</p>
</li>
<li>
<p>Your Fabric8 Launcher tool URL.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_http-api-osl">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new project in OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa               1/1       Running     0          58s
MY_APP_NAME-s2i-1-build           0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> once it is fully deployed and started.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME         MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME      8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftcontainerplatform_http-api">4.1.5. Deploying the REST API Level 0 example application to OpenShift Container Platform</h4>
<div class="paragraph">
<p>The process of creating and deploying example applications to OpenShift Container Platform is similar to OpenShift Online:</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> or <a href="/docs/minishift-installation.html">the Fabric8 Launcher tool</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Follow the instructions in <a href="#deploying-the-example-application-to-openshiftonline_http-api">Deploying the REST API Level 0 example application to OpenShift Online</a>, only use the URL and user credentials from the OpenShift Container Platform Web Console.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="interacting-with-the-unmodfied-http-api-example-application-for-springboot_http-api">4.1.6. Interacting with the unmodified REST API Level 0 example application for Spring Boot</h4>
<div class="paragraph">
<p>The example provides a default HTTP endpoint that accepts GET requests.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your application running</p>
</li>
<li>
<p>The <code>curl</code> binary or a web browser</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use <code>curl</code> to execute a <code>GET</code> request against the example. You can also use a browser to do this.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/greeting
{"content":"Hello, World!"}</code></pre>
</div>
</div>
</li>
<li>
<p>Use <code>curl</code> to execute a <code>GET</code> request with the <code>name</code> URL parameter against the example. You can also use a browser to do this.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/greeting?name=Sarah
{"content":"Hello, Sarah!"}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
From a browser, you can also use a form provided by the example to perform these same interactions. The form is located at the root of the project <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="running-the-example-application-integration-tests_http-api">4.1.7. Running the REST API Level 0 example application integration tests</h4>
<div class="paragraph">
<p>This example application includes a self-contained set of integration tests.
When run inside an OpenShift project, the tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy a test instance of the application to the project.</p>
</li>
<li>
<p>Execute the individual tests on that instance.</p>
</li>
<li>
<p>Remove all instances of the application from the project when the testing is done.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Executing integration tests removes all existing instances of the example application from the target OpenShift project.
To avoid accidentally removing your example application, ensure that you create and select a separate OpenShift project to execute the tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>oc</code> client authenticated</p>
</li>
<li>
<p>An empty OpenShift project</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Execute the following command to run the integration tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean verify -Popenshift,openshift-it</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest-resources_http-api">4.1.8. REST resources</h4>
<div class="paragraph">
<p>More background and related information on REST can be found here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">Architectural Styles and
the Design of Network-based Software Architectures - Representational State Transfer (REST)</a></p>
</li>
<li>
<p><a href="https://martinfowler.com/articles/richardsonMaturityModel.html">Richardson Maturity Model</a></p>
</li>
<li>
<p><a href="https://www.jcp.org/en/jsr/detail?id=311">JSR 311: JAX-RS: The JavaTM API for RESTful Web Services</a></p>
</li>
<li>
<p><a href="https://spring.io/guides/gs/rest-service/">Building a RESTful Service with Spring</a></p>
</li>
<li>
<p><a href="/docs/vertx-runtime.html#example-rest-http-vertx">REST API Level 0 for Eclipse Vert.x</a></p>
</li>
<li>
<p><a href="/docs/thorntail-runtime.html#example-rest-http-wf-swarm">REST API Level 0 for Thorntail</a></p>
</li>
<li>
<p><a href="/docs/nodejs-runtime.html#example-rest-http-nodejs">REST API Level 0 for Node.js</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="example-configmap-spring-boot">4.2. Externalized Configuration example for Spring Boot</h3>
<div class="paragraph">
<p>Example proficiency level:
<a href="#proficiency_foundational"><strong>Foundational</strong></a>.</p>
</div>
<div class="paragraph">
<p>Externalized Configuration provides a basic example of using a ConfigMap to externalize configuration. <em>ConfigMap</em> is an object used by OpenShift to inject configuration data as simple key and value pairs into one or more Linux containers while keeping the containers independent of OpenShift.</p>
</div>
<div class="paragraph">
<p>This example shows you how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up and configure a <code>ConfigMap</code>.</p>
</li>
<li>
<p>Use the configuration provided by the <code>ConfigMap</code> within an application.</p>
</li>
<li>
<p>Deploy changes to the <code>ConfigMap</code> configuration of running applications.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="the-externalized-configuration-design-pattern_configmap">4.2.1. The externalized configuration design pattern</h4>
<div class="paragraph">
<p>Whenever possible, externalize the application configuration and separate it from the application code.
This allows the application configuration to change as it moves through different environments, but leaves the code unchanged.
Externalizing the configuration also keeps sensitive or internal information out of your code base and version control.
Many languages and application servers provide environment variables to support externalizing an application&#8217;s configuration.</p>
</div>
<div class="paragraph">
<p>Microservices architectures and multi-language (polyglot) environments add a layer of complexity to managing an application&#8217;s configuration.
Applications consist of independent, distributed services, and each can have its own configuration.
Keeping all configuration data synchronized and accessible creates a maintenance challenge.</p>
</div>
<div class="paragraph">
<p>ConfigMaps enable the application configuration to be externalized and used in individual Linux containers and pods on OpenShift.
You can create a ConfigMap object in a variety of ways, including using a YAML file, and inject it into the Linux container.
ConfigMaps also allow you to group and scale sets of configuration data.
This lets you configure a large number of environments beyond the basic <em>Development</em>, <em>Stage</em>, and <em>Production</em>.
You can find more information about ConfigMaps in the <a href="https://docs.openshift.org/latest/dev_guide/configmaps.html">OpenShift documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="configmap-design-tradeoffs_configmap">4.2.2. Externalized Configuration design tradeoffs</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Design Tradeoffs</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pros</th>
<th class="tableblock halign-left valign-top">Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Configuration is separate from deployments</p>
</li>
<li>
<p>Can be updated independently</p>
</li>
<li>
<p>Can be shared across services</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Adding configuration to environment requires additional step</p>
</li>
<li>
<p>Has to be maintained separately</p>
</li>
<li>
<p>Requires coordination beyond the scope of a service</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="viewing-the-example-application-source-code-and-readme_configmap">4.2.3. Viewing the example application source code and README</h4>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>One of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to developers.redhat.com/launch</p>
</li>
<li>
<p>Fabric8 Launcher installed on a Minishift or CDK</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the Fabric8 Launcher tool to generate your own version of the example application.</p>
</li>
<li>
<p>View the generated GitHub repository or download and extract the ZIP file that contains the example application source code.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="/docs/getting-started.html#deploying-an-example-application-to-openshiftonline_getting-started">Using developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="/docs/getting-started.html#creating-and-deploying-an-example-application-using-your-openshiftlocal_getting-started">Using the Fabric8 Launcher tool on a Minishift or CDK</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftonline_configmap">4.2.4. Deploying the Externalized Configuration example application to OpenShift Online</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Externalized Configuration example application on OpenShift Online.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-launcher-oso_configmap-oso">Use developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="#deploying-the-configmap-example-application-using-the-oc-cli-client_configmap-oso">Use the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using developers.redhat.com/launch provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-launcher-oso_configmap-oso">Deploying the example application using developers.redhat.com/launch</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> URL in a browser and log in.</p>
</li>
<li>
<p>Follow on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_configmap-oso">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on <a href="https://manage.openshift.com">OpenShift Online</a> using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the <a href="https://manage.openshift.com">OpenShift Online</a> web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://manage.openshift.com">OpenShift Online</a> URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your <a href="https://manage.openshift.com">OpenShift Online</a> account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-configmap-example-application-using-the-oc-cli-client_configmap-oso">Deploying the Externalized Configuration example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a>.
For more information, see <a href="#deploying-the-example-application-using-launcher-oso_configmap-oso">Deploying the example application using developers.redhat.com/launch</a>.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_configmap-oso">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Assign view access rights to the service account before deploying your example application, so that the application can access the OpenShift API in order to read the contents of the ConfigMap.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc policy add-role-to-user view -n $(oc project -q) -z default</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Deploy your ConfigMap configuration to OpenShift using <code>application.yml</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc create configmap app-config --from-file=application.yml</code></pre>
</div>
</div>
</li>
<li>
<p>Verify your ConfigMap configuration has been deployed.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get configmap app-config -o yaml

apiVersion: v1
data:
  application.yml: |
     # This properties file should be used to initialise a ConfigMap
     greeting:
       message: "Hello %s from a ConfigMap!"
...</code></pre>
</div>
</div>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                                       READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa               1/1       Running     0          58s
MY_APP_NAME-s2i-1-build           0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> once its fully deployed and started.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME         MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME      8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftlocal_configmap">4.2.5. Deploying the Externalized Configuration example application to Minishift or CDK</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Externalized Configuration example application locally on Minishift or CDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-the-launcher-tool_configmap-osl">Using Fabric8 Launcher</a></p>
</li>
<li>
<p><a href="#deploying-the-configmap-example-application-using-the-oc-cli-client_configmap-osl">Using the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using Fabric8 Launcher provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="getting-the-launcher-tool-url-and-credentials_configmap-osl">Getting the Fabric8 Launcher tool URL and credentials</h5>
<div class="paragraph">
<p>You need the Fabric8 Launcher tool URL and user credentials to create and deploy example applications on Minishift or CDK. This information is provided when the Minishift or CDK is started.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Fabric8 Launcher tool installed, configured, and running. For more information, see the <a href="/docs/minishift-installation.html">Install and Configure the Fabric8 Launcher Tool</a> guide.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the console where you started Minishift or CDK.</p>
</li>
<li>
<p>Check the console output for the URL and user credentials you can use to access the running Fabric8 Launcher:</p>
<div class="listingblock">
<div class="title">Example Console Output from a Minishift or CDK Startup</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">...
-- Removing temporary directory ... OK
-- Server Information ...
   OpenShift server started.
   The server is accessible via web console at:
       https://192.168.42.152:8443

   You are logged in as:
       User:     developer
       Password: developer

   To login as administrator:
       oc login -u system:admin</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-the-launcher-tool_configmap-osl">Deploying the example application using the Fabric8 Launcher tool</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK.
For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_configmap-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Fabric8 Launcher URL in a browser.</p>
</li>
<li>
<p>Follow the on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_configmap-osl">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on Minishift or CDK using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the Minishift or CDK web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK. For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_configmap-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Minishift or CDK URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your Minishift or CDK account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-configmap-example-application-using-the-oc-cli-client_configmap-osl">Deploying the Externalized Configuration example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using Fabric8 Launcher tool on a Minishift or CDK.
For more information, see <a href="#deploying-the-example-application-using-the-launcher-tool_configmap-osl">Deploying the example application using the Fabric8 Launcher tool</a>.</p>
</li>
<li>
<p>Your Fabric8 Launcher tool URL.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_configmap-osl">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Assign view access rights to the service account before deploying your example application, so that the application can access the OpenShift API in order to read the contents of the ConfigMap.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc policy add-role-to-user view -n $(oc project -q) -z default</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Deploy your ConfigMap configuration to OpenShift using <code>application.yml</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc create configmap app-config --from-file=application.yml</code></pre>
</div>
</div>
</li>
<li>
<p>Verify your ConfigMap configuration has been deployed.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get configmap app-config -o yaml

apiVersion: v1
data:
  application.yml: |
     # This properties file should be used to initialise a ConfigMap
     greeting:
       message: "Hello %s from a ConfigMap!"
...</code></pre>
</div>
</div>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                                       READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa               1/1       Running     0          58s
MY_APP_NAME-s2i-1-build           0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> once its fully deployed and started.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME         MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME      8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftcontainerplatform_configmap">4.2.6. Deploying the Externalized Configuration example application to OpenShift Container Platform</h4>
<div class="paragraph">
<p>The process of creating and deploying example applications to OpenShift Container Platform is similar to OpenShift Online:</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> or <a href="/docs/minishift-installation.html">the Fabric8 Launcher tool</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Follow the instructions in <a href="#deploying-the-example-application-to-openshiftonline_configmap">Deploying the Externalized Configuration example application to OpenShift Online</a>, only use the URL and user credentials from the OpenShift Container Platform Web Console.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="interacting-with-the-unmodified-configmap-example-application-for-springboot_configmap">4.2.7. Interacting with the unmodified Externalized Configuration example application for Spring Boot</h4>
<div class="paragraph">
<p>The example provides a default HTTP endpoint that accepts GET requests.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your application running</p>
</li>
<li>
<p>The <code>curl</code> binary or a web browser</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use <code>curl</code> to execute a <code>GET</code> request against the example.
You can also use a browser to do this.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/greeting
{"content":"Hello World from a ConfigMap!"}</code></pre>
</div>
</div>
</li>
<li>
<p>Update the deployed ConfigMap configuration.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc edit configmap app-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>Change the value for the <code>greeting.message</code> key to <code>Bonjour!</code> and save the file. After you save this, the changes will be propagated to your OpenShift instance.</p>
</div>
</li>
<li>
<p>Deploy the new version of your application so the ConfigMap configuration changes are picked up.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc rollout latest dc/MY_APP_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of your example and ensure your new pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa       1/1       Running     0          58s
MY_APP_NAME-s2i-1-build   0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> once it&#8217;s fully deployed and started.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>Execute a <code>GET</code> request using <code>curl</code> against the example with the updated ConfigMap configuration to see your updated greeting.
You can also do this from your browser using the web form provided by the application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/greeting
{"content":"Bonjour!"}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="running-the-example-application-integration-tests_configmap">4.2.8. Running the Externalized Configuration example application integration tests</h4>
<div class="paragraph">
<p>This example application includes a self-contained set of integration tests.
When run inside an OpenShift project, the tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy a test instance of the application to the project.</p>
</li>
<li>
<p>Execute the individual tests on that instance.</p>
</li>
<li>
<p>Remove all instances of the application from the project when the testing is done.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Executing integration tests removes all existing instances of the example application from the target OpenShift project.
To avoid accidentally removing your example application, ensure that you create and select a separate OpenShift project to execute the tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>oc</code> client authenticated</p>
</li>
<li>
<p>An empty OpenShift project</p>
</li>
<li>
<p>View access permission assigned to the service account of your example application. This allows your application to read the configuration from the ConfigMap:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc policy add-role-to-user view -n $(oc project -q) -z default</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Execute the following command to run the integration tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean verify -Popenshift,openshift-it</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configmap-resources_configmap">4.2.9. Externalized Configuration resources</h4>
<div class="paragraph">
<p>More background and related information on Externalized Configuration and ConfigMap can be found here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.openshift.org/latest/dev_guide/configmaps.html">OpenShift ConfigMap Documentation</a></p>
</li>
<li>
<p><a href="https://blog.openshift.com/configuring-your-application-part-1/">Blog Post about ConfigMap in OpenShift</a></p>
</li>
<li>
<p><a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config">Externalized Configuration with Spring Boot</a></p>
</li>
<li>
<p><a href="/docs/vertx-runtime.html#example-configmap-vertx">Externalized Configuration for Eclipse Vert.x</a></p>
</li>
<li>
<p><a href="/docs/thorntail-runtime.html#example-configmap-wf-swarm">Externalized Configuration for Thorntail</a></p>
</li>
<li>
<p><a href="/docs/nodejs-runtime.html#example-configmap-nodejs">Externalized Configuration for Node.js</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="example-crud-spring-boot">4.3. Relational Database Backend example for Spring Boot</h3>
<div class="paragraph">
<p><strong>Limitation:</strong> Run this example application on a Minishift or CDK. You can also use a manual workflow to deploy this example to OpenShift Online Pro and OpenShift Container Platform.
This example is not currently available on OpenShift Online Starter.</p>
</div>
<div class="paragraph">
<p>Example proficiency level:
<a href="#proficiency_foundational"><strong>Foundational</strong></a>.</p>
</div>
<div class="paragraph">
<div class="title">What the Relational Database Backend example does</div>
<p>The Relational Database Backend example expands on the REST API Level 0 application to provide a basic example of performing <em>create</em>, <em>read</em>, <em>update</em> and <em>delete</em> (<em>CRUD</em>) operations on a PostgreSQL database using a simple HTTP API. <em>CRUD</em> operations are the four basic functions of persistent storage, widely used when developing an HTTP API dealing with a database.</p>
</div>
<div class="paragraph">
<p>The example also demonstrates the ability of the HTTP application to locate and connect to a database in OpenShift.
Each runtime shows how to implement the connectivity solution best suited in the given case.
The runtime can choose between options such as using <em>JDBC</em>, <em>JPA</em>, or accessing <em>ORM</em> APIs directly.</p>
</div>
<div class="paragraph">
<p>The example application exposes an HTTP API, which provides endpoints that allow you to manipulate data by performing  <em>CRUD</em> operations over HTTP.
The <em>CRUD</em> operations are mapped to HTTP <code>Verbs</code>.
The API uses JSON formatting to receive requests and return responses to the user.
The user can also use a user interface provided by the example to use the application.
Specifically, this example provides an application that allows you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Navigate to the application web interface in your browser.
This exposes a simple website allowing you to perform <em>CRUD</em> operations on the data in the <code>my_data</code> database.</p>
</li>
<li>
<p>Execute an HTTP <code>GET</code> request on the <code>api/fruits</code> endpoint.</p>
</li>
<li>
<p>Receive a response formatted as a JSON array containing the list of all fruits in the database.</p>
</li>
<li>
<p>Execute an HTTP <code>GET</code> request on the <code>api/fruits/*</code> endpoint while passing in a valid item ID as an argument.</p>
</li>
<li>
<p>Receive a response in JSON format containing the name of the fruit with the given ID.
If no item matches the specified ID, the call results in an HTTP error 404.</p>
</li>
<li>
<p>Execute an HTTP <code>POST</code> request on the <code>api/fruits</code> endpoint passing in a valid <code>name</code> value to create a new entry in the database.</p>
</li>
<li>
<p>Execute an HTTP <code>PUT</code> request on the <code>api/fruits/*</code> endpoint passing in a valid ID and a name as an argument.
This updates the name of the item with the given ID to match the name specified in your request.</p>
</li>
<li>
<p>Execute an HTTP <code>DELETE</code> request on the <code>api/fruits/*</code> endpoint, passing in a valid ID as an argument.
This removes the item with the specified ID from the database and returns an HTTP code <code>204</code> (No Content) as a response.
If you pass in an invalid ID, the call results in an HTTP error <code>404</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example also contains a set of automated <a href="#running-the-example-application-integration-tests_crud">integration tests</a> that can be used to verify that the application is fully integrated with the database.</p>
</div>
<div class="paragraph">
<p>This example does not showcase a fully matured RESTful model (level 3), but it does use compatible HTTP verbs and status, following the recommended HTTP API practices.</p>
</div>
<div class="sect3">
<h4 id="crud-design-tradeoffs_crud">4.3.1. Relational Database Backend design tradeoffs</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Design Tradeoffs</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pros</th>
<th class="tableblock halign-left valign-top">Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Each runtime determines how  to implement the database interactions. One can use a low-level connectivity API such as JDBC, some other can use JPA, and yet another can access ORM APIs directly. Each runtime decides what would be the best way.</p>
</li>
<li>
<p>Each runtime determines how the schema is created.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>The PostgreSQL database provided with this example application is not backed up with persistent storage. Changes to the database are lost if you stop or redeploy the database pod. To use an external database with your example application&#8217;s pod in order to preserve changes, see the <a href="https://docs.openshift.com/online/dev_guide/integrating_external_services.html">Integrating External Services chapter</a> of the OpenShift Documentation. It is also possible to set up persistent storage with database containers on OpenShift. (For more details about using persistent storage with OpenShift and containers, see the <a href="https://docs.openshift.com/online/architecture/additional_concepts/storage.html">Persistent Storage</a>, <a href="https://docs.openshift.com/online/dev_guide/volumes.html">Managing Volumes</a> and <a href="https://docs.openshift.com/online/dev_guide/persistent_volumes.html">Persistent Volumes</a> chapters of the OpenShift Documentation).</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="viewing-the-example-application-source-code-and-readme_crud">4.3.2. Viewing the example application source code and README</h4>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>One of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to developers.redhat.com/launch</p>
</li>
<li>
<p>Fabric8 Launcher installed on a Minishift or CDK</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the Fabric8 Launcher tool to generate your own version of the example application.</p>
</li>
<li>
<p>View the generated GitHub repository or download and extract the ZIP file that contains the example application source code.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="/docs/getting-started.html#deploying-an-example-application-to-openshiftonline_getting-started">Using developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="/docs/getting-started.html#creating-and-deploying-an-example-application-using-your-openshiftlocal_getting-started">Using the Fabric8 Launcher tool on a Minishift or CDK</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftonline_crud">4.3.3. Deploying the Relational Database Backend example application to OpenShift Online</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Relational Database Backend example application on OpenShift Online.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-launcher-oso_crud-oso">Use developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="#deploying-the-crud-example-application-using-the-oc-cli-client_crud-oso">Use the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using developers.redhat.com/launch provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-launcher-oso_crud-oso">Deploying the example application using developers.redhat.com/launch</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> URL in a browser and log in.</p>
</li>
<li>
<p>Follow on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_crud-oso">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on <a href="https://manage.openshift.com">OpenShift Online</a> using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the <a href="https://manage.openshift.com">OpenShift Online</a> web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://manage.openshift.com">OpenShift Online</a> URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your <a href="https://manage.openshift.com">OpenShift Online</a> account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-crud-example-application-using-the-oc-cli-client_crud-oso">Deploying the Relational Database Backend example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a>.
For more information, see <a href="#deploying-the-example-application-using-launcher-oso_crud-oso">Deploying the example application using developers.redhat.com/launch</a>.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_crud-oso">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Deploy the PostgreSQL database to OpenShift.
Ensure that you use the following values for user name, password, and database name when creating your database application.
The example application is pre-configured to use these values.
Using different values prevents your application from integrating with the database.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-app -e POSTGRESQL_USER=luke -ePOSTGRESQL_PASSWORD=secret -ePOSTGRESQL_DATABASE=my_data openshift/postgresql-92-centos7 --name=my-database</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of your database and ensure the pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
my-database-1-aaaaa   1/1       Running   0         45s
my-database-1-deploy   0/1       Completed   0         53s</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>my-database-1-aaaaa</code> pod should have a status of <code>Running</code> and should be indicated as ready once it is fully deployed and started.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>Use maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa       1/1       Running     0          58s
MY_APP_NAME-s2i-1-build   0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> and should be indicated as ready once it is fully deployed and started.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                     PATH      SERVICES             PORT      TERMINATION
MY_APP_NAME   MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME   8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftlocal_crud">4.3.4. Deploying the Relational Database Backend example application to Minishift or CDK</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Relational Database Backend example application locally on Minishift or CDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-the-launcher-tool_crud-osl">Using Fabric8 Launcher</a></p>
</li>
<li>
<p><a href="#deploying-the-crud-example-application-using-the-oc-cli-client_crud-osl">Using the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using Fabric8 Launcher provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="getting-the-launcher-tool-url-and-credentials_crud-osl">Getting the Fabric8 Launcher tool URL and credentials</h5>
<div class="paragraph">
<p>You need the Fabric8 Launcher tool URL and user credentials to create and deploy example applications on Minishift or CDK. This information is provided when the Minishift or CDK is started.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Fabric8 Launcher tool installed, configured, and running. For more information, see the <a href="/docs/minishift-installation.html">Install and Configure the Fabric8 Launcher Tool</a> guide.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the console where you started Minishift or CDK.</p>
</li>
<li>
<p>Check the console output for the URL and user credentials you can use to access the running Fabric8 Launcher:</p>
<div class="listingblock">
<div class="title">Example Console Output from a Minishift or CDK Startup</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">...
-- Removing temporary directory ... OK
-- Server Information ...
   OpenShift server started.
   The server is accessible via web console at:
       https://192.168.42.152:8443

   You are logged in as:
       User:     developer
       Password: developer

   To login as administrator:
       oc login -u system:admin</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-the-launcher-tool_crud-osl">Deploying the example application using the Fabric8 Launcher tool</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK.
For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_crud-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Fabric8 Launcher URL in a browser.</p>
</li>
<li>
<p>Follow the on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_crud-osl">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on Minishift or CDK using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the Minishift or CDK web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK. For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_crud-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Minishift or CDK URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your Minishift or CDK account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-crud-example-application-using-the-oc-cli-client_crud-osl">Deploying the Relational Database Backend example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using Fabric8 Launcher tool on a Minishift or CDK.
For more information, see <a href="#deploying-the-example-application-using-the-launcher-tool_crud-osl">Deploying the example application using the Fabric8 Launcher tool</a>.</p>
</li>
<li>
<p>Your Fabric8 Launcher tool URL.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_crud-osl">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Deploy the PostgreSQL database to OpenShift.
Ensure that you use the following values for user name, password, and database name when creating your database application.
The example application is pre-configured to use these values.
Using different values prevents your application from integrating with the database.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-app -e POSTGRESQL_USER=luke -ePOSTGRESQL_PASSWORD=secret -ePOSTGRESQL_DATABASE=my_data openshift/postgresql-92-centos7 --name=my-database</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of your database and ensure the pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
my-database-1-aaaaa   1/1       Running   0         45s
my-database-1-deploy   0/1       Completed   0         53s</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>my-database-1-aaaaa</code> pod should have a status of <code>Running</code> and should be indicated as ready once it is fully deployed and started.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>Use maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa       1/1       Running     0          58s
MY_APP_NAME-s2i-1-build   0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> and should be indicated as ready once it is fully deployed and started.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                     PATH      SERVICES             PORT      TERMINATION
MY_APP_NAME   MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME   8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftcontainerplatform_crud">4.3.5. Deploying the Relational Database Backend example application to OpenShift Container Platform</h4>
<div class="paragraph">
<p>The process of creating and deploying example applications to OpenShift Container Platform is similar to OpenShift Online:</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> or <a href="/docs/minishift-installation.html">the Fabric8 Launcher tool</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Follow the instructions in <a href="#deploying-the-example-application-to-openshiftonline_crud">Deploying the Relational Database Backend example application to OpenShift Online</a>, only use the URL and user credentials from the OpenShift Container Platform Web Console.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="interacting-with-the-crud-api_crud">4.3.6. Interacting with the Relational Database Backend API</h4>
<div class="paragraph">
<p>When you have finished creating your example application, you can interact with it the following way:</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your application running</p>
</li>
<li>
<p>The <code>curl</code> binary or a web browser</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Obtain the URL of your application by executing the following command:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get route MY_APP_NAME</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>NAME                 HOST/PORT                                         PATH      SERVICES             PORT      TERMINATION
MY_APP_NAME           MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME              MY_APP_NAME           8080</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>To access the web interface of the database application, navigate to the <em>application URL</em> in your browser:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can make requests directly on the <code>api/fruits/*</code> endpoint using <code>curl</code>:</p>
</div>
<div class="listingblock">
<div class="title">List all entries in the database:</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/fruits</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[ {
  "id" : 1,
  "name" : "Apple",
  "stock" : 10
}, {
  "id" : 2,
  "name" : "Orange",
  "stock" : 10
}, {
  "id" : 3,
  "name" : "Pear",
  "stock" : 10
} ]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve an entry with a specific ID</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/fruits/3</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "id" : 3,
  "name" : "Pear",
  "stock" : 10
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Create a new entry:</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl -H "Content-Type: application/json" -X POST -d '{"name":"Peach","stock":1}'  http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/fruits</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "id" : 4,
  "name" : "Peach",
  "stock" : 1
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Update an Entry</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl -H "Content-Type: application/json" -X PUT -d '{"name":"Apple","stock":"100"}'  http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/fruits/1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "id" : 1,
  "name" : "Apple",
  "stock" : 100
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Delete an Entry:</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl -X DELETE http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/fruits/1</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<h5 id="_troubleshooting" class="discrete">Troubleshooting</h5>
<div class="ulist">
<ul>
<li>
<p>If you receive an HTTP Error code <code>503</code> as a response after executing these commands, it means that the application is not ready yet.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="running-the-example-application-integration-tests_crud">4.3.7. Running the Relational Database Backend example application integration tests</h4>
<div class="paragraph">
<p>This example application includes a self-contained set of integration tests.
When run inside an OpenShift project, the tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy a test instance of the application to the project.</p>
</li>
<li>
<p>Execute the individual tests on that instance.</p>
</li>
<li>
<p>Remove all instances of the application from the project when the testing is done.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Executing integration tests removes all existing instances of the example application from the target OpenShift project.
To avoid accidentally removing your example application, ensure that you create and select a separate OpenShift project to execute the tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>oc</code> client authenticated</p>
</li>
<li>
<p>An empty OpenShift project</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Execute the following command to run the integration tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean verify -Popenshift,openshift-it</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="relational-database-resources_crud">4.3.8. Relational database resources</h4>
<div class="paragraph">
<p>More background and related information on running relational databases in OpenShift, CRUD, HTTP API and REST can be found here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html">HTTP Verbs</a></p>
</li>
<li>
<p><a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf">Architectural Styles and the Design of Network-based Software Architectures - Representational State Transfer (REST)</a></p>
</li>
<li>
<p><a href="https://speakerdeck.com/glaforge/the-never-ending-rest-api-design-debate">The never ending REST API design debase</a></p>
</li>
<li>
<p><a href="http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven">REST APIs must be Hypertext driven</a></p>
</li>
<li>
<p><a href="https://martinfowler.com/articles/richardsonMaturityModel.html">Richardson Maturity Model</a></p>
</li>
<li>
<p><a href="https://www.jcp.org/en/jsr/detail?id=311">JSR 311: JAX-RS: The JavaTM API for RESTful Web Services</a></p>
</li>
<li>
<p><a href="https://spring.io/guides/gs/rest-service/">Building a RESTful Service with Spring</a></p>
</li>
<li>
<p><a href="/docs/vertx-runtime.html#example-crud-vertx">Relational Database Backend for Eclipse Vert.x</a></p>
</li>
<li>
<p><a href="/docs/thorntail-runtime.html#example-crud-wf-swarm">Relational Database Backend for Thorntail</a></p>
</li>
<li>
<p><a href="/docs/nodejs-runtime.html#example-crud-nodejs">Relational Database Backend for Node.js</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="example-health-check-spring-boot">4.4. Health Check example for Spring Boot</h3>
<div class="paragraph">
<p>Example proficiency level:
<a href="#proficiency_foundational"><strong>Foundational</strong></a>.</p>
</div>
<div class="paragraph">
<p>When you deploy an application, it is important to know if it is available and if it can start handling incoming requests. Implementing the <em>health check</em> pattern allows you to monitor the health of an application, which includes if an application is available and whether it is able to service requests.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are not familiar with the health check terminology, see the <a href="#health-check-concepts_health-check">Health check concepts</a> section first.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The purpose of this use case is to demonstrate the health check pattern through the use of probing.
Probing is used to report the liveness and readiness of an application.
In this use case, you configure an application which exposes an HTTP <code>health</code> endpoint to issue HTTP requests.
If the container is alive, according to the liveness probe on the <code>health</code> HTTP endpoint, the management platform receives <code>200</code> as return code and no further action is required.
If the <code>health</code> HTTP endpoint does not return a response, for example if the thread is blocked, then the application is not considered alive according to the liveness probe.
In that case, the platform kills the pod corresponding to that application and recreates a new pod to restart the application.</p>
</div>
<div class="paragraph">
<p>This use case also allows you to demonstrate and use a readiness probe.
In cases where the application is running but is unable to handle requests, such as when the application returns an HTTP <code>503</code> response code during restart, this application is not considered ready according to the readiness probe.
If the application is not considered ready by the readiness probe, requests are not routed to that application until it is considered ready according to the readiness probe.</p>
</div>
<div class="sect3">
<h4 id="health-check-concepts_health-check">4.4.1. Health check concepts</h4>
<div class="paragraph">
<p>In order to understand the health check pattern, you need to first understand the following concepts:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Liveness</dt>
<dd>
<p>Liveness defines whether an application is running or not. Sometimes a running application moves into an unresponsive or stopped state and needs to be restarted. Checking for liveness helps determine whether or not an application needs to be restarted.</p>
</dd>
<dt class="hdlist1">Readiness</dt>
<dd>
<p>Readiness defines whether a running application can service requests. Sometimes a running application moves into an error or broken state where it can no longer service requests. Checking readiness helps determine whether or not requests should continue to be routed to that application.</p>
</dd>
<dt class="hdlist1">Fail-over</dt>
<dd>
<p>Fail-over enables failures in servicing requests to be handled gracefully. If an application fails to service a request, that request and future requests can then <em>fail-over</em> or be routed to another application, which is usually a redundant copy of that same application.</p>
</dd>
<dt class="hdlist1">Resilience and Stability</dt>
<dd>
<p>Resilience and Stability enable failures in servicing requests to be handled gracefully. If an application fails to service a request due to connection loss, in a resilient system that request can be retried after the connection is re-established.</p>
</dd>
<dt class="hdlist1">Probe</dt>
<dd>
<p>A probe is a Kubernetes action that periodically performs diagnostics on a running container.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="viewing-the-example-application-source-code-and-readme_health-check">4.4.2. Viewing the example application source code and README</h4>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>One of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to developers.redhat.com/launch</p>
</li>
<li>
<p>Fabric8 Launcher installed on a Minishift or CDK</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the Fabric8 Launcher tool to generate your own version of the example application.</p>
</li>
<li>
<p>View the generated GitHub repository or download and extract the ZIP file that contains the example application source code.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="/docs/getting-started.html#deploying-an-example-application-to-openshiftonline_getting-started">Using developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="/docs/getting-started.html#creating-and-deploying-an-example-application-using-your-openshiftlocal_getting-started">Using the Fabric8 Launcher tool on a Minishift or CDK</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftonline_health-check">4.4.3. Deploying the Health Check example application to OpenShift Online</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Health Check example application on OpenShift Online.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-launcher-oso_health-check-oso">Use developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="#deploying-the-health-check-example-application-using-the-oc-cli-client_health-check-oso">Use the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using developers.redhat.com/launch provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-launcher-oso_health-check-oso">Deploying the example application using developers.redhat.com/launch</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> URL in a browser and log in.</p>
</li>
<li>
<p>Follow on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_health-check-oso">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on <a href="https://manage.openshift.com">OpenShift Online</a> using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the <a href="https://manage.openshift.com">OpenShift Online</a> web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://manage.openshift.com">OpenShift Online</a> URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your <a href="https://manage.openshift.com">OpenShift Online</a> account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-health-check-example-application-using-the-oc-cli-client_health-check-oso">Deploying the Health Check example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a>.
For more information, see <a href="#deploying-the-example-application-using-launcher-oso_health-check-oso">Deploying the example application using developers.redhat.com/launch</a>.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_health-check-oso">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa               1/1       Running     0          58s
MY_APP_NAME-s2i-1-build           0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> once its fully deployed and started. You should also wait for your pod to be ready before proceeding, which is shown in the <code>READY</code> column. For example, <code>MY_APP_NAME-1-aaaaa</code> is ready when the <code>READY</code> column is <code>1/1</code>.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME         MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME      8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftlocal_health-check">4.4.4. Deploying the Health Check example application to Minishift or CDK</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Health Check example application locally on Minishift or CDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-the-launcher-tool_health-check-osl">Using Fabric8 Launcher</a></p>
</li>
<li>
<p><a href="#deploying-the-health-check-example-application-using-the-oc-cli-client_health-check-osl">Using the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using Fabric8 Launcher provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="getting-the-launcher-tool-url-and-credentials_health-check-osl">Getting the Fabric8 Launcher tool URL and credentials</h5>
<div class="paragraph">
<p>You need the Fabric8 Launcher tool URL and user credentials to create and deploy example applications on Minishift or CDK. This information is provided when the Minishift or CDK is started.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Fabric8 Launcher tool installed, configured, and running. For more information, see the <a href="/docs/minishift-installation.html">Install and Configure the Fabric8 Launcher Tool</a> guide.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the console where you started Minishift or CDK.</p>
</li>
<li>
<p>Check the console output for the URL and user credentials you can use to access the running Fabric8 Launcher:</p>
<div class="listingblock">
<div class="title">Example Console Output from a Minishift or CDK Startup</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">...
-- Removing temporary directory ... OK
-- Server Information ...
   OpenShift server started.
   The server is accessible via web console at:
       https://192.168.42.152:8443

   You are logged in as:
       User:     developer
       Password: developer

   To login as administrator:
       oc login -u system:admin</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-the-launcher-tool_health-check-osl">Deploying the example application using the Fabric8 Launcher tool</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK.
For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_health-check-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Fabric8 Launcher URL in a browser.</p>
</li>
<li>
<p>Follow the on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_health-check-osl">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on Minishift or CDK using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the Minishift or CDK web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK. For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_health-check-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Minishift or CDK URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your Minishift or CDK account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-health-check-example-application-using-the-oc-cli-client_health-check-osl">Deploying the Health Check example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using Fabric8 Launcher tool on a Minishift or CDK.
For more information, see <a href="#deploying-the-example-application-using-the-launcher-tool_health-check-osl">Deploying the example application using the Fabric8 Launcher tool</a>.</p>
</li>
<li>
<p>Your Fabric8 Launcher tool URL.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_health-check-osl">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa               1/1       Running     0          58s
MY_APP_NAME-s2i-1-build           0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> once its fully deployed and started. You should also wait for your pod to be ready before proceeding, which is shown in the <code>READY</code> column. For example, <code>MY_APP_NAME-1-aaaaa</code> is ready when the <code>READY</code> column is <code>1/1</code>.
Your specific pod name will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME         MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME      8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftcontainerplatform_health-check">4.4.5. Deploying the Health Check example application to OpenShift Container Platform</h4>
<div class="paragraph">
<p>The process of creating and deploying example applications to OpenShift Container Platform is similar to OpenShift Online:</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> or <a href="/docs/minishift-installation.html">the Fabric8 Launcher tool</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Follow the instructions in <a href="#deploying-the-example-application-to-openshiftonline_health-check">Deploying the Health Check example application to OpenShift Online</a>, only use the URL and user credentials from the OpenShift Container Platform Web Console.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="interacting-with-the-unmodified-health-check-example-application_health-check">4.4.6. Interacting with the unmodified Health Check example application</h4>
<div class="paragraph">
<p>After you deploy the example application, you will have the <code>MY_APP_NAME</code> service running. The <code>MY_APP_NAME</code> service exposes the following REST endpoints:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">/api/greeting</dt>
<dd>
<p>Returns a name as a String.</p>
</dd>
<dt class="hdlist1">/api/stop</dt>
<dd>
<p>Forces the service to become unresponsive as means to simulate a failure.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following steps demonstrate how to verify the service availability and simulate a failure.
This failure of an available service causes the OpenShift self-healing capabilities to be trigger on the service.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can use the web interface to perform these steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use <code>curl</code> to execute a <code>GET</code> request against the <code>MY_APP_NAME</code> service.
You can also use a browser to do this.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/greeting</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code>{"content":"Hello, World!"}</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Invoke the <code>/api/stop</code> endpoint and verify the availability of the <code>/api/greeting</code> endpoint shortly after that.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Invoking the <code>/api/stop</code> endpoint simulates an internal service failure and triggers the OpenShift self-healing capabilities.
When invoking <code>/api/greeting</code> after simulating the failure, the service should return
an <code>Application is not available</code> page.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>(followed by)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME/api/greeting</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;html&gt;
  &lt;head&gt;
  ...
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div&gt;
      &lt;h1&gt;Application is not available&lt;/h1&gt;
      ...
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Depending on when OpenShift removes the pod after you invoke the <code>/api/stop</code> endpoint, you might initially see a 404 error code.
If continue to invoke the <code>/api/greeting</code> endpoint, you will see the <code>Application is not available</code> page after OpenShift removes the pod.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
<li>
<p>Use <code>oc get pods -w</code> to continuously watch the self-healing capabilities in action.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>While invoking the service failure, you can watch the self-healing capabilities in action on OpenShift console, or with the <code>oc</code> client tools.
You should see the number of pods in the <code>READY</code> state move to zero (<code>0/1</code>) and after a short period (less than one minute) move back up to one (<code>1/1</code>).
In addition to that, the <code>RESTARTS</code> count increases every time you you invoke the service failure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                           READY     STATUS    RESTARTS   AGE
MY_APP_NAME-1-26iy7   0/1       Running   5          18m
MY_APP_NAME-1-26iy7   1/1       Running   5         19m</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Optional: Use the web interface to invoke the service.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Alternatively to the interaction using the terminal window, you can use the web interface provided by the service to invoke the different methods and watch the service move through the life cycle phases.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Optional: Use the web console to view the log output generated by the application at each stage of the self-healing process.</p>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to your project.</p>
</li>
<li>
<p>On the sidebar, click on <em>Monitoring</em>.</p>
</li>
<li>
<p>In the upper right-hand corner of the screen, click on <em>Events</em> to display the log messages.</p>
</li>
<li>
<p>Optional: Click <em>View Details</em> to display a detailed view of the Event log.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The health check application generates the following messages:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Message</th>
<th class="tableblock halign-left valign-top">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Unhealthy</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Readiness probe failed. This message is expected and indicates that the simulated failure of the <code>/api/greeting</code> endpoint has been detected and the self-healing process starts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Killing</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The unavailable Docker container running the service is being killed before being re-created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Pulling</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Downloading the latest version of docker image to re-create the container.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Pulled</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker image downloaded successfully.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Created</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker container has been successfully created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Started</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker container is ready to handle requests</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="running-the-example-application-integration-tests_health-check">4.4.7. Running the Health Check example application integration tests</h4>
<div class="paragraph">
<p>This example application includes a self-contained set of integration tests.
When run inside an OpenShift project, the tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy a test instance of the application to the project.</p>
</li>
<li>
<p>Execute the individual tests on that instance.</p>
</li>
<li>
<p>Remove all instances of the application from the project when the testing is done.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Executing integration tests removes all existing instances of the example application from the target OpenShift project.
To avoid accidentally removing your example application, ensure that you create and select a separate OpenShift project to execute the tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>oc</code> client authenticated</p>
</li>
<li>
<p>An empty OpenShift project</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Execute the following command to run the integration tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean verify -Popenshift,openshift-it</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="health-check-resources_health-check">4.4.8. Health check resources</h4>
<div class="paragraph">
<p>More background and related information on health checking can be found here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.openshift.com/container-platform/latest/dev_guide/application_health.html">Overview of Application Health in OpenShift</a></p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/user-guide/walkthrough/k8s201/#health-checking">Health Checking in Kubernetes</a></p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/">Kubernetes Liveness and Readiness Probes</a></p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/api-reference/v1/definitions/#_v1_probe">Kubernetes Probes</a></p>
</li>
<li>
<p><a href="/docs/vertx-runtime.html#example-health-check-vertx">Health Check for Eclipse Vert.x</a></p>
</li>
<li>
<p><a href="/docs/thorntail-runtime.html#example-health-check-wf-swarm">Health Check for Thorntail</a></p>
</li>
<li>
<p><a href="/docs/nodejs-runtime.html#example-health-check-nodejs">Health Check for Node.js</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="example-circuit-breaker-spring-boot">4.5. Circuit Breaker example for Spring Boot</h3>
<div class="paragraph">
<p><strong>Limitation:</strong> Run this example application on a Minishift or CDK. You can also use a manual workflow to deploy this example to OpenShift Online Pro and OpenShift Container Platform.
This example is not currently available on OpenShift Online Starter.</p>
</div>
<div class="paragraph">
<p>Example proficiency level:
<a href="#proficiency_foundational"><strong>Foundational</strong></a>.</p>
</div>
<div class="paragraph">
<p>The <em>Circuit Breaker</em> example demonstrates a generic pattern for reporting the failure of a service and then limiting access to the failed service until it becomes available to handle requests. This helps prevent cascading failure in other services that depend on the failed services for functionality.</p>
</div>
<div class="paragraph">
<p>This example shows you how to implement a Circuit Breaker and Fallback pattern in your services.</p>
</div>
<div class="sect3">
<h4 id="the-circuit-breaker-design-pattern_circuit-breaker">4.5.1. The circuit breaker design pattern</h4>
<div class="paragraph">
<p>The Circuit Breaker is a pattern intended to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reduce the impact of network failure and high latency on service architectures where services synchronously invoke other services.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>If one of the services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>becomes unavailable due to network failure, or</p>
</li>
<li>
<p>incurs unusually high latency values due to overwhelming traffic,</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>other services attempting to call its endpoint may end up exhausting critical resources in an attempt to reach it, rendering themselves unusable.</p>
</div>
</div>
</div>
</li>
<li>
<p>Prevent the condition also known as cascading failure, which can render the entire microservice architecture unusable.</p>
</li>
<li>
<p>Act as a proxy between a protected function and a remote function, which monitors for failures.</p>
</li>
<li>
<p>Trip once the failures reach a certain threshold, and all further calls to the circuit breaker return an error or a predefined fallback response, without the protected call being made at all.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Circuit Breaker usually also contain an error reporting mechanism that notifies you when the Circuit Breaker trips.</p>
</div>
<h5 id="_circuit_breaker_implementation" class="discrete">Circuit breaker implementation</h5>
<div class="ulist">
<ul>
<li>
<p>With the Circuit Breaker pattern implemented, a service client invokes a remote service endpoint via a proxy at regular intervals.</p>
</li>
<li>
<p>If the calls to the remote service endpoint fail repeatedly and consistently, the Circuit Breaker trips, making all calls to the service fail immediately over a set timeout period and returns a predefined fallback response.</p>
</li>
<li>
<p>When the timeout period expires, a limited number of test calls are allowed to pass through to the remote service to determine whether it has healed, or remains unavailable.</p>
<div class="ulist">
<ul>
<li>
<p>If the test calls fail, the Circuit Breaker keeps the service unavailable and keeps returning the fallback responses to incoming calls.</p>
</li>
<li>
<p>If the test calls succeed, the Circuit Breaker closes, fully enabling traffic to reach the remote service again.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="circuit-breaker-design-tradeoffs_circuit-breaker">4.5.2. Circuit Breaker design tradeoffs</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Design Tradeoffs</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pros</th>
<th class="tableblock halign-left valign-top">Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Enables a service to handle the failure of other services it invokes.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Optimizing the timeout values can be challenging</p>
<div class="ulist">
<ul>
<li>
<p>Larger-than-necessary timeout values may generate excessive latency.</p>
</li>
<li>
<p>Smaller-than-necessary timeout values may introduce false positives.</p>
</li>
</ul>
</div>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="viewing-the-example-application-source-code-and-readme_circuit-breaker">4.5.3. Viewing the example application source code and README</h4>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>One of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to developers.redhat.com/launch</p>
</li>
<li>
<p>Fabric8 Launcher installed on a Minishift or CDK</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the Fabric8 Launcher tool to generate your own version of the example application.</p>
</li>
<li>
<p>View the generated GitHub repository or download and extract the ZIP file that contains the example application source code.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="/docs/getting-started.html#deploying-an-example-application-to-openshiftonline_getting-started">Using developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="/docs/getting-started.html#creating-and-deploying-an-example-application-using-your-openshiftlocal_getting-started">Using the Fabric8 Launcher tool on a Minishift or CDK</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftonline_circuit-breaker">4.5.4. Deploying the Circuit Breaker example application to OpenShift Online</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Circuit Breaker example application on OpenShift Online.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-launcher-oso_circuit-breaker-oso">Use developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="#deploying-the-circuit-breaker-example-application-using-the-oc-cli-client_circuit-breaker-oso">Use the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using developers.redhat.com/launch provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-launcher-oso_circuit-breaker-oso">Deploying the example application using developers.redhat.com/launch</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> URL in a browser and log in.</p>
</li>
<li>
<p>Follow on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_circuit-breaker-oso">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on <a href="https://manage.openshift.com">OpenShift Online</a> using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the <a href="https://manage.openshift.com">OpenShift Online</a> web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://manage.openshift.com">OpenShift Online</a> URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your <a href="https://manage.openshift.com">OpenShift Online</a> account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-circuit-breaker-example-application-using-the-oc-cli-client_circuit-breaker-oso">Deploying the Circuit Breaker example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a>.
For more information, see <a href="#deploying-the-example-application-using-launcher-oso_circuit-breaker-oso">Deploying the example application using developers.redhat.com/launch</a>.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_circuit-breaker-oso">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-greeting-1-aaaaa     1/1       Running   0           17s
MY_APP_NAME-greeting-1-deploy    0/1       Completed 0           22s
MY_APP_NAME-name-1-aaaaa         1/1       Running   0           14s
MY_APP_NAME-name-1-deploy        0/1       Completed 0           28s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both the <code>MY_APP_NAME-greeting-1-aaaaa</code> and <code>MY_APP_NAME-name-1-aaaaa</code> pods should have a status of <code>Running</code> once they are fully deployed and started.
You should also wait for your pods to be ready before proceeding, which is shown in the <code>READY</code> column.
For example, <code>MY_APP_NAME-greeting-1-aaaaa</code> is ready when the <code>READY</code> column is <code>1/1</code>.
Your specific pod names will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME-greeting   MY_APP_NAME-greeting-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME            MY_APP_NAME-greeting   8080                    None
MY_APP_NAME-name       MY_APP_NAME-name-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME            MY_APP_NAME-name       8080                    None</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-greeting-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftlocal_circuit-breaker">4.5.5. Deploying the Circuit Breaker example application to Minishift or CDK</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Circuit Breaker example application locally on Minishift or CDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-the-launcher-tool_circuit-breaker-osl">Using Fabric8 Launcher</a></p>
</li>
<li>
<p><a href="#deploying-the-circuit-breaker-example-application-using-the-oc-cli-client_circuit-breaker-osl">Using the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using Fabric8 Launcher provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="getting-the-launcher-tool-url-and-credentials_circuit-breaker-osl">Getting the Fabric8 Launcher tool URL and credentials</h5>
<div class="paragraph">
<p>You need the Fabric8 Launcher tool URL and user credentials to create and deploy example applications on Minishift or CDK. This information is provided when the Minishift or CDK is started.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Fabric8 Launcher tool installed, configured, and running. For more information, see the <a href="/docs/minishift-installation.html">Install and Configure the Fabric8 Launcher Tool</a> guide.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the console where you started Minishift or CDK.</p>
</li>
<li>
<p>Check the console output for the URL and user credentials you can use to access the running Fabric8 Launcher:</p>
<div class="listingblock">
<div class="title">Example Console Output from a Minishift or CDK Startup</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">...
-- Removing temporary directory ... OK
-- Server Information ...
   OpenShift server started.
   The server is accessible via web console at:
       https://192.168.42.152:8443

   You are logged in as:
       User:     developer
       Password: developer

   To login as administrator:
       oc login -u system:admin</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-the-launcher-tool_circuit-breaker-osl">Deploying the example application using the Fabric8 Launcher tool</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK.
For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_circuit-breaker-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Fabric8 Launcher URL in a browser.</p>
</li>
<li>
<p>Follow the on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_circuit-breaker-osl">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on Minishift or CDK using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the Minishift or CDK web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK. For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_circuit-breaker-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Minishift or CDK URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your Minishift or CDK account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-circuit-breaker-example-application-using-the-oc-cli-client_circuit-breaker-osl">Deploying the Circuit Breaker example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using Fabric8 Launcher tool on a Minishift or CDK.
For more information, see <a href="#deploying-the-example-application-using-the-launcher-tool_circuit-breaker-osl">Deploying the example application using the Fabric8 Launcher tool</a>.</p>
</li>
<li>
<p>Your Fabric8 Launcher tool URL.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_circuit-breaker-osl">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and to start the pod.</p>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-greeting-1-aaaaa     1/1       Running   0           17s
MY_APP_NAME-greeting-1-deploy    0/1       Completed 0           22s
MY_APP_NAME-name-1-aaaaa         1/1       Running   0           14s
MY_APP_NAME-name-1-deploy        0/1       Completed 0           28s</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both the <code>MY_APP_NAME-greeting-1-aaaaa</code> and <code>MY_APP_NAME-name-1-aaaaa</code> pods should have a status of <code>Running</code> once they are fully deployed and started.
You should also wait for your pods to be ready before proceeding, which is shown in the <code>READY</code> column.
For example, <code>MY_APP_NAME-greeting-1-aaaaa</code> is ready when the <code>READY</code> column is <code>1/1</code>.
Your specific pod names will vary.
The number in the middle will increase with each new build.
The letters at the end are generated when the pod is created.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME-greeting   MY_APP_NAME-greeting-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME            MY_APP_NAME-greeting   8080                    None
MY_APP_NAME-name       MY_APP_NAME-name-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME            MY_APP_NAME-name       8080                    None</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-greeting-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the application.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftcontainerplatform_circuit-breaker">4.5.6. Deploying the Circuit Breaker example application to OpenShift Container Platform</h4>
<div class="paragraph">
<p>The process of creating and deploying example applications to OpenShift Container Platform is similar to OpenShift Online:</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> or <a href="/docs/minishift-installation.html">the Fabric8 Launcher tool</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Follow the instructions in <a href="#deploying-the-example-application-to-openshiftonline_circuit-breaker">Deploying the Circuit Breaker example application to OpenShift Online</a>, only use the URL and user credentials from the OpenShift Container Platform Web Console.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="interacting-with-the-unmodified-example-application_circuit-breaker">4.5.7. Interacting with the unmodified Spring Boot Circuit Breaker example application</h4>
<div class="paragraph">
<p>After you have the Spring Boot example application deployed, you have the following services running:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>MY_APP_NAME-name</code></dt>
<dd>
<p>Exposes the following endpoints:</p>
<div class="ulist">
<ul>
<li>
<p>the <code>/api/name</code> endpoint, which returns a name when this service is working, and an error when this service is set up to demonstrate failure.</p>
</li>
<li>
<p>the <code>/api/state</code> endpoint, which controls the behavior of the <code>/api/name</code> endpoint and determines whether the service works correctly or demonstrates failure.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>MY_APP_NAME-greeting</code></dt>
<dd>
<p>Exposes the following endpoints:</p>
<div class="ulist">
<ul>
<li>
<p>the <code>/api/greeting</code> endpoint that you can call to get a personalized greeting response.</p>
<div class="paragraph">
<p>When you call the <code>/api/greeting</code> endpoint, it issues a call against the <code>/api/name</code> endpoint of the <code>MY_APP_NAME-name</code> service as part of processing your request.
The call made against the <code>/api/name</code> endpoint is protected by the Circuit Breaker.</p>
</div>
<div class="paragraph">
<p>If the remote endpoint is available, the <code>name</code> service responds with an HTTP code <code>200</code> (<code>OK</code>) and you receive the following greeting from the <code>/api/greeting</code> endpoint:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{"content":"Hello, World!"}</pre>
</div>
</div>
<div class="paragraph">
<p>If the remote endpoint is unavailable, the <code>name</code> service responds with an HTTP code <code>500</code> (<code>Internal server error</code>) and you receive a predefined fallback response from the <code>/api/greeting</code> endpoint:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{"content":"Hello, Fallback!"}</pre>
</div>
</div>
</li>
<li>
<p>the <code>/api/cb-state</code> endpoint, which returns the state of the Circuit Breaker.
The state can be:</p>
<div class="ulist">
<ul>
<li>
<p><em>open</em> : the circuit breaker is preventing requests from reaching the failed service,</p>
</li>
<li>
<p><em>closed</em>: the circuit breaker is allowing requests to reach the service.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following steps demonstrate how to verify the availability of the service, simulate a failure and receive a fallback response.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use <code>curl</code> to execute a <code>GET</code> request against the <code>MY_APP_NAME-greeting</code> service. You can also use the <code>Invoke</code> button in the web interface to do this.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-greeting-MY_PROJECT_NAME.LOCAL_OPENSHIFT_HOSTNAME/api/greeting
{"content":"Hello, World!"}</code></pre>
</div>
</div>
</li>
<li>
<p>To simulate the failure of the <code>MY_APP_NAME-name</code> service you can:</p>
<div class="ulist">
<ul>
<li>
<p>use the <code>Toggle</code> button in the web interface.</p>
</li>
<li>
<p>scale the number of replicas of the pod running the <code>MY_APP_NAME-name</code> service down to 0.</p>
</li>
<li>
<p>execute an HTTP <code>PUT</code> request against the <code>/api/state</code> endpoint of the <code>MY_APP_NAME-name</code> service to set its state to <code>fail</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl -X PUT -H "Content-Type: application/json" -d '{"state": "fail"}' http://MY_APP_NAME-name-MY_PROJECT_NAME.LOCAL_OPENSHIFT_HOSTNAME/api/state</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Invoke the <code>/api/greeting</code> endpoint. When several requests on the <code>/api/name</code> endpoint fail:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>the Circuit Breaker opens,</p>
</li>
<li>
<p>the state indicator in the web interface changes from <code>CLOSED</code> to <code>OPEN</code>,</p>
</li>
<li>
<p>the Circuit Breaker issues a fallback response when you invoke the <code>/api/greeting</code> endpoint:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-greeting-MY_PROJECT_NAME.LOCAL_OPENSHIFT_HOSTNAME/api/greeting
{"content":"Hello, Fallback!"}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Restore the name <code>MY_APP_NAME-name</code> service to availability.
To do this you can:</p>
<div class="ulist">
<ul>
<li>
<p>use the <code>Toggle</code> button in the web interface.</p>
</li>
<li>
<p>scale the number of replicas of the pod running the <code>MY_APP_NAME-name</code> service back up to 1.</p>
</li>
<li>
<p>execute an HTTP <code>PUT</code> request against the <code>/api/state</code> endpoint of the <code>MY_APP_NAME-name</code> service to set its state back to <code>ok</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl -X PUT -H "Content-Type: application/json" -d '{"state": "ok"}' http://MY_APP_NAME-name-MY_PROJECT_NAME.LOCAL_OPENSHIFT_HOSTNAME/api/state</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Invoke the <code>/api/greeting</code> endpoint again. When several requests on the <code>/api/name</code> endpoint succeed:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>the Circuit Breaker closes,</p>
</li>
<li>
<p>the state indicator in the web interface changes from <code>OPEN</code> to <code>CLOSED</code>,</p>
</li>
<li>
<p>the Circuit Breaker issues a returns the <code>Hello World!</code> greeting when you invoke the <code>/api/greeting</code> endpoint:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-greeting-MY_PROJECT_NAME.LOCAL_OPENSHIFT_HOSTNAME/api/greeting
{"content":"Hello, World!"}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="running-the-example-application-integration-tests_circuit-breaker">4.5.8. Running the Circuit Breaker example application integration tests</h4>
<div class="paragraph">
<p>This example application includes a self-contained set of integration tests.
When run inside an OpenShift project, the tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy a test instance of the application to the project.</p>
</li>
<li>
<p>Execute the individual tests on that instance.</p>
</li>
<li>
<p>Remove all instances of the application from the project when the testing is done.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Executing integration tests removes all existing instances of the example application from the target OpenShift project.
To avoid accidentally removing your example application, ensure that you create and select a separate OpenShift project to execute the tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>oc</code> client authenticated</p>
</li>
<li>
<p>An empty OpenShift project</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Execute the following command to run the integration tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean verify -Popenshift,openshift-it</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-hystrix-dashboard-to-monitor-the-circuit-breaker_circuit-breaker">4.5.9. Using Hystrix Dashboard to monitor the circuit breaker</h4>
<div class="paragraph">
<p>Hystrix Dashboard lets you easily monitor the health of your services in real time by aggregating Hystrix metrics data from an event stream and displaying them on one screen.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The application deployed</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to your Minishift or CDK cluster.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
<li>
<p>To access the Web console, use your browser to navigate to your Minishift or CDK URL.</p>
</li>
<li>
<p>Navigate to the project that contains your Circuit Breaker application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Import the <a href="https://raw.githubusercontent.com/snowdrop/openshift-templates/master/hystrix-dashboard/hystrix-dashboard.yml">YAML template</a> for the Hystrix Dashboard application.
You can do this by clicking <em>Add to Project</em>, then selecting the <em>Import YAML / JSON</em> tab, and copying the contents of the YAML file into the text box.
Alternatively, you can execute the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc create -f https://raw.githubusercontent.com/snowdrop/openshift-templates/master/hystrix-dashboard/hystrix-dashboard.yml</code></pre>
</div>
</div>
</li>
<li>
<p>Click the <em>Create</em> button to create the Hystrix Dashboard application based on the template.
Alternatively, you can execute the following command.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-app --template=hystrix-dashboard</code></pre>
</div>
</div>
</li>
<li>
<p>Wait for the pod containing Hystrix Dashboard to deploy.</p>
</li>
<li>
<p>Obtain the route of your Hystrix Dashboard application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get route hystrix-dashboard
NAME                HOST/PORT                                                    PATH      SERVICES            PORT      TERMINATION   WILDCARD
hystrix-dashboard   hystrix-dashboard-MY_PROJECT_NAME.LOCAL_OPENSHIFT_HOSTNAME                 hystrix-dashboard   &lt;all&gt;                   None</code></pre>
</div>
</div>
</li>
<li>
<p>To access the Dashboard, open the Dashboard application route URL in your browser.
Alternatively, you can navigate to the <em>Overview</em> screen in the Web console and click the route URL in the header above the pod containing your Hystrix Dashboard application.</p>
</li>
<li>
<p>To use the Dashboard to monitor the <code>MY_APP_NAME-greeting</code> service, replace the default event stream address with the following address and click the <em>Monitor Stream</em> button.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code>http://MY_APP_NAME-greeting-MY_PROJECT_NAME.LOCAL_OPENSHIFT_HOSTNAME/hystrix.stream</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>The Hystrix Dashboard <a href="https://github.com/Netflix/Hystrix/wiki/Dashboard">wiki page</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="circuit-breaker-resources_circuit-breaker">4.5.10. Circuit breaker resources</h4>
<div class="paragraph">
<p>Follow the links below for more background information on the design principles behind the Circuit Breaker pattern</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://microservices.io/patterns/reliability/circuit-breaker.html">microservices.io: Microservice Patterns: Circuit Breaker</a></p>
</li>
<li>
<p><a href="https://martinfowler.com/bliki/CircuitBreaker.html">Martin Fowler: CircuitBreaker</a></p>
</li>
<li>
<p><a href="/docs/vertx-runtime.html#example-circuit-breaker-vertx">Circuit Breaker for Eclipse Vert.x</a></p>
</li>
<li>
<p><a href="/docs/nodejs-runtime.html#example-circuit-breaker-nodejs">Circuit Breaker for Node.js</a></p>
</li>
<li>
<p><a href="/docs/nodejs-runtime.html#example-circuit-breaker-nodejs">Circuit Breaker for Thorntail</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="example-rest-http-secured-spring-boot">4.6. Secured example application for Spring Boot</h3>
<div class="paragraph">
<p><strong>Limitation:</strong> Run this example application on a Minishift or CDK. You can also use a manual workflow to deploy this example to OpenShift Online Pro and OpenShift Container Platform.
This example is not currently available on OpenShift Online Starter.</p>
</div>
<div class="paragraph">
<p>Example proficiency level:
<a href="#proficiency_advanced"><strong>Advanced</strong></a>.</p>
</div>
<div class="paragraph">
<p>The Secured example application secures a REST endpoint using <a href="https://access.redhat.com/products/red-hat-single-sign-on" target="_blank" rel="noopener">Red Hat SSO</a>. (This example expands on the REST API Level 0 example).</p>
</div>
<div class="paragraph">
<p>Red Hat SSO:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implements the <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.1/html/securing_applications_and_services_guide/openid_connect_3">Open ID Connect</a> protocol which is an extension of the OAuth 2.0 specification.</p>
</li>
<li>
<p>Issues access tokens to provide clients with various access rights to secured resources.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Securing an application with SSO enables you to add security to your applications while centralizing the security configuration.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This example comes with Red Hat SSO pre-configured for demonstration purposes, it does not explain its principles, usage, or configuration.
Before using this example, ensure that you are familiar with the basic concepts related to <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.1/html-single/getting_started_guide/" target="_blank" rel="noopener">Red Hat SSO</a>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_the_secured_project_structure">4.6.1. The Secured project structure</h4>
<div class="paragraph">
<p>The SSO example contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the sources for the Greeting service, which is the one which we are going to to secure</p>
</li>
<li>
<p>a template file (<code>service.sso.yaml</code>) to deploy the SSO server</p>
</li>
<li>
<p>the Keycloak adapter configuration to secure the service</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="viewing-the-example-application-source-code-and-readme_secured">4.6.2. Viewing the example application source code and README</h4>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>One of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to developers.redhat.com/launch</p>
</li>
<li>
<p>Fabric8 Launcher installed on a Minishift or CDK</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the Fabric8 Launcher tool to generate your own version of the example application.</p>
</li>
<li>
<p>View the generated GitHub repository or download and extract the ZIP file that contains the example application source code.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="/docs/getting-started.html#deploying-an-example-application-to-openshiftonline_getting-started">Using developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="/docs/getting-started.html#creating-and-deploying-an-example-application-using-your-openshiftlocal_getting-started">Using the Fabric8 Launcher tool on a Minishift or CDK</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="rhsso-deployment-configuration_secured">4.6.3. Red Hat SSO deployment configuration</h4>
<div class="paragraph">
<p>The <code>service.sso.yaml</code> file in this example contains all OpenShift configuration items to deploy a pre-configured Red Hat SSO server.
The SSO server configuration has been simplified for the sake of this exercise and does provide an out-of-the-box configuration, with pre-configured users and security settings.
The <code>service.sso.yaml</code> file also contains very long lines, and some text editors, such as <a href="https://wiki.gnome.org/Apps/Gedit">gedit</a>, may have issues reading this file.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
It is not recommended to use this SSO configuration in production.
Specifically, the simplifications made to the example security configuration impact the ability to use it in a production environment.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. SSO Example Simplifications</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Change</th>
<th class="tableblock halign-left valign-top">Reason</th>
<th class="tableblock halign-left valign-top">Recommendation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The default configuration includes both public and <strong>private keys in the yaml configuration files</strong>.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>We did this because the end user can deploy Red Hat SSO module and have it in a usable state without needing to know the internals or how to configure Red Hat SSO.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>In production, do not store private keys under source control.
They should be added by the server administrator.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The configured <strong>clients accept any callback url</strong>.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>To avoid having a custom configuration for each runtime, we avoid the callback verification that is required by the OAuth2 specification.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An application-specific callback URL should be provided with a valid domain name.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Clients do not require SSL/TLS and the secured applications are not exposed over HTTPS</strong>.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The examples are simplified by not requiring certificates generated for each runtime.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>In production a secure application should use HTTPS rather than plain HTTP.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>The token timeout has been increased to 10 minutes from the default of 1 minute.</strong></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Provides a better user experience when working with the command line examples</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>From a security perspective, the window an attacker would have to guess the access token is extended.
It is recommended to keep this window short as it makes it much harder for a potential attacker to guess the current token.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="rhsso-realm-model_secured">4.6.4. Red Hat SSO realm model</h4>
<div class="paragraph">
<p>The <code>master</code> realm is used to secure this example.
There are two pre-configured application client definitions that provide a model for command line clients and the secured REST endpoint.</p>
</div>
<div class="paragraph">
<p>There are also two pre-configured users in the Red Hat SSO <code>master</code> realm that can be used to validate various authentication and authorization outcomes:  <code>admin</code> and <code>alice</code>.</p>
</div>
<div class="sect4">
<h5 id="_red_hat_sso_users">Red Hat SSO users</h5>
<div class="paragraph">
<p>The realm model for the secured examples includes two users:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">admin</dt>
<dd>
<p>The <code>admin</code> user has a password of <code>admin</code> and is the realm administrator.
This user has full access to the Red Hat SSO administration console, but none of the role mappings that are required to access the secured endpoints.
You can use this user to illustrate the behavior of an authenticated, but unauthorized user.</p>
</dd>
<dt class="hdlist1">alice</dt>
<dd>
<p>The <code>alice</code> user has a password of <code>password</code> and is the canonical application user.
This user will demonstrate successful authenticated and authorized access to the secured endpoints.
An example representation of the role mappings is provided in this decoded JWT bearer token:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-json hljs" data-lang="json">{
  "jti": "0073cfaa-7ed6-4326-ac07-c108d34b4f82",
  "exp": 1510162193,
  "nbf": 0,
  "iat": 1510161593,
  "iss": "https://secure-sso-sso.LOCAL_OPENSHIFT_HOSTNAME/auth/realms/master", <i class="conum" data-value="1"></i><b>(1)</b>
  "aud": "demoapp",
  "sub": "c0175ccb-0892-4b31-829f-dda873815fe8",
  "typ": "Bearer",
  "azp": "demoapp",
  "nonce": "90ff5d1a-ba44-45ae-a413-50b08bf4a242",
  "auth_time": 1510161591,
  "session_state": "98efb95a-b355-43d1-996b-0abcb1304352",
  "acr": "1",
  "client_session": "5962112c-2b19-461e-8aac-84ab512d2a01",
  "allowed-origins": [
    "*"
  ],
  "realm_access": {
    "roles": [ <i class="conum" data-value="2"></i><b>(2)</b>
      "example-admin"
    ]
  },
  "resource_access": { <i class="conum" data-value="3"></i><b>(3)</b>
    "secured-example-endpoint": {
      "roles": [
        "example-admin" <i class="conum" data-value="4"></i><b>(4)</b>
      ]
    },
    "account": {
      "roles": [
        "manage-account",
        "view-profile"
      ]
    }
  },
  "name": "Alice InChains",
  "preferred_username": "alice", <i class="conum" data-value="5"></i><b>(5)</b>
  "given_name": "Alice",
  "family_name": "InChains",
  "email": "alice@keycloak.org"
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>iss</code> field corresponds to the Red Hat SSO realm instance URL that issues the token. This must be configured in the secured endpoint deployments in order for the token to be verified.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>roles</code> object provides the roles that have been granted to the user at the global realm level. In this case
<code>alice</code> has been granted the <code>example-admin</code> role. We will see that the secured endpoint will look to the realm level for authorized roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>resource_access</code> object contains resource specific role grants. Under this object you will find an object
for each of the secured endpoints.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>resource_access.secured-example-endpoint.roles</code> object contains the roles granted to <code>alice</code> for the <code>secured-example-endpoint</code> resource.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <code>preferred_username</code> field provides the username that was used to generate the access token.</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_the_application_clients">The application clients</h5>
<div class="paragraph">
<p>The OAuth 2.0 specification allows you to define a role for application clients that access secured resources on behalf of resource owners. The <code>master</code> realm has the following application clients defined:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">demoapp</dt>
<dd>
<p>This is a <code>confidential</code> type client with a client secret that is used to obtain an access token. The token contains grants for the <code>alice</code> user which enable <code>alice</code> to access the Thorntail, Eclipse Vert.x, Node.js and Spring Boot based REST example application deployments.</p>
</dd>
<dt class="hdlist1">secured-example-endpoint</dt>
<dd>
<p>The <code>secured-example-endpoint</code> is a bearer-only type of client that requires a <code>example-admin</code> role for accessing the associated resources, specifically the Greeting service.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="springboot-sso-adapter-configuration_secured">4.6.5. Spring Boot SSO adapter configuration</h4>
<div class="paragraph">
<p>The SSO adapter is the <em>client side</em>, or client to the SSO server, component that enforces security on the web resources.
In this specific case, it is the Greeting service.</p>
</div>
<div class="paragraph">
<p>Both the SSO adapter and endpoint security are configured in <code>src/main/resources/application.properties</code>.</p>
</div>
<div class="listingblock">
<div class="title">Example application.properties file</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ # Adapter configuration
keycloak.realm=${realm:master} <i class="conum" data-value="1"></i><b>(1)</b>
keycloak.realm-key=...
keycloak.auth-server-url=${sso.auth.server.url} <i class="conum" data-value="2"></i><b>(2)</b>
keycloak.resource=${client.id:secured-example-endpoint} <i class="conum" data-value="3"></i><b>(3)</b>
keycloak.credentials.secret=${secret:1daa57a2-b60e-468b-a3ac-25bd2dc2eadc} <i class="conum" data-value="4"></i><b>(4)</b>
keycloak.use-resource-role-mappings=true <i class="conum" data-value="5"></i><b>(5)</b>
keycloak.bearer-only=true <i class="conum" data-value="6"></i><b>(6)</b>
# Endpoint security configuration
keycloak.securityConstraints[0].securityCollections[0].name=admin stuff <i class="conum" data-value="7"></i><b>(7)</b>
keycloak.securityConstraints[0].securityCollections[0].authRoles[0]=example-admin <i class="conum" data-value="8"></i><b>(8)</b>
keycloak.securityConstraints[0].securityCollections[0].patterns[0]=/api/greeting <i class="conum" data-value="9"></i><b>(9)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The security realm to be used.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The address of the Red Hat SSO server (Interpolation at build time).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The actual keycloak <em>client</em> configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Secret to access authentication server.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Check the token for application level role mappings for the user.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>If enabled the adapter will not attempt to authenticate users, but only verify bearer tokens.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>A simple name for the security constraint.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>A roles needed to access a secured endpoint.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>A secured endpoints path pattern.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-secured-example-application-to-openshiftlocal_secured">4.6.6. Deploying the Secured example application to Minishift or CDK</h4>
<div class="sect4">
<h5 id="getting-the-launcher-tool-url-and-credentials_secured-osl">Getting the Fabric8 Launcher tool URL and credentials</h5>
<div class="paragraph">
<p>You need the Fabric8 Launcher tool URL and user credentials to create and deploy example applications on Minishift or CDK. This information is provided when the Minishift or CDK is started.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Fabric8 Launcher tool installed, configured, and running. For more information, see the <a href="/docs/minishift-installation.html">Install and Configure the Fabric8 Launcher Tool</a> guide.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the console where you started Minishift or CDK.</p>
</li>
<li>
<p>Check the console output for the URL and user credentials you can use to access the running Fabric8 Launcher:</p>
<div class="listingblock">
<div class="title">Example Console Output from a Minishift or CDK Startup</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">...
-- Removing temporary directory ... OK
-- Server Information ...
   OpenShift server started.
   The server is accessible via web console at:
       https://192.168.42.152:8443

   You are logged in as:
       User:     developer
       Password: developer

   To login as administrator:
       oc login -u system:admin</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="creating-the-secured-example-application-using-launcher_secured-osl">Creating the Secured example application using Fabric8 Launcher</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL and user credentials of your running Fabric8 Launcher instance.
For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_secured-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Navigate to the Fabric8 Launcher URL in a browser and log in.</p>
</li>
<li>
<p>Follow the on-screen instructions to create your example in Spring Boot.
When asked about which deployment type, select <em>I will build and run locally.</em></p>
</li>
<li>
<p>Follow on-screen instructions.</p>
<div class="paragraph">
<p>When done, click the <strong>Download as ZIP file</strong> button and store the file on your hard drive.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_secured-osl">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on Minishift or CDK using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the Minishift or CDK web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK. For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_secured-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Minishift or CDK URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your Minishift or CDK account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-secured-example-application-using-the-oc-client_secured-osl">Deploying the Secured example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using the Fabric8 Launcher tool on a Minishift or CDK.
For more information, see <a href="#creating-the-secured-example-application-using-launcher_secured-osl">Creating the Secured example application using Fabric8 Launcher</a>.</p>
</li>
<li>
<p>Your Fabric8 Launcher URL.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_secured-osl">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Deploy the Red Hat SSO server using the <code>service.sso.yaml</code> file from your example ZIP file:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc create -f service.sso.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Use Maven to start the deployment to Minishift or CDK.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift -DskipTests \
      -DSSO_AUTH_SERVER_URL=$(oc get route secure-sso -o jsonpath='{"https://"}{.spec.host}{"/auth\n"}')</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on Minishift or CDK and to start the pod.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This process generates the uberjar file as well as the OpenShift resources and deploys them to the current project on your Minishift or CDK server.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-secured-example-application-to-openshiftcontainerplatform_secured">4.6.7. Deploying the Secured example application to OpenShift Container Platform</h4>
<div class="paragraph">
<p>In addition to the Minishift or CDK, you can create and deploy the example on OpenShift Container Platform with only minor differences. The most important difference is that you need to create the example application on Minishift or CDK before you can deploy it with OpenShift Container Platform.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example created using <a href="#deploying-the-secured-example-application-to-openshiftlocal_secured">Minishift or CDK</a>.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_secured-ocp">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on OpenShift Container Platform using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the OpenShift Container Platform web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at OpenShift Container Platform.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the OpenShift Container Platform URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your OpenShift Container Platform account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-secured-example-application-using-the-oc-client_secured-ocp">Deploying the Secured example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using the Fabric8 Launcher tool on a Minishift or CDK.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_secured-ocp">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new OpenShift project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Deploy the Red Hat SSO server using the <code>service.sso.yaml</code> file from your example ZIP file:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc create -f service.sso.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift Container Platform.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift -DskipTests \
      -DSSO_AUTH_SERVER_URL=$(oc get route secure-sso -o jsonpath='{"https://"}{.spec.host}{"/auth\n"}')</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift Container Platform and to start the pod.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This process generates the uberjar file as well as the OpenShift resources and deploys them to the current project on your OpenShift Container Platform server.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="authenticating-to-the-secured-example-application-api-endpoint_secured">4.6.8. Authenticating to the Secured example application API endpoint</h4>
<div class="paragraph">
<p>The Secured example application provides a default HTTP endpoint that accepts <code>GET</code> requests if the caller is authenticated and authorized.
The client first authenticates against the Red Hat SSO server and then performs a <code>GET</code> request against the Secured example application using the access token returned by the authentication step.</p>
</div>
<div class="sect4">
<h5 id="getting-the-secured-example-application-api-endpoint_secured">Getting the Secured example application API endpoint</h5>
<div class="paragraph">
<p>When using a client to interact with the example, you must specify the Secured example application endpoint, which is the <em>PROJECT_ID</em> service.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Secured example application deployed and running.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a terminal application, execute the <code>oc get routes</code> command.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>A sample output is shown in the following table:</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. List of Secured endpoints</div>
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Host/Port</th>
<th class="tableblock halign-left valign-top">Path</th>
<th class="tableblock halign-left valign-top">Services</th>
<th class="tableblock halign-left valign-top">Port</th>
<th class="tableblock halign-left valign-top">Termination</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">secure-sso</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secure-sso-myproject.LOCAL_OPENSHIFT_HOSTNAME</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secure-sso</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;all&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">passthrough</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT_ID-myproject.LOCAL_OPENSHIFT_HOSTNAME</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROJECT_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;all&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sso</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sso-myproject.LOCAL_OPENSHIFT_HOSTNAME</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sso</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;all&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the above example, the example endpoint would be <code>http://PROJECT_ID-myproject.LOCAL_OPENSHIFT_HOSTNAME</code>.
<code>PROJECT_ID</code> is based on the name you entered when generating your example using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> or the Fabric8 Launcher tool.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-http-requests-using-the-command-line_secured">Authenticating HTTP requests using the command line</h5>
<div class="paragraph">
<p>Request a token by sending a HTTP POST request to the Red Hat SSO server.
In the following example, the <a href="https://stedolan.github.io/jq/">jq CLI tool</a> is used to extract the token value from the JSON response.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The secured example endpoint URL. For more information, see <a href="#getting-the-secured-example-application-api-endpoint_secured">Getting the Secured example application API endpoint</a>.</p>
</li>
<li>
<p>The <code>jq</code> command-line tool (optional). To download the tool and for more information, see <a href="https://stedolan.github.io/jq/" class="bare">https://stedolan.github.io/jq/</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Request an access token with <code>curl</code>, the credentials, and <code>&lt;SSO_AUTH_SERVER_URL&gt;</code> and extract the token from the response with the <code>jq</code> command:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -sk -X POST https://&lt;SSO_AUTH_SERVER_URL&gt;/auth/realms/master/protocol/openid-connect/token \
  -d grant_type=password \
  -d username=alice\
  -d password=password \
  -d client_id=demoapp \
  -d client_secret=1daa57a2-b60e-468b-a3ac-25bd2dc2eadc \
  | jq -r '.access_token'

eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJRek1nbXhZMUhrQnpxTnR0SnkwMm5jNTNtMGNiWDQxV1hNSTU1MFo4MGVBIn0.eyJqdGkiOiI0NDA3YTliNC04YWRhLTRlMTctODQ2ZS03YjI5MjMyN2RmYTIiLCJleHAiOjE1MDc3OTM3ODcsIm5iZiI6MCwiaWF0IjoxNTA3NzkzNzI3LCJpc3MiOiJodHRwczovL3NlY3VyZS1zc28tc3NvLWRlbW8uYXBwcy5jYWZlLWJhYmUub3JnL2F1dGgvcmVhbG1zL21hc3RlciIsImF1ZCI6ImRlbW9hcHAiLCJzdWIiOiJjMDE3NWNjYi0wODkyLTRiMzEtODI5Zi1kZGE4NzM4MTVmZTgiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJkZW1vYXBwIiwiYXV0aF90aW1lIjowLCJzZXNzaW9uX3N0YXRlIjoiMDFjOTkzNGQtNmZmOS00NWYzLWJkNWUtMTU4NDI5ZDZjNDczIiwiYWNyIjoiMSIsImNsaWVudF9zZXNzaW9uIjoiMzM3Yzk0MTYtYTdlZS00ZWUzLThjZWQtODhlODI0MGJjNTAyIiwiYWxsb3dlZC1vcmlnaW5zIjpbIioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImJvb3N0ZXItYWRtaW4iXX0sInJlc291cmNlX2FjY2VzcyI6eyJzZWN1cmVkLWJvb3N0ZXItZW5kcG9pbnQiOnsicm9sZXMiOlsiYm9vc3Rlci1hZG1pbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsInZpZXctcHJvZmlsZSJdfX0sIm5hbWUiOiJBbGljZSBJbkNoYWlucyIsInByZWZlcnJlZF91c2VybmFtZSI6ImFsaWNlIiwiZ2l2ZW5fbmFtZSI6IkFsaWNlIiwiZmFtaWx5X25hbWUiOiJJbkNoYWlucyIsImVtYWlsIjoiYWxpY2VAa2V5Y2xvYWsub3JnIn0.mjmZe37enHpigJv0BGuIitOj-kfMLPNwYzNd3n0Ax4Nga7KpnfytGyuPSvR4KAG8rzkfBNN9klPYdy7pJEeYlfmnFUkM4EDrZYgn4qZAznP1Wzy1RfVRdUFi0-GqFTMPb37o5HRldZZ09QljX_j3GHnoMGXRtYW9RZN4eKkYkcz9hRwgfJoTy2CuwFqeJwZYUyXifrfA-JoTr0UmSUed-0NMksGrtJjjPggUGS-qOn6OgKcmN2vaVAQlxW32y53JqUXctfLQ6DhJzIMYTmOflIPy0sgG1mG7sovQhw1xTg0vTjdx8zQ-EJcexkj7IivRevRZsslKgqRFWs67jQAFQA</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>&lt;SSO_AUTH_SERVER_URL&gt;</code> is the url of the <code>secure-sso</code> service.</p>
</div>
<div class="paragraph">
<p>The attributes, such as <code>username</code>, <code>password</code>, and <code>client_secret</code> are usually kept secret, but the above command uses the default provided credentials with this example for demonstration purpose.</p>
</div>
<div class="paragraph">
<p>If you do not want to use <code>jq</code> to extract the token, you can run just the <code>curl</code> command and manually extract the access token.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>-sk</code> option tells curl to ignore failures resulting from self-signed certificates. Do not use this option in a production environment. On macOS, you must have <code>curl</code> version <code>7.56.1</code> or greater installed. It must also be built with OpenSSL.
</td>
</tr>
</table>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Invoke the Secured service. Attach the access (bearer) token to the HTTP headers:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl -v -H "Authorization: Bearer &lt;TOKEN&gt;" http://&lt;SERVICE_HOST&gt;/api/greeting

{
    "content": "Hello, World!",
    "id": 2
}</code></pre>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 2. A sample <code>GET</code> Request Headers with an Access (Bearer) Token</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">&gt; GET /api/greeting HTTP/1.1
&gt; Host: &lt;SERVICE_HOST&gt;
&gt; User-Agent: curl/7.51.0
&gt; Accept: */*
&gt; Authorization: Bearer &lt;TOKEN&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>&lt;SERVICE_HOST&gt;</code> is the URL of the secured example endpoint.
For more information, see <a href="#getting-the-secured-example-application-api-endpoint_secured">Getting the Secured example application API endpoint</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p>Verify the signature of the access token.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The access token is a <a href="https://jwt.io">JSON Web Token</a>, so you can decode it using the <a href="https://jwt.io/#debugger-io">JWT Debugger</a>:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In a web browser, navigate to the <a href="https://jwt.io/#debugger-io">JWT Debugger</a> website.</p>
</li>
<li>
<p>Select <code>RS256</code> from the <em>Algorithm</em> drop down menu.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make sure the web form has been updated after you made the selection, so it displays the correct RSASHA256(&#8230;&#8203;) information in the Signature section. If it has not, try switching to HS256 and then back to RS256.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Paste the following content in the topmost text box into the <em>VERIFY SIGNATURE</em> section:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-base64 hljs" data-lang="base64">-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoETnPmN55xBJjRzN/cs30OzJ9olkteLVNRjzdTxFOyRtS2ovDfzdhhO9XzUcTMbIsCOAZtSt8K+6yvBXypOSYvI75EUdypmkcK1KoptqY5KEBQ1KwhWuP7IWQ0fshUwD6jI1QWDfGxfM/h34FvEn/0tJ71xN2P8TI2YanwuDZgosdobx/PAvlGREBGuk4BgmexTOkAdnFxIUQcCkiEZ2C41uCrxiS4CEe5OX91aK9HKZV4ZJX6vnqMHmdDnsMdO+UFtxOBYZio+a1jP4W3d7J5fGeiOaXjQCOpivKnP2yU2DPdWmDMyVb67l8DRA+jh0OJFKZ5H2fNgE3II59vdsRwIDAQAB
-----END PUBLIC KEY-----</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is the master realm public key from the Red Hat SSO server deployment of the Secured example application.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Paste the <code>token</code> output from the client output into the <em>Encoded</em> box.</p>
<div class="paragraph">
<p>The <em>Signature Verified</em> sign is displayed on the debugger page.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-http-requests-using-the-web-interface_secured">Authenticating HTTP requests using the web interface</h5>
<div class="paragraph">
<p>In addition to the HTTP API, the secured endpoint also contains a web interface to interact with.</p>
</div>
<div class="paragraph">
<p>The following procedure is an exercise for you to see how security is enforced, how you authenticate, and how you work with the authentication token.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The secured endpoint URL. For more information, see <a href="#getting-the-secured-example-application-api-endpoint_secured">Getting the Secured example application API endpoint</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a web browser, navigate to the endpoint URL.</p>
</li>
<li>
<p>Perform an unauthenticated request:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click the <em>Invoke</em> button.</p>
<div class="openblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="images/sso-main.png" alt="sso main">
</div>
<div class="title">Figure 1. Unauthenticated Secured Example Web Interface</div>
</div>
<div class="paragraph">
<p>The services responds with an <code>HTTP 401 Unauthorized</code> status code.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/sso-unauthenticated.png" alt="sso unauthenticated">
</div>
<div class="title">Figure 2. Unauthenticated Error Message</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Perform an authenticated request as a user:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click the <em>Login</em> button to authenticate against Red Hat SSO. You will be redirected to the SSO server.</p>
</li>
<li>
<p>Log in as <a href="#rhsso-realm-model_secured">the <em>Alice</em> user</a>. You will be redirected back to the web interface.</p>
<div class="openblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can see the access (bearer) token in the command line output at the bottom of the page.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/sso-alice.png" alt="sso alice">
</div>
<div class="title">Figure 3. Authenticated Secured Example Web Interface (as Alice)</div>
</div>
</div>
</div>
</li>
<li>
<p>Click <em>Invoke</em> again to access the Greeting service.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Confirm that there is no exception and the JSON response payload is displayed. This means the service accepted your access (bearer) token and you are authorized access to the Greeting service.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/sso-invoke-alice.png" alt="sso invoke alice">
</div>
<div class="title">Figure 4. The Result of an Authenticated Greeting Request (as Alice)</div>
</div>
</div>
</div>
</li>
<li>
<p>Log out.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Perform an authenticated request as an admininstrator:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click the <em>Invoke</em> button.</p>
<div class="paragraph">
<p>Confirm that this sends an unauthenticated request to the Greeting service.</p>
</div>
</li>
<li>
<p>Click the <em>Login</em> button and log in as <a href="#rhsso-realm-model_secured">the <em>admin</em> user</a>.</p>
<div class="imageblock">
<div class="content">
<img src="images/sso-admin.png" alt="sso admin">
</div>
<div class="title">Figure 5. Authenticated Secured Example Web Interface (as admin)</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Click the <em>Invoke</em> button.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The service responds with an <code>HTTP 403 Forbidden</code> status code because the <em>admin</em> user is not authorized to access the Greeting service.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/sso-unauthorized.png" alt="sso unauthorized">
</div>
<div class="title">Figure 6. Unauthorized Error Message</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-the-springboot-secured-example-application-integration-tests_secured">4.6.9. Running the Spring Boot Secured example application integration tests</h4>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>oc</code> client authenticated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>&#160;</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Executing integration tests removes all existing instances of the example application from the target OpenShift project.
To avoid accidentally removing your example application, ensure that you create and select a separate OpenShift project to execute the tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a terminal application, navigate to the directory with your project.</p>
</li>
<li>
<p>Create the Red Hat SSO server application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc create -f service.sso.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Wait until the Red Hat SSO server is ready. Go to the Web console or view the output of <code>oc get pods</code> to check if the pod running the Red Hat SSO server is ready.</p>
</li>
<li>
<p>Execute the integration tests:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">mvn clean verify -Popenshift,openshift-it -DSSO_AUTH_SERVER_URL=$(oc get route secure-sso -o jsonpath='{"https://"}{.spec.host}{"/auth\n"}')</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="secured-sso-resources_secured">4.6.10. Secured SSO resources</h4>
<div class="paragraph">
<p>Follow the links below for additional information on the principles behind the OAuth2 specification and on securing your applications using Red Hat SSO and Keycloak:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://aaronparecki.com/oauth-2-simplified/">Aaron Parecki: OAuth2 Simplified</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en/red-hat-single-sign-on?version=7.1/">Red Hat SSO 7.1 Documentation</a></p>
</li>
<li>
<p><a href="http://www.keycloak.org/archive/documentation-3.2.html">Keycloak 3.2 Documentation</a></p>
</li>
<li>
<p><a href="/docs/vertx-runtime.html#example-rest-http-secured-vertx">Secured for Eclipse Vert.x</a></p>
</li>
<li>
<p><a href="/docs/thorntail-runtime.html#example-rest-http-secured-wf-swarm">Secured for Thorntail</a></p>
</li>
<li>
<p><a href="/docs/nodejs-runtime.html#example-rest-http-secured-nodejs">Secured for Node.js</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="example-cache-spring-boot">4.7. Cache example for Spring Boot</h3>
<div class="paragraph">
<p><strong>Limitation:</strong> Run this example application on a Minishift or CDK. You can also use a manual workflow to deploy this example to OpenShift Online Pro and OpenShift Container Platform.
This example is not currently available on OpenShift Online Starter.</p>
</div>
<div class="paragraph">
<p>Example proficiency level: <a href="#proficiency_advanced"><strong>Advanced</strong></a>.</p>
</div>
<div class="paragraph">
<p>The Cache example demonstrates how to use a cache to increase the response time of applications.</p>
</div>
<div class="paragraph">
<p>This example shows you how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy a cache to OpenShift.</p>
</li>
<li>
<p>Use a cache within an application.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="how-caching-works-and-when-you-need-it_cache">4.7.1. How caching works and when you need it</h4>
<div class="paragraph">
<p>Caches allows you to store information and access it for a given period of time.
You can access information in a cache faster or more reliably than repeatedly calling the original service.
A disadvantage of using a cache is that the cached information is not up to date.
However, that problem can be reduced by setting an <em>expiration</em> or TTL (time to live) on each value stored in the cache.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Caching example</div>
<div class="content">
<div class="paragraph">
<p>Assume you have two applications: <em>service1</em> and <em>service2</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Service1</em> depends on a value from <em>service2</em>.</p>
<div class="ulist">
<ul>
<li>
<p>If the value from <em>service2</em> infrequently changes, <em>service1</em> could cache the value from <em>service2</em> for a period of time.</p>
</li>
<li>
<p>Using cached values can also reduce the number of times <em>service2</em> is called.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If it takes <em>service1</em> 500 ms to retrieve the value directly from <em>service2</em>, but 100 ms to retrieve the cached value, <em>service1</em> would save 400 ms by using the cached value for each cached call.</p>
</li>
<li>
<p>If <em>service1</em> would make uncached calls to <em>service2</em> 5 times per second, over 10 seconds, that would be 50 calls.</p>
</li>
<li>
<p>If <em>service1</em> started using a cached value with a TTL of 1 second instead, that would be reduced to 10 calls over 10 seconds.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="olist arabic">
<div class="title">How the Cache example works</div>
<ol class="arabic">
<li>
<p>The <em>cache</em>, <em>cute name</em>, and <em>greeting</em> services are deployed and exposed.</p>
</li>
<li>
<p>User accesses the web frontend of the <em>greeting</em> service.</p>
</li>
<li>
<p>User invokes the <em>greeting</em> HTTP API using a button on the web frontend.</p>
</li>
<li>
<p>The <em>greeting</em> service depends on a value from the <em>cute name</em> service.</p>
<div class="ulist">
<ul>
<li>
<p>The <em>greeting</em> service first checks if that value is stored in the <em>cache</em> service. If it is, then the cached value is returned.</p>
</li>
<li>
<p>If the value is not cached, the <em>greeting</em> service calls the <em>cute name</em> service, returns the value, and stores the value in the <em>cache</em> service with a TTL of 5 seconds.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The web front end displays the response from the <em>greeting</em> service as well as the total time of the operation.</p>
</li>
<li>
<p>User invokes the service multiple times to see the difference between cached and uncached operations.</p>
<div class="ulist">
<ul>
<li>
<p>Cached operations are significantly faster than uncached operations.</p>
</li>
<li>
<p>User can force the cache to be cleared before the TTL expires.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="viewing-the-example-application-source-code-and-readme_cache">4.7.2. Viewing the example application source code and README</h4>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>One of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to developers.redhat.com/launch</p>
</li>
<li>
<p>Fabric8 Launcher installed on a Minishift or CDK</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the Fabric8 Launcher tool to generate your own version of the example application.</p>
</li>
<li>
<p>View the generated GitHub repository or download and extract the ZIP file that contains the example application source code.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="/docs/getting-started.html#deploying-an-example-application-to-openshiftonline_getting-started">Using developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="/docs/getting-started.html#creating-and-deploying-an-example-application-using-your-openshiftlocal_getting-started">Using the Fabric8 Launcher tool on a Minishift or CDK</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftonline_cache">4.7.3. Deploying the Cache example application to OpenShift Online</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Cache example application on OpenShift Online.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-launcher-oso_cache-oso">Use developers.redhat.com/launch</a></p>
</li>
<li>
<p><a href="#deploying-the-cache-example-application-using-the-oc-cli-client_cache-oso">Use the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using developers.redhat.com/launch provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-launcher-oso_cache-oso">Deploying the example application using developers.redhat.com/launch</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> URL in a browser and log in.</p>
</li>
<li>
<p>Follow on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_cache-oso">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on <a href="https://manage.openshift.com">OpenShift Online</a> using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the <a href="https://manage.openshift.com">OpenShift Online</a> web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An account at <a href="https://manage.openshift.com">OpenShift Online</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <a href="https://manage.openshift.com">OpenShift Online</a> URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your <a href="https://manage.openshift.com">OpenShift Online</a> account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-cache-example-application-using-the-oc-cli-client_cache-oso">Deploying the Cache example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a>.
For more information, see <a href="#deploying-the-example-application-using-launcher-oso_cache-oso">Deploying the example application using developers.redhat.com/launch</a>.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_cache-oso">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Deploy the cache service.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc apply -f service.cache.yml</code></pre>
</div>
</div>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
cache-server-123456789-aaaaa             1/1       Running     0          8m
MY_APP_NAME-cutename-1-bbbbb       1/1       Running     0          4m
MY_APP_NAME-cutename-s2i-1-build   0/1       Completed   0          7m
MY_APP_NAME-greeting-1-ccccc       1/1       Running     0          3m
MY_APP_NAME-greeting-s2i-1-build   0/1       Completed   0          3m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your 3 pods should have a status of <code>Running</code> once they are fully deployed and started.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME-cutename   MY_APP_NAME-cutename-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME             MY_APP_NAME-cutename   8080                    None
MY_APP_NAME-greeting   MY_APP_NAME-greeting-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME             MY_APP_NAME-greeting   8080                    None</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-greeting-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the greeting service.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftlocal_cache">4.7.4. Deploying the Cache example application to Minishift or CDK</h4>
<div class="paragraph">
<p>Use one of the following options to execute the Cache example application locally on Minishift or CDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#deploying-the-example-application-using-the-launcher-tool_cache-osl">Using Fabric8 Launcher</a></p>
</li>
<li>
<p><a href="#deploying-the-cache-example-application-using-the-oc-cli-client_cache-osl">Using the <code>oc</code> CLI client</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Although each method uses the same <code>oc</code> commands to deploy your application, using Fabric8 Launcher provides an automated deployment workflow that executes the <code>oc</code> commands for you.</p>
</div>
<div class="sect4">
<h5 id="getting-the-launcher-tool-url-and-credentials_cache-osl">Getting the Fabric8 Launcher tool URL and credentials</h5>
<div class="paragraph">
<p>You need the Fabric8 Launcher tool URL and user credentials to create and deploy example applications on Minishift or CDK. This information is provided when the Minishift or CDK is started.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Fabric8 Launcher tool installed, configured, and running. For more information, see the <a href="/docs/minishift-installation.html">Install and Configure the Fabric8 Launcher Tool</a> guide.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the console where you started Minishift or CDK.</p>
</li>
<li>
<p>Check the console output for the URL and user credentials you can use to access the running Fabric8 Launcher:</p>
<div class="listingblock">
<div class="title">Example Console Output from a Minishift or CDK Startup</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">...
-- Removing temporary directory ... OK
-- Server Information ...
   OpenShift server started.
   The server is accessible via web console at:
       https://192.168.42.152:8443

   You are logged in as:
       User:     developer
       Password: developer

   To login as administrator:
       oc login -u system:admin</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-example-application-using-the-launcher-tool_cache-osl">Deploying the example application using the Fabric8 Launcher tool</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK.
For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_cache-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Fabric8 Launcher URL in a browser.</p>
</li>
<li>
<p>Follow the on-screen instructions to create and launch your example application in Spring Boot.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="authenticating-the-oc-cli-client_cache-osl">Authenticating the <code>oc</code> CLI client</h5>
<div class="paragraph">
<p>To work with example applications on Minishift or CDK using the <code>oc</code> command-line client, you must authenticate the client using the token provided by the Minishift or CDK web interface.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The URL of your running Fabric8 Launcher instance and the user credentials of your Minishift or CDK. For more information, see <a href="#getting-the-launcher-tool-url-and-credentials_cache-osl">Getting the Fabric8 Launcher tool URL and credentials</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the Minishift or CDK URL in a browser.</p>
</li>
<li>
<p>Click on the question mark icon in the top right-hand corner of the Web console, next to your user name.</p>
</li>
<li>
<p>Select <em>Command Line Tools</em> in the drop-down menu.</p>
</li>
<li>
<p>Find the text box that contains the <code>oc login &#8230;&#8203;</code> command with the hidden token, and click the button next to it to copy its content to your clipboard.</p>
</li>
<li>
<p>Paste the command into a terminal application. The command uses your authentication token to authenticate your <code>oc</code> CLI client with your Minishift or CDK account.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login OPENSHIFT_URL --token=MYTOKEN</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="deploying-the-cache-example-application-using-the-oc-cli-client_cache-osl">Deploying the Cache example application using the <code>oc</code> CLI client</h5>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using Fabric8 Launcher tool on a Minishift or CDK.
For more information, see <a href="#deploying-the-example-application-using-the-launcher-tool_cache-osl">Deploying the example application using the Fabric8 Launcher tool</a>.</p>
</li>
<li>
<p>Your Fabric8 Launcher tool URL.</p>
</li>
<li>
<p>The <code>oc</code> client authenticated. For more information, see <a href="#authenticating-the-oc-cli-client_cache-osl">Authenticating the <code>oc</code> CLI client</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Clone your project from GitHub.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ git clone git@github.com:USERNAME/MY_PROJECT_NAME.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you downloaded a ZIP file of your project, extract it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ unzip MY_PROJECT_NAME.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the root directory of your application.</p>
</li>
<li>
<p>Deploy the cache service.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc apply -f service.cache.yml</code></pre>
</div>
</div>
</li>
<li>
<p>Use Maven to start the deployment to OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
</li>
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
cache-server-123456789-aaaaa             1/1       Running     0          8m
MY_APP_NAME-cutename-1-bbbbb       1/1       Running     0          4m
MY_APP_NAME-cutename-s2i-1-build   0/1       Completed   0          7m
MY_APP_NAME-greeting-1-ccccc       1/1       Running     0          3m
MY_APP_NAME-greeting-s2i-1-build   0/1       Completed   0          3m</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your 3 pods should have a status of <code>Running</code> once they are fully deployed and started.</p>
</div>
</li>
<li>
<p>After your example application is deployed and started, determine its route.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME-cutename   MY_APP_NAME-cutename-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME             MY_APP_NAME-cutename   8080                    None
MY_APP_NAME-greeting   MY_APP_NAME-greeting-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME             MY_APP_NAME-greeting   8080                    None</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it. In the example above, you would use <code>http://MY_APP_NAME-greeting-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> as the base URL to access the greeting service.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-the-example-application-to-openshiftcontainerplatform_cache">4.7.5. Deploying the Cache example application to OpenShift Container Platform</h4>
<div class="paragraph">
<p>The process of creating and deploying example applications to OpenShift Container Platform is similar to OpenShift Online:</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The example application created using <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> or <a href="/docs/minishift-installation.html">the Fabric8 Launcher tool</a>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Procedure</div>
<ul>
<li>
<p>Follow the instructions in <a href="#deploying-the-example-application-to-openshiftonline_cache">Deploying the Cache example application to OpenShift Online</a>, only use the URL and user credentials from the OpenShift Container Platform Web Console.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="interacting-with-the-unmodified-cache-example-application_cache">4.7.6. Interacting with the unmodified Cache example application</h4>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your application deployed</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <code>greeting</code> service using your browser.</p>
</li>
<li>
<p>Click <em>Invoke the service</em> once.</p>
<div class="paragraph">
<p>Notice the <code>duration</code> value is above <code>2000</code>.
Also notice the cache state has changed form <code>No cached value</code> to <code>A value is cached</code>.</p>
</div>
</li>
<li>
<p>Wait 5 seconds and notice cache state has changed back to <code>No cached value</code>.</p>
<div class="paragraph">
<p>The TTL for the cached value is set to 5 seconds.
When the TTL expires, the value is no longer cached.</p>
</div>
</li>
<li>
<p>Click <em>Invoke the service</em> once more to cache the value.</p>
</li>
<li>
<p>Click <em>Invoke the service</em> a few more times over the course of a few seconds while cache state is <code>A value is cached</code>.</p>
<div class="paragraph">
<p>Notice a significantly lower <code>duration</code> value since it is using a cached value.
If you click <em>Clear the cache</em>, the cache is emptied.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="running-the-example-application-integration-tests_cache">4.7.7. Running the Cache example application integration tests</h4>
<div class="paragraph">
<p>This example application includes a self-contained set of integration tests.
When run inside an OpenShift project, the tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploy a test instance of the application to the project.</p>
</li>
<li>
<p>Execute the individual tests on that instance.</p>
</li>
<li>
<p>Remove all instances of the application from the project when the testing is done.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Executing integration tests removes all existing instances of the example application from the target OpenShift project.
To avoid accidentally removing your example application, ensure that you create and select a separate OpenShift project to execute the tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>oc</code> client authenticated</p>
</li>
<li>
<p>An empty OpenShift project</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Execute the following command to run the integration tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean verify -Popenshift,openshift-it</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="caching-resources_cache">4.7.8. Caching resources</h4>
<div class="paragraph">
<p>More background and related information on caching can be found here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/docs/vertx-runtime.html#example-cache-vertx">Cache for Eclipse Vert.x</a></p>
</li>
<li>
<p><a href="/docs/thorntail-runtime.html#example-cache-wf-swarm">Cache for Thorntail</a></p>
</li>
<li>
<p><a href="/docs/nodejs-runtime.html#example-cache-nodejs">Cache for Node.js</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-a-basic-springboot-application_spring-boot">5. Developing and deploying a Spring Boot runtime application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to <a href="#example-rest-http-spring-boot">using an example</a>, you can create new Spring Boot applications from scratch and deploy them to OpenShift.</p>
</div>
<div class="paragraph">
<p>The recommended approach for specifying and using supported and tested Maven artifacts in a Spring Boot application is to use the OpenShift Application Runtimes Spring Boot BOM.</p>
</div>
<div class="sect2">
<h3 id="developing-runtime-application_spring-boot">5.1. Developing Spring Boot application</h3>
<div class="paragraph">
<p>For a basic Spring Boot application, you need to create the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Java class containing Spring Boot methods.</p>
</li>
<li>
<p>A <code>pom.xml</code> file containing information required by Maven to build the application.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following procedure creates a simple <code>Greeting</code> application that returns "{"content":"Greetings!"}" as response.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For building and deploying your applications to OpenShift, Spring Boot 2.1.x only supports builder images based on OpenJDK 8 and OpenJDK 11.
Oracle JDK and OpenJDK 9 builder images are not supported.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Maven installed.</p>
</li>
<li>
<p>OpenJDK 8 or OpenJDK 11 installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a new directory <code>myApp</code>, and navigate to it.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mkdir myApp
$ cd myApp</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the root directory for the application.</p>
</div>
</li>
<li>
<p>Create directory structure <code>src/main/java/com/example/</code> in the root directory, and navigate to it.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mkdir -p src/main/java/com/example/
$ cd src/main/java/com/example/</code></pre>
</div>
</div>
</li>
<li>
<p>Create a Java class file <code>MyApp.java</code> containing the application code.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-java hljs" data-lang="java">package com.example;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.RestController;

@SpringBootApplication
@RestController
public class MyApp {

    public static void main(String[] args) {
        SpringApplication.run(MyApp.class, args);
    }

    @RequestMapping("/")
    @ResponseBody
    public Message displayMessage() {
        return new Message();
    }

    static class Message {
        private String content = "Greetings!";

        public String getContent() {
            return content;
        }

        public void setContent(String content) {
            this.content = content;
        }
    }
}</code></pre>
</div>
</div>
</li>
<li>
<p>Create a <code>pom.xml</code> file in the application root directory <code>myApp</code> with the following content:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;groupId&gt;com.example&lt;/groupId&gt;
  &lt;artifactId&gt;my-app&lt;/artifactId&gt;
  &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;

  &lt;name&gt;MyApp&lt;/name&gt;
  &lt;description&gt;My Application&lt;/description&gt;

  &lt;!-- Specify the JDK builder image used to build your application. --&gt;
  &lt;!-- Use OpenJDK 8 and OpenJDK 11-based images. OracleJDK-based images are not supported. --&gt;
  &lt;properties&gt;
    &lt;fabric8.generator.from&gt;registry.access.redhat.com/redhat-openjdk-18/openjdk18-openshift:latest&lt;/fabric8.generator.from&gt;
  &lt;/properties&gt;

  &lt;!-- Import dependencies from the RHOAR Spring Boot BOM. --&gt;
  &lt;dependencyManagement&gt;
    &lt;dependencies&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;me.snowdrop&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-bom&lt;/artifactId&gt;
        &lt;version&gt;2.1.3.Final-redhat-00001&lt;/version&gt;
        &lt;type&gt;pom&lt;/type&gt;
        &lt;scope&gt;import&lt;/scope&gt;
      &lt;/dependency&gt;
    &lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;

  &lt;dependencies&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
      &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.1.3.RELEASE&lt;/version&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;

  &lt;!-- Specify the repositories containing RHOAR artifacts --&gt;
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;redhat-ga&lt;/id&gt;
      &lt;name&gt;Red Hat GA Repository&lt;/name&gt;
      &lt;url&gt;https://maven.repository.redhat.com/ga/&lt;/url&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;

  &lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
      &lt;id&gt;redhat-ga&lt;/id&gt;
      &lt;name&gt;Red Hat GA Repository&lt;/name&gt;
      &lt;url&gt;https://maven.repository.redhat.com/ga/&lt;/url&gt;
    &lt;/pluginRepository&gt;
  &lt;/pluginRepositories&gt;

&lt;/project&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Build the application using Maven from the root directory of the application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn spring-boot:run</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the application is running.</p>
<div class="paragraph">
<p>Using <code>curl</code> or your browser, verify your application is running at <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://localhost:8080
{"content":"Greetings!"}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional information</div>
<ul>
<li>
<p>As a recommended practice, you can configure liveness and readiness probes to enable health monitoring for your application when running on OpenShift.
To learn how application health monitoring on OpenShift works, try the <a href="#example-health-check-spring-boot">Health Check example</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="deploying-runtime-application-to-openshift_spring-boot">5.2. Deploying Spring Boot application to OpenShift</h3>
<div class="paragraph">
<p>To deploy your Spring Boot application to OpenShift, configure the <code>pom.xml</code> file in your application and then deploy using the Fabric8 Maven plugin.</p>
</div>
<div class="sect3">
<h4 id="preparing-runtime-application-for-openshift-deplyoment_spring-boot">5.2.1. Preparing Spring Boot application for OpenShift deployment</h4>
<div class="paragraph">
<p>For deploying your Spring Boot application to OpenShift, it must contain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Launcher profile information in the application’s <code>pom.xml</code> file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the following procedure, a profile with Fabric8 Maven plugin is used for building and deploying the application to OpenShift.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Maven is installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following content to the <code>pom.xml</code> file in the application root directory:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">...

&lt;profiles&gt;
    &lt;profile&gt;
      &lt;id&gt;openshift&lt;/id&gt;
      &lt;build&gt;
        &lt;plugins&gt;
          &lt;plugin&gt;
            &lt;groupId&gt;io.fabric8&lt;/groupId&gt;
            &lt;artifactId&gt;fabric8-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;3.5.40&lt;/version&gt;
            &lt;executions&gt;
              &lt;execution&gt;
                &lt;goals&gt;
                  &lt;goal&gt;resource&lt;/goal&gt;
                  &lt;goal&gt;build&lt;/goal&gt;
                &lt;/goals&gt;
              &lt;/execution&gt;
            &lt;/executions&gt;
          &lt;/plugin&gt;
        &lt;/plugins&gt;
      &lt;/build&gt;
    &lt;/profile&gt;
&lt;/profiles&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="deploying-runtime-application-to-openshift-using-fabric8-maven-plugin_spring-boot">5.2.2. Deploying Spring Boot application to OpenShift using Fabric8 Maven plugin</h4>
<div class="paragraph">
<p>To deploy your Spring Boot application to OpenShift, you must perform the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log in to your OpenShift instance.</p>
</li>
<li>
<p>Deploy the application to the OpenShift instance.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><code>oc</code> CLI client installed.</p>
</li>
<li>
<p>Maven installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to your OpenShift instance with the <code>oc</code> client.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc login ...</code></pre>
</div>
</div>
</li>
<li>
<p>Create a new project in the OpenShift instance.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc new-project MY_PROJECT_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Deploy the application to OpenShift using Maven from the application’s root directory. The root directory of an application contains the <code>pom.xml</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command uses the Fabric8 Maven Plugin to launch the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">S2I process</a> on OpenShift and start the pod.</p>
</div>
</li>
<li>
<p>Verify the deployment.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Check the status of your application and ensure your pod is running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods -w
NAME                             READY     STATUS      RESTARTS   AGE
MY_APP_NAME-1-aaaaa               1/1       Running     0          58s
MY_APP_NAME-s2i-1-build           0/1       Completed   0          2m</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>MY_APP_NAME-1-aaaaa</code> pod should have a status of <code>Running</code> once it is fully deployed and started.</p>
</div>
<div class="paragraph">
<p>Your specific pod name will vary.</p>
</div>
</li>
<li>
<p>Determine the route for the pod.</p>
<div class="listingblock">
<div class="title">Example Route Information</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes
NAME                 HOST/PORT                                                     PATH      SERVICES        PORT      TERMINATION
MY_APP_NAME         MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME      MY_APP_NAME      8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>The route information of a pod gives you the base URL which you use to access it.</p>
</div>
<div class="paragraph">
<p>In this example, <code>http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME</code> is the base URL to access the application.</p>
</div>
</li>
<li>
<p>Verify that your application is running in OpenShift.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://MY_APP_NAME-MY_PROJECT_NAME.OPENSHIFT_HOSTNAME
{"content":"Greetings!"}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deploying-runtime-application-to-standalone-red-hat-enterprise-linux_spring-boot">5.3. Deploying Spring Boot application to standalone Red Hat Enterprise Linux</h3>
<div class="paragraph">
<p>To deploy your Spring Boot application to standalone Red&#160;Hat Enterprise Linux, configure the <code>pom.xml</code> file in the application, package it using Maven and deploy using the <code>java -jar</code> command.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>RHEL 7 or RHEL 8 installed.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="preparing-runtime-application-for-standalone-red-hat-enterprise-linux_spring-boot">5.3.1. Preparing Spring Boot application for standalone Red Hat Enterprise Linux deployment</h4>
<div class="paragraph">
<p>For deploying your Spring Boot application to standalone Red Hat Enterprise Linux, you must first package the application using Maven.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Maven installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the following content to the <code>pom.xml</code> file in the application&#8217;s root directory:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">  ...
  &lt;!-- Specify target artifact type for the repackage goal. --&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;${spring-boot.version}&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
              &lt;goals&gt;
               &lt;goal&gt;repackage&lt;/goal&gt;
             &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
  ...</code></pre>
</div>
</div>
</li>
<li>
<p>Package your application using Maven.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean package</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting JAR file is in the <code>target</code> directory.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="deploying-runtime-application-to-standalone-red-hat-enterprise-linux-using-jar_spring-boot">5.3.2. Deploying Spring Boot application to standalone Red Hat Enterprise Linux using jar</h4>
<div class="paragraph">
<p>To deploy your Spring Boot application to standalone Red&#160;Hat Enterprise Linux, use <code>java -jar</code> command.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>RHEL 7 or RHEL 8 installed.</p>
</li>
<li>
<p>OpenJDK 8 or OpenJDK 11 installed.</p>
</li>
<li>
<p>A JAR file with the application.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Deploy the JAR file with the application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ java -jar my-project-1.0.0.jar</code></pre>
</div>
</div>
</li>
<li>
<p>Verify the deployment.</p>
<div class="paragraph">
<p>Use <code>curl</code> or your browser to verify your application is running at <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://localhost:8080</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="developing-reactive-spring-boot-applications-webflux">6. Developing reactive Spring Boot applications using Spring Reactive and Webflux</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="creating-a-reactive-spring-boot-http-service-with-webflux">6.1. Creating a reactive Spring Boot HTTP service with WebFlux</h3>
<div class="paragraph">
<p>Create a basic reactive Hello World HTTP web service using Spring Boot and WebFlux.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Java JDK 8 or Java JDK 11 installed</p>
</li>
<li>
<p>Maven installed</p>
</li>
<li>
<p>A Maven-based application project configured <a href="/docs/spring-boot-runtime.html#configuring-your-application-to-use-spring-boot_spring-boot">configured to use Spring Boot</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add <code>vertx-spring-boot-starter</code> as a dependency in the <code>pom.xml</code> file of your project.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title"><code>pom.xml</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
...
  &lt;dependencies&gt;
  ...
    &lt;dependency&gt;
      &lt;groupId&gt;dev.snowdrop&lt;/groupId&gt;
      &lt;artifactId&gt;vertx-spring-boot-starter-http&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
  ...
  &lt;dependencies&gt;
...
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a main class for your application and define the router and handler methods.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title"><code>HttpSampleApplication.java</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-java hljs" data-lang="java">package dev.snowdrop.vertx.sample.http;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.ServerRequest;
import org.springframework.web.reactive.function.server.ServerResponse;
import reactor.core.publisher.Mono;

import static org.springframework.web.reactive.function.BodyInserters.fromObject;
import static org.springframework.web.reactive.function.server.RouterFunctions.route;
import static org.springframework.web.reactive.function.server.ServerResponse.ok;

@SpringBootApplication
public class HttpSampleApplication {

    public static void main(String[] args) {
        SpringApplication.run(HttpSampleApplication.class, args);
    }

    @Bean
    public RouterFunction&lt;ServerResponse&gt; helloRouter() {
        return route()
            .GET("/hello", this::helloHandler)
            .build();
    }

    private Mono&lt;ServerResponse&gt; helloHandler(ServerRequest request) {
        String name = request
            .queryParam("name")
            .orElse("World");
        String message = String.format("Hello, %s!", name);

        return ok()
            .body(fromObject(message));
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>OPTIONAL: Run and test your application locally</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ cd myApp</code></pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Package your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean package</code></pre>
</div>
</div>
</li>
<li>
<p>Start your application from the command line:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ java -jar target/vertx-spring-boot-sample-http-0.0.1-SNAPSHOT.jar</code></pre>
</div>
</div>
</li>
<li>
<p>In a new terminal window, issue an HTTP request on the <code>/hello</code> endpoint:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl localhost:8080/hello
Hello, World!</code></pre>
</div>
</div>
</li>
<li>
<p>Provide a custom name with your request to get a personalized response:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://localhost:8080/hello?name=John
Hello, John!</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Additional resources</div>
<p>You can <a href="/docs/spring-boot-runtime.html#deploying-runtime-application-to-openshift_spring-boot">deploy your application to an OpenShift cluster</a> using Fabric8 Maven Plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="creating-an-authenticated-reactive-spring-boot-http-service-with-webflux">6.2. Creating an authenticated reactive Spring Boot HTTP service with WebFlux</h3>
<div class="paragraph">
<p>Create a reactive Hello World HTTP web service with basic form-based authentication using Spring Security and WebFlux.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Java JDK 8 or Java JDK 11 installed</p>
</li>
<li>
<p>Maven installed</p>
</li>
<li>
<p>A Maven-based application project configured <a href="/docs/spring-boot-runtime.html#configuring-your-application-to-use-spring-boot_spring-boot">configured to use Spring Boot</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add <code>vertx-spring-boot-starter</code> and <code>spring-boot-starter-security</code> as dependencies in the <code>pom.xml</code> file of your project.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title"><code>pom.xml</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
...
  &lt;dependencies&gt;
  ...
    &lt;dependency&gt;
      &lt;groupId&gt;dev.snowdrop&lt;/groupId&gt;
      &lt;artifactId&gt;vertx-spring-boot-starter-http&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
    &lt;/dependency&gt;
  ...
  &lt;dependencies&gt;
...
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an endpoint controller class for your application:</p>
<div class="listingblock">
<div class="title"><code>HelloController.java</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-java hljs" data-lang="java">package dev.snowdrop.vertx.sample.http.security;

import java.security.Principal;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import reactor.core.publisher.Mono;

@RestController
public class HelloController {

    @GetMapping("/")
    public Mono&lt;String&gt; hello(Mono&lt;Principal&gt; principal) {
        return principal
            .map(Principal::getName)
            .map(this::helloMessage);
    }

    private String helloMessage(String username) {
        return "Hello, " + username + "!";
    }
}</code></pre>
</div>
</div>
</li>
<li>
<p>Create the main class of your application:</p>
<div class="listingblock">
<div class="title"><code>HttpSecuritySampleApplication.java</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-java hljs" data-lang="java">package dev.snowdrop.vertx.sample.http.security;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class HttpSecuritySampleApplication {

    public static void main(String[] args) {
        SpringApplication.run(HttpSecuritySampleApplication.class, args);
    }
}</code></pre>
</div>
</div>
</li>
<li>
<p>Create a <code>SecurityConfiguration</code> class that stores the user credentials for accessing the <code>/hello</code> endpoint.</p>
<div class="listingblock">
<div class="title"><code>SecurityConfiguration.java</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-java hljs" data-lang="java">package dev.snowdrop.vertx.sample.http.security;

import org.springframework.context.annotation.Bean;
import org.springframework.security.config.annotation.web.reactive.EnableWebFluxSecurity;
import org.springframework.security.core.userdetails.MapReactiveUserDetailsService;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;

@EnableWebFluxSecurity
public class SecurityConfiguration {

    @Bean
    public MapReactiveUserDetailsService userDetailsService() {
        UserDetails user = User.withDefaultPasswordEncoder()
            .username("user")
            .password("user")
            .roles("USER")
            .build();

        return new MapReactiveUserDetailsService(user);
    }
}</code></pre>
</div>
</div>
</li>
<li>
<p>OPTIONAL: Run and test your application locally:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Navigate to the root directory of your Maven project:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ cd myApp</code></pre>
</div>
</div>
</li>
<li>
<p>Package your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean package</code></pre>
</div>
</div>
</li>
<li>
<p>Start your application from the command line:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ java -jar target/vertx-spring-boot-sample-http-0.0.1-SNAPSHOT.jar</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code> using a browser to access the login screen.</p>
</li>
<li>
<p>Log in using the credentials below:</p>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>username: user</p>
</li>
<li>
<p>password: user</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>You receive a customized greeting when you are logged in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Hello, user!</pre>
</div>
</div>
</li>
<li>
<p>Navigate to <code><a href="http://localhost:8080/logout" class="bare">http://localhost:8080/logout</a></code> using and use the <em>Log out</em> button to log out of your application.</p>
</li>
<li>
<p>Alternatively, use a terminal to make an unauthenticated HTTP request on <code>localhost:8080</code>.
You receive HTTP <code>401 Unauthorized</code> response from your application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code>$ curl -I http://localhost:8080
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Basic realm="Realm"
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Pragma: no-cache
Expires: 0
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1 ; mode=block
Referrer-Policy: no-referrer</code></pre>
</div>
</div>
</li>
<li>
<p>Issue an authenticated request using the example user credentials.
You receive a personalized response.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code>$ curl -u user:user http:++//localhost:8080++
Hello, user!</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Additional resources</div>
<p>You can <a href="/docs/spring-boot-runtime.html#deploying-runtime-application-to-openshift_spring-boot">deploy your application to an OpenShift cluster</a> using Fabric8 Maven Plugin.</p>
</div>
<div class="paragraph">
<p>You can also configure your application for link:Spring Boot 2.1.x Runtime Guide[deployment on standalone Red&#160;Hat Enterprise Linux].</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_debugging">7. Debugging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This sections contains information about debugging your Spring Boot&#x2013;based application both in local and remote deployments.</p>
</div>
<div class="sect2">
<h3 id="_remote_debugging">7.1. Remote debugging</h3>
<div class="paragraph">
<p>To remotely debug an application, you must first configure it to start in a debugging mode, and then attach a debugger to it.</p>
</div>
<div class="sect3">
<h4 id="starting-your-springboot-application-locally-in-debugging-mode_spring-boot">7.1.1. Starting your Spring Boot application locally in debugging mode</h4>
<div class="paragraph">
<p>One of the ways of debugging a Maven-based project is manually launching the application while specifying a debugging port, and subsequently connecting a remote debugger to that port.
This method is applicable at least when launching the application manually using the <code>mvn spring-boot:run</code> goal.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A Maven-based application</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a console, navigate to the directory with your application.</p>
</li>
<li>
<p>Launch your application and specify the necessary JVM arguments and the debug port using the following syntax:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn spring-boot:run -Drun.jvmArguments="-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=$PORT_NUMBER"</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>$PORT_NUMBER</code> is an unused port number of your choice.
Remember this number for the remote debugger configuration.</p>
</div>
<div class="paragraph">
<p>If you want the JVM to pause and wait for remote debugger connection before it starts the application, change <code>suspend</code> to <code>y</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="starting-an-uberjar-in-debugging-mode_spring-boot">7.1.2. Starting an uberjar in debugging mode</h4>
<div class="paragraph">
<p>If you chose to package your application as a Spring Boot uberjar, debug it by executing it with the following parameters.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An uberjar with your application</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In a console, navigate to the directory with the uberjar.</p>
</li>
<li>
<p>Execute the uberjar with the following parameters.
Ensure that all the parameters are specified before the name of the uberjar on the line.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=$PORT_NUMBER -jar $UBERJAR_FILENAME</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>$PORT_NUMBER</code> is an unused port number of your choice.
Remember this number for the remote debugger configuration.</p>
</div>
<div class="paragraph">
<p>If you want the JVM to pause and wait for remote debugger connection before it starts the application, change <code>suspend</code> to <code>y</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="starting-your-application-on-openshift-in-debugging-mode_spring-boot">7.1.3. Starting your application on OpenShift in debugging mode</h4>
<div class="paragraph">
<p>To debug your Spring Boot-based application on OpenShift remotely, you must set the <code>JAVA_DEBUG</code> environment variable inside the container to <code>true</code> and configure port forwarding so that you can connect to your application from a remote debugger.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your application running on OpenShift.</p>
</li>
<li>
<p>The <code>oc</code> binary installed on your machine.</p>
</li>
<li>
<p>The ability to execute the <code>oc port-forward</code> command in your target OpenShift environment.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Using the <code>oc</code> command, list the available deployment configurations:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ oc get dc</code></pre>
</div>
</div>
</li>
<li>
<p>Set the <code>JAVA_DEBUG</code> environment variable in the deployment configuration of your application to <code>true</code>, which configures the JVM to open the port number <code>5005</code> for debugging.
For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ oc set env dc/MY_APP_NAME JAVA_DEBUG=true</code></pre>
</div>
</div>
</li>
<li>
<p>Redeploy the application if it is not set to redeploy automatically on configuration change. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ oc rollout latest dc/MY_APP_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Configure port forwarding from your local machine to the application pod:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>List the currently running pods and find one containing your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pod
NAME                            READY     STATUS      RESTARTS   AGE
MY_APP_NAME-3-1xrsp          0/1       Running     0          6s
...</code></pre>
</div>
</div>
</li>
<li>
<p>Configure port forwarding:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc port-forward MY_APP_NAME-3-1xrsp $LOCAL_PORT_NUMBER:5005</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, <code>$LOCAL_PORT_NUMBER</code> is an unused port number of your choice on your local machine.
Remember this number for the remote debugger configuration.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>When you are done debugging, unset the <code>JAVA_DEBUG</code> environment variable in your application pod. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ oc set env dc/MY_APP_NAME JAVA_DEBUG-</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Additional resources</div>
<p>You can also set the <code>JAVA_DEBUG_PORT</code> environment variable if you want to change the debug port from the default, which is <code>5005</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="attaching-a-remote-debugger-to-the-application_spring-boot">7.1.4. Attaching a remote debugger to the application</h4>
<div class="paragraph">
<p>When your application is configured for debugging, attach a remote debugger of your choice to it.
In this guide, <a href="https://www.redhat.com/en/technologies/jboss-middleware/developer-studio">Red Hat CodeReady Studio</a> is covered, but the procedure is similar when using other programs.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The application running either locally or on OpenShift, and configured for debugging.</p>
</li>
<li>
<p>The port number that your application is listening on for debugging.</p>
</li>
<li>
<p>Red Hat CodeReady Studio installed on your machine. You can download it from the <a href="https://developers.redhat.com/products/devstudio/download/">Red Hat CodeReady Studio download page</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Start Red Hat CodeReady Studio.</p>
</li>
<li>
<p>Create a new debug configuration for your application:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <strong>Run&#8594;Debug Configurations</strong>.</p>
</li>
<li>
<p>In the list of configurations, double-click <strong>Remote Java application.</strong>
This creates a new remote debugging configuration.</p>
</li>
<li>
<p>Enter a suitable name for the configuration in the <strong>Name</strong> field.</p>
</li>
<li>
<p>Enter the path to the directory with your application into the <strong>Project</strong> field. You can use the <strong>Browse&#8230;&#8203;</strong> button for convenience.</p>
</li>
<li>
<p>Set the <strong>Connection Type</strong> field to <em>Standard (Socket Attach)</em> if it is not already.</p>
</li>
<li>
<p>Set the <strong>Port</strong> field to the port number that your application is listening on for debugging.</p>
</li>
<li>
<p>Click <strong>Apply.</strong></p>
</li>
</ol>
</div>
</li>
<li>
<p>Start debugging by clicking the <strong>Debug</strong> button in the Debug Configurations window.</p>
<div class="paragraph">
<p>To quickly launch your debug configuration after the first time, click <strong>Run&#8594;Debug History</strong> and select the configuration from the list.</p>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://access.redhat.com/articles/1290703">Debug an OpenShift Java Application with JBoss Developer Studio</a> on Red Hat Knowledgebase.</p>
<div class="paragraph">
<p>Red Hat CodeReady Studio was previously called JBoss Developer Studio.</p>
</div>
</li>
<li>
<p>A <a href="https://blog.openshift.com/debugging-java-applications-on-openshift-kubernetes/">Debugging Java Applications On OpenShift and Kubernetes</a> article on OpenShift Blog.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debug_logging">7.2. Debug logging</h3>
<div class="sect3">
<h4 id="add-springboot-debug-logging_spring-boot">7.2.1. Add Spring Boot debug logging</h4>
<div class="paragraph">
<p>Add debug logging to your application.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An application you want to debug. For example, the <a href="#example-rest-http-spring-boot">REST API Level 0 example</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Declare a <code>org.apache.commons.logging.Log</code> object using the <code>org.apache.commons.logging.LogFactory</code> for the class you want to add logging.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-java hljs" data-lang="java">import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
...
private static Log logger = LogFactory.getLog(TheClass.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, if you wanted to add logging to the <code>GreetingEndpoint</code> class in the <a href="#example-rest-http-spring-boot">REST API Level 0 example</a>, you would use <code>GreetingEndpoint.class</code>.</p>
</div>
</li>
<li>
<p>Add debugging statements using <code>logger.debug("my logging message")</code>.</p>
<div class="listingblock">
<div class="title">Example logging statement</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-java hljs" data-lang="java">@GET
@Path("/greeting")
@Produces("application/json")
public Greeting greeting(@QueryParam("name") @DefaultValue("World") String name) {
    String message = String.format(properties.getMessage(), name);

    logger.debug("Message: " + message);

    return new Greeting(message);
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add a <code>logging.level.fully.qualified.name.of.TheClass=DEBUG</code> in <code>src/main/resources/application.properties</code>.</p>
<div class="paragraph">
<p>For example, if you added a logging statement to <code>io.openshift.booster.service.GreetingEndpoint</code> you would use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-properties hljs" data-lang="properties">logging.level.io.openshift.booster.service.GreetingEndpoint=DEBUG</code></pre>
</div>
</div>
<div class="paragraph">
<p>This enables log messages at the <code>DEBUG</code> level and above to be shown in the logs for your class.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="accessing-springboot-debug-logs-on-localhost_spring-boot">7.2.2. Accessing Spring Boot debug logs on localhost</h4>
<div class="paragraph">
<p>Start your application and interact with it to see the debugging statements.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An application with debug logging enabled.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Start your application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn spring-boot:run</code></pre>
</div>
</div>
</li>
<li>
<p>Test your application to invoke debug logging.</p>
<div class="paragraph">
<p>For example, to test the <a href="#example-rest-http-spring-boot">REST API Level 0 example</a>, you can invoke the <code>/api/greeting</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://localhost:8080/api/greeting?name=Sarah</code></pre>
</div>
</div>
</li>
<li>
<p>View your application logs to see your debug messages.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">i.o.booster.service.GreetingEndpoint     : Message: Hello, Sarah!</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To disable debug logging, remove <code>logging.level.fully.qualified.name.of.TheClass=DEBUG</code> from <code>src/main/resources/application.properties</code> and restart your application.</p>
</div>
</div>
<div class="sect3">
<h4 id="accessing-debug-logs-on-openshift_spring-boot">7.2.3. Accessing debug logs on OpenShift</h4>
<div class="paragraph">
<p>Start your application and interact with it to see the debugging statements in OpenShift.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A Maven-based application with debug logging enabled.</p>
</li>
<li>
<p>The <code>oc</code> CLI client installed and authenticated.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Deploy your application to OpenShift:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
</li>
<li>
<p>View the logs:</p>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the name of the pod with your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get pods</code></pre>
</div>
</div>
</li>
<li>
<p>Start watching the log output:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc logs -f pod/MY_APP_NAME-2-aaaaa</code></pre>
</div>
</div>
<div class="paragraph">
<p>Keep the terminal window displaying the log output open so that you can watch the log output.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>Interact with your application:</p>
<div class="paragraph">
<p>For example, if you had debug logging in the <a href="#example-rest-http-spring-boot">REST API Level 0 example</a> to log the <code>message</code> variable in the <code>/api/greeting</code> method:</p>
</div>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the route of your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc get routes</code></pre>
</div>
</div>
</li>
<li>
<p>Make an HTTP request on the <code>/api/greeting</code> endpoint of your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl $APPLICATION_ROUTE/api/greeting?name=Sarah</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>Return to the window with your pod logs and inspect debug logging messages in the logs.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code>i.o.booster.service.GreetingEndpoint     : Message: Hello, Sarah!</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>To disable debug logging, remove <code>logging.level.fully.qualified.name.of.TheClass=DEBUG</code> from <code>src/main/resources/application.properties</code> and redeploy your application.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_your_application">8. Monitoring your application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section contains information about monitoring your Spring Boot&#x2013;based application running on OpenShift.</p>
</div>
<div class="sect2">
<h3 id="_accessing_jvm_metrics_for_your_application_on_openshift">8.1. Accessing JVM metrics for your application on OpenShift</h3>
<div class="sect3">
<h4 id="accessing-jvm-metrics-using-jolokia-on-openshift_spring-boot">8.1.1. Accessing JVM metrics using Jolokia on OpenShift</h4>
<div class="paragraph">
<p><a href="https://jolokia.org/documentation.html" target="_blank" rel="noopener">Jolokia</a> is a built-in lightweight solution for accessing JMX (Java Management Extension) metrics over HTTP on OpenShift.
Jolokia allows you to access CPU, storage, and memory usage data collected by JMX over an HTTP bridge.
Jolokia uses a REST interface and JSON-formatted message payloads.
It is suitable for monitoring cloud applications thanks to its comparably high speed and low resource requirements.</p>
</div>
<div class="paragraph">
<p>For Java-based applications, the OpenShift Web console provides the integrated <a href="https://docs.openshift.com/container-platform/3.6/architecture/infrastructure_components/web_console.html#jvm-console" target="_blank" rel="noopener"><em>hawt.io</em> console</a> that collects and displays all relevant metrics output by the JVM running your application.</p>
</div>
<div class="ulist">
<div class="title">Prerequistes</div>
<ul>
<li>
<p>the <code>oc</code> client authenticated</p>
</li>
<li>
<p>a Java-based application container running in a project on OpenShift</p>
</li>
<li>
<p>latest <a href="https://github.com/jboss-container-images/redhat-openjdk-18-openshift-image/blob/openjdk18-dev/image.yaml" target="_blank" rel="noopener">JDK 1.8.0 image</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>List the deployment configurations of the pods inside your project and select the one that corresponds to your application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc get dc</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>NAME         REVISION   DESIRED   CURRENT   TRIGGERED BY
MY_APP_NAME   2          1         1         config,image(my-app:6)
...</pre>
</div>
</div>
</li>
<li>
<p>Open the YAML deployment template of the pod running your application for editing.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc edit dc/MY_APP_NAME</code></pre>
</div>
</div>
</li>
<li>
<p>Add the following entry to the <code>ports</code> section of the template and save your changes:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">...
spec:
  ...
  ports:
  - containerPort: 8778
    name: jolokia
    protocol: TCP
  ...
...</code></pre>
</div>
</div>
</li>
<li>
<p>Redeploy the pod running your application.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc rollout latest dc/MY_APP_NAME</code></pre>
</div>
</div>
<div class="paragraph">
<p>The pod is redeployed with the updated deployment configuration and exposes the port <code>8778</code>.</p>
</div>
</li>
<li>
<p>Log into the OpenShift Web console.</p>
</li>
<li>
<p>In the sidebar, navigate to <em>Applications</em> &gt; <em>Pods</em>, and click on the name of the pod running your application.</p>
</li>
<li>
<p>In the pod details screen, click <em>Open Java Console</em> to access the hawt.io console.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="http://hawt.io/docs/index.html">hawt.io documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exposing-metrics-using-prometheus-with-spring-boot_spring-boot">8.2. Exposing application metrics using Prometheus with Spring Boot</h3>
<div class="paragraph">
<p>In this example, you:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure your application to expose metrics.</p>
</li>
<li>
<p>Collect and view the data using Prometheus.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Prometheus actively connects to a monitored application to collect data; the application does not actively send metrics to a server.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Prometheus configured to collect metrics from the application:</p>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download and extract the <a href="https://prometheus.io/download/" target="_blank" rel="noopener">archive</a> with the latest Prometheus release:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ wget https://github.com/prometheus/prometheus/releases/download/v2.4.3/prometheus-2.4.3.linux-amd64.tar.gz
$ tar -xvf  prometheus-2.4.3.linux-amd64.tar.gz</code></pre>
</div>
</div>
</li>
<li>
<p>Navigate to the directory with Prometheus:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ cd  prometheus-2.4.3.linux-amd64</code></pre>
</div>
</div>
</li>
<li>
<p>Append the following snippet to the <code>prometheus.yml</code> file to specify the port where your application exposes the metrics endpoint.</p>
<div class="paragraph">
<p>The <code>scrape_interval</code> setting is optional and sets Prometheus to collect metrics every 5 seconds.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-yaml hljs" data-lang="yaml">  - job_name: 'spring-actuator'
    metrics_path: '/prometheus'
    scrape_interval: 5s
    static_configs:
    - targets: ['localhost:8080']</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have the <code>spring-boot-starter-actuator</code> dependency in your <code>pom.xml</code> file, Spring Boot-based applications expose metrics at the <code>/prometheus</code> endpoint by default.
You can change the endpoint at which your application exposes the metrics by setting the <code>endpoints.prometheus.id</code> property to a different path, for example: <code>endpoints.prometheus.id=micrometheus</code>.</p>
</div>
<div class="paragraph">
<p>The endpoint is secured by default.
To ensure that metrics collection works in your application, you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>include authentication in your Prometheus metrics collection endpoint, or</p>
</li>
<li>
<p>make the endpoint unsecured by setting a property, such as <code>management.security.enabled=false</code>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p>The Prometheus server started on <code>localhost</code>:</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Start Prometheus and wait until the <code>Server is ready to receive web requests</code> message is displayed in the console.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ ./prometheus</code></pre>
</div>
</div>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Include the <code>spring-boot-starter-actuator</code> and <code>micrometer-registry-prometheus</code> dependencies in your <code>pom.xml</code>.</p>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
  ...
  &lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;
    &lt;artifactId&gt;micrometer-registry-prometheus&lt;/artifactId&gt;
    &lt;version&gt;1.1.0&lt;/version&gt;
  &lt;/dependency&gt;
  ...
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Collect metrics from your application:</p>
<div class="ulist">
<ul>
<li>
<p>By default, <code>spring-boot-starter-actuator</code> automatically records a <code>Timer</code> metric on each endpoint exposed your application.
The default name for the <code>Timer</code> metric is set to <code>http.server.requests</code>.
You can set a custom name for the metric:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-properties hljs" data-lang="properties">management.metrics.web.server.requests-metric-name=custom.timer.metric.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name is <code>http.server.requests</code> by default.</p>
</div>
<div class="paragraph">
<p>The <code>Timer</code> metric contains a set of dimensions recorded for every request.
By default, these dimensions are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>method</code></dt>
<dd>
<p>The HTTP method for calling the endpoint, for example, <code>GET</code> or <code>PUT</code>.</p>
</dd>
<dt class="hdlist1"><code>status</code></dt>
<dd>
<p>The numeric HTTP status code returned in response to the request, for example, <code>200</code>, <code>201</code>, <code>500</code>.</p>
</dd>
<dt class="hdlist1"><code>uri</code></dt>
<dd>
<p>The URI template before the variable substitution, for example, <code>/api/person/{id}</code>.</p>
</dd>
<dt class="hdlist1"><code>exception</code></dt>
<dd>
<p>If an exception is thrown by your application upon receiving a request, this dimension records the simple name of the exception class.</p>
</dd>
</dl>
</div>
</div>
</div>
</li>
<li>
<p>Alternatively, only record the <code>Timer</code> metric for specific endpoints:</p>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Disable the <code>auto-time-requests</code> property in the <code>spring-boot-starter-actuator</code> configuration for your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-properties hljs" data-lang="properties">management.metrics.web.server.auto-time-requests=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>The property is set to <code>true</code> by default.</p>
</div>
</li>
<li>
<p>Annotate methods or classes with the <code>@io.micrometer.core.annotation.Timed</code> annotation, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-java hljs" data-lang="java">@RestController
public class GreetingController {

    @RequestMapping("/greeting")
    @Timed
    public String get() {
        return "Hello from a timed endpoint";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Timed</code> annotation is used to keep track of the time it takes to invoke the metered endpoint.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Launch your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ mvn spring-boot:run</code></pre>
</div>
</div>
</li>
<li>
<p>Invoke the traced endpoint several times:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ curl http://localhost:8080/greeting
Hello from a timed endpoint</code></pre>
</div>
</div>
</li>
<li>
<p>Wait at least 15 seconds for the collection to happen, and see the metrics in Prometheus UI:</p>
<div class="openblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the Prometheus UI at <a href="http://localhost:9090/" target="_blank" rel="noopener">http://localhost:9090/</a> and type <code>requests</code> into the <em>Expression</em> box.</p>
</li>
<li>
<p>From the suggestions, select for example <code>http.server.requests</code> and click <em>Execute</em>.</p>
</li>
<li>
<p>In the table that is displayed, you can see how long it takes to invoke the metered endpoint.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that all metrics you created are prefixed with <code>application:</code>.
There are other metrics, automatically exposed by Spring Boot.
Those metrics are prefixed with <code>base:</code> and <code>vendor:</code> and expose information about the JVM in which the application runs.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For additional information on using Micrometer metrics with Spring Boot, see the <a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#production-ready-metrics" target="_blank" rel="noopener">Micrometer reference documentation for Spring 2.1.x</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-source-to-image-s2i-build-process">Appendix A: The Source-to-Image (S2I) build process</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">Source-to-Image</a> (S2I) is a build tool for generating reproducible Docker-formatted container images from online SCM repositories with application sources.
With S2I builds, you can easily deliver the latest version of your application into production with shorter build times, decreased resource and network usage, improved security, and a number of other advantages.
OpenShift supports multiple <a href="https://docs.openshift.com/container-platform/latest/dev_guide/builds/index.html">build strategies and input sources</a>.</p>
</div>
<div class="paragraph">
<p>For more information, see the <a href="https://docs.openshift.com/container-platform/latest/architecture/core_concepts/builds_and_image_streams.html#source-build">Source-to-Image (S2I) Build</a> chapter of the OpenShift Container Platform documentation.</p>
</div>
<div class="paragraph">
<p>You must provide three elements to the S2I process to assemble the final container image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The application sources hosted in an online SCM repository, such as GitHub.</p>
</li>
<li>
<p>The S2I Builder image, which serves as the foundation for the assembled image and provides the ecosystem in which your application is running.</p>
</li>
<li>
<p>Optionally, you can also provide environment variables and parameters that are used by <a href="https://docs.openshift.com/container-platform/latest/creating_images/s2i.html">S2I scripts</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The process injects your application source and dependencies into the Builder image according to instructions specified in the S2I script, and generates a Docker-formatted container image that runs the assembled application.
For more information, check the <a href="https://docs.openshift.com/container-platform/latest/creating_images/s2i.html">S2I build requirements</a>, <a href="https://docs.openshift.com/container-platform/latest/dev_guide/builds/build_strategies.html#source-to-image-strategy-options">build options</a>
and <a href="https://docs.openshift.com/container-platform/3.6/dev_guide/builds/index.html">how builds work</a> sections of the OpenShift Container Platform documentation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-the-deployment-configuration-of-an-example-application_spring-boot">Appendix B: Updating the deployment configuration of an example application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The deployment configuration for an example application contains information related to deploying and running the application in OpenShift, such as route information or readiness probe location.
The deployment configuration of an example application is stored in a set of YAML files.
For examples that use the Fabric8 Maven Plugin, the YAML files are located in the <code>src/main/fabric8/</code> directory. For examples using Nodeshift, the YAML files are located in the <code>.nodeshift</code> directory.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The deployment configuration files used by the Fabric8 Maven Plugin and Nodeshift do not have to be full OpenShift resource definitions.
Both Fabric8 Maven Plugin and Nodeshift can take the deployment configuration files and add some missing information to create a full OpenShift resource definition.
The resource definitions generated by the Fabric8 Maven Plugin are available in the <code>target/classes/META-INF/fabric8/</code> directory.
The resource definitions generated by Nodeshift are available in the <code>tmp/nodeshift/resource/</code> directory.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An existing example project.</p>
</li>
<li>
<p>The <code>oc</code> CLI client installed.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Edit an existing YAML file or create an additional YAML file with your configuration update.</p>
<div class="ulist">
<ul>
<li>
<p>For example, if your example already has a YAML file with a <code>readinessProbe</code> configured, you could change the <code>path</code> value to a different available path to check for readiness:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-yaml hljs" data-lang="yaml">spec:
  template:
    spec:
      containers:
        readinessProbe:
          httpGet:
            path: /path/to/probe
            port: 8080
            scheme: HTTP
...</code></pre>
</div>
</div>
</li>
<li>
<p>If a <code>readinessProbe</code> is not configured in an existing YAML file, you can also create a new YAML file in the same directory with the <code>readinessProbe</code> configuration.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Deploy the updated version of your example using Maven or npm.</p>
</li>
<li>
<p>Verify that your configuration updates show in the deployed version of your example.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">$ oc export all --as-template='my-template'

apiVersion: v1
kind: Template
metadata:
  creationTimestamp: null
  name: my-template
objects:
- apiVersion: v1
  kind: DeploymentConfig
  ...
  spec:
    ...
    template:
      ...
      spec:
        containers:
          ...
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /path/to/different/probe
              port: 8080
              scheme: HTTP
            initialDelaySeconds: 60
            periodSeconds: 30
            successThreshold: 1
            timeoutSeconds: 1
          ...</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Additional resources</div>
<p>If you updated the configuration of your application directly using the web-based console or the <code>oc</code> CLI client, export and add these changes to your YAML file.
Use the <code>oc export all</code> command to show the configuration of your deployed application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-a-jenkins-freestyle-project-to-deploy-your-application-with-the-fabric8-maven-plugin_spring-boot">Appendix C: Configuring a Jenkins freestyle project to deploy your application with the Fabric8 Maven Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Similar to using Maven and the Fabric8 Maven Plugin from your local host to deploy an application, you can configure Jenkins to use Maven and the Fabric8 Maven Plugin to deploy an application.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Access to an OpenShift cluster.</p>
</li>
<li>
<p><a href="https://docs.openshift.org/latest/using_images/other_images/jenkins.html">The Jenkins container image</a> running on same OpenShift cluster.</p>
</li>
<li>
<p>A JDK and Maven installed and configured on your Jenkins server.</p>
</li>
<li>
<p>An application configured to use Maven, the Fabric8 Maven Plugin, and the Red Hat base image in the <code>pom.xml</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For building and deploying your applications to OpenShift, Spring Boot 2.1.x only supports builder images based on OpenJDK 8 and OpenJDK 11.
Oracle JDK and OpenJDK 9 builder images are not supported.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example <code>pom.xml</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;properties&gt;
  ...
  &lt;fabric8.generator.from&gt;registry.access.redhat.com/redhat-openjdk-18/openjdk18-openshift:latest&lt;/fabric8.generator.from&gt;
&lt;/properties&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>The source of the application available in GitHub.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a new OpenShift project for your application:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the OpenShift Web console and log in.</p>
</li>
<li>
<p>Click <em>Create Project</em> to create a new OpenShift project.</p>
</li>
<li>
<p>Enter the project information and click <em>Create</em>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Ensure Jenkins has access to that project.</p>
<div class="paragraph">
<p>For example, if you configured a service account for Jenkins, ensure that account has <code>edit</code> access to the project of your application.</p>
</div>
</li>
<li>
<p>Create a new <a href="https://wiki.jenkins.io/display/JENKINS/Building+a+software+project#Buildingasoftwareproject-Settinguptheproject">freestyle Jenkins project</a> on your Jenkins server:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <em>New Item</em>.</p>
</li>
<li>
<p>Enter a name, choose <em>Freestyle project</em>, and click <em>OK</em>.</p>
</li>
<li>
<p>Under <em>Source Code Management</em>, choose <em>Git</em> and add the GitHub url of your application.</p>
</li>
<li>
<p>Under <em>Build</em>, choose <em>Add build step</em> and select <code>Invoke top-level Maven targets</code>.</p>
</li>
<li>
<p>Add the following to <em>Goals</em>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">clean fabric8:deploy -Popenshift -Dfabric8.namespace=MY_PROJECT</code></pre>
</div>
</div>
<div class="paragraph">
<p>Substitute <code>MY_PROJECT</code> with the name of the OpenShift project for your application.</p>
</div>
</li>
<li>
<p>Click <em>Save</em>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <em>Build Now</em> from the main page of the Jenkins project to verify your application builds and deploys to the OpenShift project for your application.</p>
<div class="paragraph">
<p>You can also verify that your application is deployed by opening the route in the OpenShift project of the application.</p>
</div>
</li>
</ol>
</div>
<h3 id="_next_steps" class="discrete">Next steps</h3>
<div class="ulist">
<ul>
<li>
<p>Consider adding <a href="https://wiki.jenkins.io/display/JENKINS/Github+Plugin#GitHubPlugin-GitHubhooktriggerforGITScmpolling">GITSCM polling</a> or using <a href="https://wiki.jenkins.io/display/JENKINS/Building+a+software+project#Buildingasoftwareproject-Buildsbysourcechanges">the <code>Poll SCM</code> build trigger</a>. These options enable builds to run every time a new commit is pushed to the GitHub repository.</p>
</li>
<li>
<p>Consider adding a build step that executes tests before deploying.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-a-springboot-application-using-war-files_spring-boot">Appendix D: Deploying a Spring Boot application using WAR files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As an alternative to the supported application packaging and deployment workflow using fat JAR files, you can package and deploy a Spring Boot application as a WAR (Web Application Archive) file.
You must configure your build and deployment settings to ensure that your application builds and deploys correctly on OpenShift.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A Spring Boot application, such as <a href="#spring-boot-available-examples">an example</a>.</p>
</li>
<li>
<p>Fabric8 Maven Plugin used to deploy your application to OpenShift.</p>
</li>
<li>
<p>Spring Boot Maven Plugin used to package your application.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add <code>war</code> packaging to the <code>pom.xml</code> file of your project:</p>
<div class="listingblock">
<div class="title">Example <code>pom.xml</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;project ...&gt;
  ...
  &lt;packaging&gt;war&lt;/packaging&gt;
  ...
&lt;/project&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Specify <code>spring-boot-starter-tomcat</code> as a dependency of your application:</p>
<div class="listingblock">
<div class="title">Example <code>pom.xml</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;project ...&gt;
  ...
  &lt;dependencies&gt;
    ...
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
    &lt;/dependency&gt;
    ...
  &lt;/dependencies&gt;
  ...
&lt;/project&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Ensure the <code>repackage</code> Maven goal for the Spring Boot Maven plugin is defined in the <code>pom.xml</code> file:</p>
<div class="listingblock">
<div class="title">Example <code>pom.xml</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;project ...&gt;
...
  &lt;build&gt;
    ...
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;repackage&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
...
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This ensures that the Spring Boot classes used to launch the application are included in the WAR file, and that the corresponding properties for these classes are defined in the <code>MANIFEST.mf</code> file of the WAR file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Main-Class: org.springframework.boot.loader.WarLauncher</code></p>
</li>
<li>
<p><code>Spring-Boot-Classes: WEB-INF/classes/</code></p>
</li>
<li>
<p><code>Spring-Boot-Lib: WEB-INF/lib/</code></p>
</li>
<li>
<p><code>Spring-Boot-Version: 2.1.3.RELEASE</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Add the <code>ARTIFACT_COPY_ARGS</code> environment variable to the <code>pom.xml</code> file.</p>
<div class="paragraph">
<p>The Fabric8 Maven Plugin consumes this variable during the build process and ensures that the <em>Build and Deploy</em> tool uses the WAR file (rather than the default fat JAR file) to create the application container image:</p>
</div>
<div class="listingblock">
<div class="title">Example <code>pom.xml</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">    ...
    &lt;profile&gt;
      &lt;id&gt;openshift&lt;/id&gt;
      &lt;build&gt;
        &lt;plugins&gt;
          &lt;plugin&gt;
            &lt;groupId&gt;io.fabric8&lt;/groupId&gt;
            &lt;artifactId&gt;fabric8-maven-plugin&lt;/artifactId&gt;
            &lt;executions&gt;
              ...
            &lt;/executions&gt;
            &lt;configuration&gt;
                &lt;images&gt;
                    &lt;image&gt;
                        &lt;name&gt;${project.artifactId}:%t&lt;/name&gt;
                        &lt;alias&gt;${project.artifactId}&lt;/alias&gt;
                        &lt;build&gt;
                            &lt;from&gt;registry.access.redhat.com/redhat-openjdk-18/openjdk18-openshift:${openjdk18-openshift.version}&lt;/from&gt;
                            &lt;assembly&gt;
                                &lt;basedir&gt;/deployments&lt;/basedir&gt;
                                &lt;descriptorRef&gt;artifact&lt;/descriptorRef&gt;
                            &lt;/assembly&gt;
                            &lt;env&gt;
                                &lt;ARTIFACT_COPY_ARGS&gt;*.war&lt;/ARTIFACT_COPY_ARGS&gt;
                                &lt;JAVA_APP_DIR&gt;/deployments&lt;/JAVA_APP_DIR&gt;
                            &lt;/env&gt;
                            &lt;ports&gt;
                                &lt;port&gt;8080&lt;/port&gt;
                            &lt;/ports&gt;
                        &lt;/build&gt;
                    &lt;/image&gt;
                &lt;/images&gt;
            &lt;/configuration&gt;
          &lt;/plugin&gt;
        &lt;/plugins&gt;
      &lt;/build&gt;
    &lt;/profile&gt;
    ...</code></pre>
</div>
</div>
</li>
<li>
<p>Add the <code>JAVA_APP_JAR</code> environment variable to the <code>src/main/fabric8/deployment.yml</code> file.</p>
<div class="paragraph">
<p>This variable instructs the Fabric8 Maven Plugin to launch your application using the WAR file included with the container.
If <code>src/main/fabric8/deployment.yml</code> does not exist, you can create it.</p>
</div>
<div class="listingblock">
<div class="title">Example <code>deployment.yml</code></div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-yaml hljs" data-lang="yaml">spec:
  template:
    spec:
      containers:
        ...
          env:
          - name: JAVA_APP_JAR
            value: ${project.artifactId}-${project.version}.war</code></pre>
</div>
</div>
</li>
<li>
<p>Build and deploy your application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn clean fabric8:deploy -Popenshift</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="additional-springboot-resources_spring-boot">Appendix E: Additional Spring Boot resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.openshift.org/latest/architecture/">OpenShift Architecture Overview</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/reference_architectures/2017/html/spring_boot_microservices_on_red_hat_openshift_container_platform_3/">Spring Boot Microservices On Red Hat OpenShift Container Platform 3</a></p>
</li>
<li>
<p><a href="https://github.com/spring-cloud-incubator/spring-cloud-kubernetes/">Spring Cloud Kubernetes</a></p>
</li>
<li>
<p><a href="https://projects.spring.io/spring-boot/">Spring Boot Project</a></p>
</li>
<li>
<p><a href="https://projects.spring.io/spring-framework/">Spring Framework Project</a></p>
</li>
<li>
<p><a href="https://github.com/redhat-microservices/lab_springboot-openshift/">OpenShift Spring Boot Lab Microservices </a></p>
</li>
<li>
<p><a href="https://spring.fabric8.io/">Creating Spring Boot Applications using Fabric8</a></p>
</li>
<li>
<p><a href="https://github.com/fabric8io/fabric8-maven-plugin/">Fabric8 Maven Plugin</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="application-development-resources">Appendix F: Application development resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For additional information about application development with OpenShift, see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://learn.openshift.com/" target="_blank" rel="noopener">OpenShift Interactive Learning Portal</a></p>
</li>
<li>
<p><a href="https://developers.redhat.com/products/rhoar/overview/" target="_blank" rel="noopener">Red Hat OpenShift Application Runtimes Overview</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To reduce network load and shorten the build time of your application, set up a Nexus mirror for Maven on your Minishift or CDK:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.openshift.com/container-platform/3.11/dev_guide/dev_tutorials/maven_tutorial.html" target="_blank" rel="noopener">Setting Up a Nexus Mirror for Maven</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="proficiency-levels">Appendix G: Proficiency levels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each available example teaches concepts that require certain minimum knowledge. This requirement varies by example. The minimum requirements and concepts are organized in several levels of proficiency. In addition to the levels described here, you might need additional information specific to each example.</p>
</div>
<h3 id="proficiency_foundational" class="discrete">Foundational</h3>
<div class="paragraph">
<p>The examples rated at Foundational proficiency generally require no prior knowledge of the subject matter; they provide general awareness and demonstration of key elements, concepts, and terminology. There are no special requirements except those directly mentioned in the description of the example.</p>
</div>
<h3 id="proficiency_advanced" class="discrete">Advanced</h3>
<div class="paragraph">
<p>When using Advanced examples, the assumption is that you are familiar with the common concepts and terminology of the subject area of the example in addition to Kubernetes and OpenShift. You must also be able to perform basic tasks on your own, for example, configuring services and applications, or administering networks. If a service is needed by the example, but configuring it is not in the scope of the example, the assumption is that you have the knowledge to properly configure it, and only the resulting state of the service is described in the documentation.</p>
</div>
<h3 id="proficiency_expert" class="discrete">Expert</h3>
<div class="paragraph">
<p>Expert examples require the highest level of knowledge of the subject matter. You are expected to perform many tasks based on feature-based documentation and manuals, and the documentation is aimed at most complex scenarios.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="glossary">Appendix H: Glossary</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_product_and_project_names">H.1. Product and project names</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">developers.redhat.com/launch</dt>
<dd>
<p><a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> is a standalone getting started experience offered by Red Hat for jumpstarting cloud-native application development on OpenShift. It provides a way of creating functional example applications as well as an easy way to build and deploy these example applications on OpenShift.</p>
</dd>
<dt class="hdlist1">Fabric8 Launcher</dt>
<dd>
<p>The Fabric8 Launcher is the upstream project on which <a href="https://developers.redhat.com/launch">developers.redhat.com/launch</a> is based.</p>
</dd>
<dt class="hdlist1">Minishift or CDK</dt>
<dd>
<p>An OpenShift cluster running on your machine using Minishift.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_terms_specific_to_fabric8_launcher">H.2. Terms specific to Fabric8 Launcher</h3>
<div id="glossary_example" class="dlist">
<dl>
<dt class="hdlist1">Example</dt>
<dd>
<p>An application specification, for example <em>a web service with a REST API.</em></p>
<div class="paragraph">
<p>Examples generally do not specify which language or platform they should run on; the description only contains the intended functionality.</p>
</div>
</dd>
</dl>
</div>
<div id="glossary_example_application" class="dlist">
<dl>
<dt class="hdlist1">Example application</dt>
<dd>
<p>A language-specific implementation of a particular <a href="#glossary_example">example</a> on a particular <a href="#glossary_runtime">runtime</a>. Example applications are listed in an <a href="#glossary_example_application_catalog">examples catalog</a>.</p>
<div class="paragraph">
<p>For example, an example application is a web service with a REST API implemented using the Thorntail runtime.</p>
</div>
</dd>
</dl>
</div>
<div id="glossary_example_application_catalog" class="dlist">
<dl>
<dt class="hdlist1">Examples Catalog</dt>
<dd>
<p>A Git repository that contains information about example applications.</p>
</dd>
</dl>
</div>
<div id="glossary_runtime" class="dlist">
<dl>
<dt class="hdlist1">Runtime</dt>
<dd>
<p>A platform that executes an <a href="#glossary_example_application">example application</a>.
For example, Thorntail or Eclipse Vert.x.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2019-06-05<br>
Last updated 2019-06-04 11:47:02 +0200
</div>
</div>
<footer>
  <div class="container">
    <a href="/docs">Docs</a>
    <a href="/docs/contrib-guide.html">Contribution Guide</a>
    <a href="http://github.com/fabric8-launcher" target="_blank">GitHub</a>
    <a href="https://fabric8.io/">Fabric8 Project</a>
    <p>
        With ♥ from Fabric8 Launcher Team<br>
        <a href="https://github.com/fabric8-launcher/launcher-backend/blob/master/LICENSE" target="_blank">Apache License 2.0</a><br/>
        <a href="https://redhat.com">Copyright © 2018 Red Hat, Inc.</a>
      </p>
  </div>
</footer>

<!-- Segment Tracking -->
<script>
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
  analytics.load("${LAUNCHPAD_TRACKER_SEGMENT_TOKEN}");
  analytics.page();
  }}();
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>